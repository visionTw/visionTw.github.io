<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="第4章 变换 Transforms“要是愤怒的航船（vectors）改变了方向围绕着你沉睡的脑袋，和身体。那就永远不必去害怕穷苦世界的抽象风暴之暴行。”        ——罗伯特·佩·华伦（注：此处航船可换为向量，与此章联系起来，一语双关。）">
<meta property="og:type" content="article">
<meta property="og:title" content="RealTimeRendering 4">
<meta property="og:url" content="http://example.com/2020/10/20/RealTimeRender4/4/index.html">
<meta property="og:site_name" content="XiMo">
<meta property="og:description" content="第4章 变换 Transforms“要是愤怒的航船（vectors）改变了方向围绕着你沉睡的脑袋，和身体。那就永远不必去害怕穷苦世界的抽象风暴之暴行。”        ——罗伯特·佩·华伦（注：此处航船可换为向量，与此章联系起来，一语双关。）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29&amp;plus;%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7By%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx&amp;plus;y%7D%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%284.1%29%5C%5C%20k%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28k%5Ctextbf%7Bx%7D%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%205%5Ctextbf%7Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%20%5Ctextbf%7Bx%7D%20&amp;plus;%20%287%2C3%2C2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%25uFF087.3.2%25uFF09">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%287%2C3%2C2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%20%3D%20%28v_%7Bx%7D%5C%3Bv_%7By%7D%5C%3Bv_%7Bz%7D%5C%3B0%29%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%20%3D%20%28v_%7Bx%7D%5C%3Bv_%7By%7D%5C%3Bv_%7Bz%7D%5C%3B1%29%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Crho%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Crho">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?j">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i%2Cj%5Cepsilon%20%28x%2Cy%2Cz%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?slerp%28%5Ctextbf%7B%5C%5Eq%7D%2C%5Ctextbf%7B%5C%5Er%7D%2Ct%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%5C%5Eq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%5C%5Er%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%3D%5Ctextbf%7BT%7D%28t_%7Bx%7D%2Ct_%7By%7D%2Ct_%7Bz%7D%29%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20t_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20t_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20t_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%5C%3B%5C%3B%5C%3B%5C%3B%284.3%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D%3D%28p_%7Bx%7D%2Cp_%7By%7D%2Cp_%7Bz%7D%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7Bp%7D%7D%27%3D%28p_%7Bx%7D&amp;plus;t_%7Bx%7D%2Cp_%7By%7D&amp;plus;t_%7By%7D%2Cp_%7Bz%7D&amp;plus;t_%7Bz%7D%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%2Cv_%7Bz%7D%2C0%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%5E%7B-1%7D%28%5Ctextbf%7Bt%7D%29%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7B-t%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200409195533935.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%285%2C2%2C0%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%29%3D%28r%5C%3Bcos%5Ctheta%2Cr%5C%3Bsin%5Ctheta%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%28r%20cos%28%5Ctheta%20&amp;plus;%5Cphi%20%29%2Cr%20sin%28%5Ctheta%20&amp;plus;%5Cphi%20%29%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%5Cbegin%7Bpmatrix%7D%20r%5C%3Bcos%28%5Ctheta%20&amp;plus;%5Cphi%20%29%5C%5C%20r%5C%3Bsin%28%5Ctheta%20&amp;plus;%5Cphi%20%29%20%5Cend%7Bpmatrix%7D%3D%20%5Cbegin%7Bpmatrix%7D%20r%28cos%5Ctheta%20cos%5Cphi%20-%20sin%5Ctheta%20sin%5Cphi%29%5C%5C%20r%28sin%5Ctheta%20cos%5Cphi%20&amp;plus;%20cos%5Ctheta%20sin%5Cphi%29%20%5Cend%7Bpmatrix%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%26-sin%5Cphi%20%5C%5C%20sin%5Cphi%26cos%5Cphi%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%20rcos%5Ctheta%5C%5C%20rsin%5Ctheta%20%5Cend%7Bpmatrix%7D%20%3D%5Ctextbf%7BR%7D%28%5Cphi%29%5Ctextbf%7Bv%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.4%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200410154129758.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?cos%28%5Ctheta%20&amp;plus;%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?sin%28%5Ctheta&amp;plus;%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7By%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20cos%5Cphi%20%26%20-sin%5Cphi%20%26%200%5C%5C%200%20%26%20sin%5Cphi%20%26%20cos%5Cphi%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.5%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7By%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%20%26%200%20%26%20sin%5Cphi%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%20-sin%5Cphi%20%26%200%20%26%20cos%5Cphi%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.6%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%20%26%20-sin%5Cphi%20%26%200%20%26%200%5C%5C%20sin%5Cphi%20%26%20cos%5Cphi%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.7%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?tr%28%5Ctextbf%7BR%7D%29%3D1&amp;plus;2cos%5Cphi%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.8%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bi%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bi%7D%5E%7B-1%7D%28%5Cphi%29%20%3D%20%5Ctextbf%7BR%7D_%7Bi%7D%28-%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bp%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bp%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bp%7D%29%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bp%7D%29%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.9%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200410164143211.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%3D%5Ctextbf%7BS%7D%28s_%7Bx%7D%2Cs_%7By%7D%2Cs_%7Bz%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s_%7Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s_%7By%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i%5Cepsilon%20%5Cleft%20%5C%7B%20x%2Cy%2Cz%20%5Cright%20%5C%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%3D%5Cbegin%7Bpmatrix%7D%20s_%7Bx%7D%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20s_%7By%7D%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20s_%7Bz%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.10%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s_%7Bx%7D%3Ds_%7By%7D%3Ds_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%5E%7B-1%7D%28%5Ctextbf%7Bs%7D%29%3D%5Ctextbf%7BS%7D%281/s_%7Bx%7D%2C1/s_%7By%7D%2C1/s_%7Bz%7D%29.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%3D%5Cbegin%7Bpmatrix%7D%205%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%205%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%205%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%7B%5Ctextbf%7BS%7D%7D%27%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201/5%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%284.11%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7BS%7D%7D%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cbegin%7Bpmatrix%7D%20cos%28%5Cpi%20/2%29%20%26%20sin%28%5Cpi%20/2%29%20%5C%5C%20-sin%28%5Cpi%20/2%29%20%26%20cos%28%5Cpi%20/2%29%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%5C%5C%200%20%26%20-1%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%200%20%26%20-1%20%5C%5C%20-1%20%26%200%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.12%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200413113324751.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?0%5Ccdot%200-%28-1%29%5Ccdot%20%28-1%29%3D-1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3By%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BF%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?F%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Bf%7D%5E%7B%5C%3Bx%7D%20%26%20%5Ctextbf%7Bf%7D%5E%7B%5C%3By%7D%20%26%20%5Ctextbf%7Bf%7D%5E%7B%5C%3Bz%7D%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.13%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BF%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%5C%3B%3D%5C%3BFS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BF%7D%5E%7BT%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.14%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxy%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Byx%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Byz%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bzx%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bzy%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29%20%3D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%20s%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.15%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020041312114961.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28p_%7Bx%7D&amp;plus;sp_%7Bz%7D%20%5C%3B%5C%3Bp_%7By%7D%5C%3B%5C%3Bp_%7Bz%7D%29%5ET">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%28s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?j">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i%5Cneq%20j">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%5E%7B-1%7D%28s%29%20%3D%20%5Ctextbf%7BH%7D_%7Bij%7D%28-s%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxy%7D%5E%7B%27%7D%28s%2Ct%29%20%3D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%20s%20%26%200%5C%5C%200%20%26%201%20%26%20t%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.16%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%5E%7B-1%7D%28s%2Ct%29%3D%5Ctextbf%7BH%7D_%7Bik%7D%28s%29%5Ctextbf%7BH%7D_%7Bjk%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?k">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cbegin%7Bvmatrix%7D%20H%20%5Cend%7Bvmatrix%7D%3D1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%282%2C0.5%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi%20/6">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200414114005890.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%3D%282%2C0.5%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BN%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BMN%7D%5Cneq%20%5Ctextbf%7BNM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BC%5C%3B%3D%5C%3BTRS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRSp%7D%3D%5Ctextbf%7B%28T%28R%28Sp%29%29%29%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRS%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRSp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%28TR%29%28Sp%29%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%28t%29%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BT%7D%28t%29%5Ctextbf%7BR%7D%3D%5Cbegin%7Bpmatrix%7D%20r_%7B00%7D%20%26%20r_%7B01%7D%20%26%20r_%7B02%7D%20%26%20t_%7Bx%7D%20%5C%5C%20r_%7B10%7D%20%26%20r_%7B11%7D%20%26%20r_%7B12%7D%20%26%20t_%7By%7D%20%5C%5C%20r_%7B20%7D%20%26%20r_%7B21%7D%20%26%20r_%7B22%7D%20%26%20t_%7Bz%7D%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.17%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%5E%7B-1%7D%3D%28%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5Ctextbf%7BR%7D%29%5E%7B-1%7D%3D%5Ctextbf%7BR%7D%5E%7B-1%7D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5E%7B-1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cbar%7B%5Ctextbf%7BR%7D%7D%3D%28%5Ctextbf%7Br%7D_%7B%2C0%7D%5C%3B%5C%3B%5Ctextbf%7Br%7D_%7B%2C1%7D%5C%3B%5C%3B%5Ctextbf%7Br%7D_%7B%2C2%7D%29%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D_%7B0%2C%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Br%7D_%7B1%2C%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Br%7D_%7B2%2C%7D%5E%7BT%7D%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.18%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5CRightarrow">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cbar%7B%5Ctextbf%7BR%7D%7D%20%26%20%5Ctextbf%7Bt%7D%5C%5C%20%5Ctextbf%7B0%7D%5E%7BT%7D%20%26%201%20%5Cend%7Bpmatrix%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D_%7B%2C0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D_%7B0%7D%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7B0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%5E%7B-1%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D_%7B0%7D%20%26%20%5Ctextbf%7Br%7D_%7B1%7D%20%26%20%5Ctextbf%7Br%7D_%7B2%7D%20%26%20-%5Cbar%7B%5Ctextbf%7BR%7D%7D%5E%7BT%7D%5Ctextbf%7Bt%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.19%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200414185753974.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bc%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bl%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bc%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bl%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7Bu%7D%7D%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20%5Ctextbf%7Br%2C%5C%3Bu%2C%5C%3Bv%7D%20%5Cright%20%5C%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%5Ctextbf%7B%28c-1%29%7D/%5Cleft%20%5C%7C%20%5Ctextbf%7Bc-1%7D%20%5Cright%20%5C%7C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%20%3D%20-%28%5Ctextbf%7Bv%20%7D%5Ctimes%5Ctextbf%7Bu%7D%27%29/%5Cleft%20%5C%7C%20%5Ctextbf%7Bv%20%7D%5Ctimes%5Ctextbf%7Bu%7D%27%20%5Cright%20%5C%7C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%5Ctextbf%7Bv%7D%5Ctimes%20%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C0%2C0%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C1%2C0%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C0%2C1%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%20M%7D%3D%5Cbegin%7Bpmatrix%7D%20r_%7Bx%7D%20%26%20r_%7By%7D%20%26%20r_%7Bz%7D%20%26%200%5C%5C%20u_%7Bx%7D%20%26%20u_%7By%7D%20%26%20u_%7Bz%7D%20%26%200%5C%5C%20v_%7Bx%7D%20%26%20v_%7By%7D%20%26%20v_%7Bz%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20-t_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20-t_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-t_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%20r_%7Bx%7D%20%26%20r_%7By%7D%20%26%20r_%7Bz%7D%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Br%7D%5C%5C%20u_%7Bx%7D%20%26%20u_%7By%7D%20%26%20u_%7Bz%7D%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Bu%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Bv%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.20%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200415115140755.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%5Ccdot%5Ctextbf%7Br%7D%3D1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%5Ccdot%20%5Ctextbf%7Bx%7D%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200415141436623.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5Ctextbf%7BR%7D%28%5Cphi%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D%3D%5Ctextbf%7BR%7D%28-%5Cphi%29%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bt%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D%3D%5Ctextbf%7BM%7D%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%28h%2Cp%2Cr%29%3D%5Ctextbf%7BR%7D_%7Bz%7D%28r%29%5Ctextbf%7BR%7D_%7Bx%7D%28p%29%5Ctextbf%7BR%7D_%7By%7D%28h%29%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.21%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%5E%7B-1%7D%3D%5Ctextbf%7BE%7D%5E%7BT%7D%3D%28%5Ctextbf%7BR%7D_%7Bz%7D%5Ctextbf%7BR%7D_%7Bx%7D%5Ctextbf%7BR%7D_%7By%7D%29%5E%7BT%7D%3D%5Ctextbf%7BR%7D_%7Bx%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7By%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7Bz%7D%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200416105436474.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%280%2C0%2C-1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%28h%2Cp%2Cr%29%3D%5Cbegin%7Bpmatrix%7D%20e_%7B00%7D%20%26%20e_%7B01%7D%20%26%20e_%7B02%7D%5C%5C%20e_%7B10%7D%20%26%20e_%7B11%7D%20%26%20e_%7B12%7D%5C%5C%20e_%7B20%7D%20%26%20e_%7B21%7D%20%26%20e_%7B22%7D%20%5Cend%7Bpmatrix%7D%3D%20%5Ctextbf%7BR%7D_%7Bz%7D%28r%29%5Ctextbf%7BR%7D_%7Bx%7D%28p%29%5Ctextbf%7BR%7D_%7By%7D%28h%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.22%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%3D%5Cbegin%7Bpmatrix%7D%20cos%5C%3Br%5C%3Bcos%5C%3Bh%20-sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bsin%5C%3Bh%5C%3B%26%20-sin%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20cos%5C%3Br%5C%3Bsin%5C%3Bh%20-sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bcos%5C%3Bh%5C%3B%20%5C%5C%20sin%5C%3Br%5C%3Bcos%5C%3Bh%20-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bsin%5C%3Bh%5C%3B%20%26%20cos%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20sin%5C%3Br%5C%3Bsin%5C%3Bh-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bcos%5C%3Bh%5C%5C%20-cos%5C%3Bp%5C%3Bsin%5C%3Bh%20%26%20sin%5C%3Bp%20%26%20cos%5C%3Bp%5C%3Bcos%5C%3Bh%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.23%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?sin%5C%3Bp%3De_%7B21%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e_%7B01%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e_%7B11%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e_%7B20%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e_%7B22%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cfrac%7Be_%7B01%7D%7D%7Be_%7B11%7D%7D%3D%5Cfrac%7B-sin%5C%3Br%7D%7Bcos%5C%3Br%7D%3D-tan%5C%3Br%5C%3B%5C%3B%5C%3B%5C%3Band%5C%3B%5C%3B%5C%3B%5C%3B%5Cfrac%7Be_%7B20%7D%7D%7Be_%7B22%7D%7D%3D%5Cfrac%7B-sin%5C%3Bh%7D%7Bcos%5C%3Bh%7D%3D-tan%5C%3Bh%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.24%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5Ch%20%3D%20atan2%28-e_%7B20%7D%2Ce_%7B22%7D%29%2C%5C%5C%20p%3Darcsin%28e_%7B21%7D%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.25%29%5C%5C%20r%3Datan2%28-e_%7B01%7D%2Ce_%7B11%7D%29.%5C%5C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?cos%20p%20%3D%200">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-%5Cpi%20/2">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi%20/2">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?h%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%3D%5Cbegin%7Bpmatrix%7D%20cos%5C%3Br%20%26%20sin%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%5C%20sin%5C%3Br%20%26%20cos%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%5C%200%20%26%20sin%5C%3Bp%20%26%20cos%5C%3Bp%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.26%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?cos%5C%3Bp%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?sin%5C%3Br/cos%5C%3Br%3Dtan%5C%3Br%3De_%7B10%7D/e_%7B00%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r%3Datan2%28e_%7B10%7D%2Ce_%7B00%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-%5Cpi/2%5Cleqslant%20p%5Cleqslant%20%5Cpi/2">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x/y/z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi/2">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?cos%5C%3Bp%20%3D%200">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p%3D%5Cpm%20%5Cpi%20/2&amp;plus;2%5Cpi%20k">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?k">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r&amp;plus;h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r-h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x/y/z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z/x/y">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z/x/z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z/x/z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28p%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Calpha">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20210113142811713.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D%3D%5Ctextbf%7Br%7D%5Ctimes%20%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20%5Cbar%7B%5Ctextbf%7Bs%7D%7D%3D%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%280%2C-r_%7Bz%7D%2Cr_%7By%7D%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%2C%5C%5C%20%28-r_%7Bz%7D%2C0%2Cr_%7Bx%7D%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%2C%5C%5C%20%28-r_%7By%7D%2Cr_%7Bx%7D%2C0%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%2C%20%5Cend%7Bmatrix%7D%5Cright.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.27%29%20%5C%5C%20%5Ctextbf%7Bs%7D%3D%5Cbar%7B%5Ctextbf%7Bs%7D%7D/%5Cleft%20%5C%7C%20%5Cbar%7B%5Ctextbf%7Bs%7D%7D%20%5Cright%20%5C%7C%2C%20%5C%5C%20%5Ctextbf%7Bt%7D%3D%5Ctextbf%7Br%7D%5Ctimes%20%5Ctextbf%7Bs%7D.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cbar%7B%5Ctextbf%7Bs%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28%5Ctextbf%7Br%7D%2C%5Ctextbf%7Bs%7D%2C%5Ctextbf%7Bt%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Bs%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Bt%7D%5E%7BT%7D%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.28%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Calpha">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BM%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7Bx%7D%28%5Calpha%20%29%5Ctextbf%7BM%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.29%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Calpha">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Calpha%20%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%5Ctextbf%7BR%7D%3D%20%5Cbegin%7Bpmatrix%7D%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7Bx%7D%5E%7B2%7D%20%26%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7By%7D-r_%7Bz%7Dsin%5C%3B%5Cphi%20%26%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7Bz%7D&amp;plus;r_%7By%7Dsin%5C%3B%5Cphi%5C%5C%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7By%7D%20&amp;plus;r_%7Bz%7Dsin%5C%3B%5Cphi%20%26%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7By%7D%5E%7B2%7D%20%26%20%281-cos%5C%3B%5Cphi%29r_%7By%7Dr_%7Bz%7D-r_%7Bx%7Dsin%5C%3B%5Cphi%5C%5C%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7Bz%7D-r_%7By%7Dsin%5C%3B%5Cphi%20%26%20%281-cos%5C%3B%5Cphi%29r_%7By%7Dr_%7Bz%7D&amp;plus;r_%7Bx%7Dsin%5C%3B%5Cphi%20%26%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7Bz%7D%5E%7B2%7D%20%5Cend%7Bpmatrix%7D%5C%5C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.30%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Csqrt%7B1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200421163352291.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D%3D%28sin%5C%3B%5Cphi%5Ctextbf%7Bu%7D_%7Bq%7D%2Ccos%5C%3B%5Cphi%29.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D_%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?2%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D_%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bp%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%5Chat%7B%5Ctextbf%7Bp%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%5E%7B*%7D%29%5Chat%7B%5Ctextbf%7Br%7D%7D%5E%7B*%7D%3D%28%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5Chat%7B%5Ctextbf%7Bq%7D%7D%28%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5E%7B*%7D%3D%5Chat%7B%5Ctextbf%7Bc%7D%7D%5Chat%7B%5Ctextbf%7Bp%7D%7D%5Chat%7B%5Ctextbf%7Bc%7D%7D%5E%7B*%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.44%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bc%7D%7D%3D%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D%3D%5Cbegin%7Bpmatrix%7D%201-s%28q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%20s%28q_%7Bx%7Dq_%7By%7D-q_%7Bw%7Dq_%7Bz%7D%29%20%26%20s%28q_%7Bx%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7By%7D%29%20%26%200%20%5C%5C%20s%28q_%7Bx%7Dq_%7By%7D&amp;plus;q_%7Bw%7Dq_%7Bz%7D%29%20%26%201-s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%20s%28q_%7By%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7Bx%7D%29%20%26%200%20%5C%5C%20s%28q_%7Bx%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7By%7D%29%20%26%20s%28q_%7By%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7Bx%7D%29%20%26%201-s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D%29%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.45%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s%3D2/%28n%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D%3D%5Cbegin%7Bpmatrix%7D%201-2%28q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%202%28q_%7Bx%7Dq_%7By%7D-q_%7Bw%7Dq_%7Bz%7D%29%20%26%202%28q_%7Bx%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7By%7D%29%20%26%200%20%5C%5C%202%28q_%7Bx%7Dq_%7By%7D&amp;plus;q_%7Bw%7Dq_%7Bz%7D%29%20%26%201-2%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%202%28q_%7By%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7Bx%7D%29%20%26%200%20%5C%5C%202%28q_%7Bx%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7By%7D%29%20%26%202%28q_%7By%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7Bx%7D%29%20%26%201-2%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D%29%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.46%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20%5C%5Cm_%7B21%7D%5E%7Bq%7D-m_%7B12%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7Bx%7D%2C%20%5C%5Cm_%7B02%7D%5E%7Bq%7D-m_%7B20%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7By%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.47%29%20%5C%5Cm_%7B10%7D%5E%7Bq%7D-m_%7B01%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7Bz%7D.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D_%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20tr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29%3D4-2s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%3D4%5Cleft%20%28%201-%5Cfrac%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%7D%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D&amp;plus;q_%7Bw%7D%5E%7B2%7D%7D%20%5Cright%20%29%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.48%29%20%5C%5C%20%3D%5Cfrac%7B4q_%7Bw%7D%5E%7B2%7D%7D%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D&amp;plus;q_%7Bw%7D%5E%7B2%7D%7D%3D%5Cfrac%7B4q_%7Bw%7D%5E%7B2%7D%7D%7Bn%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5E%7B2%7D%7D.%20%5C%5C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D%3D%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7Btr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bx%7D%3D%5Cfrac%7Bm_%7B21%7D%5E%7Bq%7D-m_%7B12%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7By%7D%3D%5Cfrac%7Bm_%7B02%7D%5E%7Bq%7D-m_%7B20%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bz%7D%3D%5Cfrac%7Bm_%7B10%7D%5E%7Bq%7D-m_%7B01%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.49%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t%3Dq_%7Bw%7D%5E%7B2%7D-q_%7Bx%7D%5E%7B2%7D-q_%7By%7D%5E%7B2%7D-q_%7Bz%7D%5E%7B2%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5Cm_%7B00%7D%3Dt&amp;plus;2q_%7Bx%7D%5E%7B2%7D%2C%20%5C%5Cm_%7B11%7D%3Dt&amp;plus;2q_%7By%7D%5E%7B2%7D%2C%20%5C%5Cm_%7B22%7D%3Dt&amp;plus;2q_%7Bz%7D%5E%7B2%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.50%29%20%5C%5Cu%3Dm_%7B00%7D&amp;plus;m_%7B11%7D&amp;plus;m_%7B22%7D%3Dt&amp;plus;2q_%7Bw%7D%5E%7B2%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?m_%7B00%7D%2C%5C%3Bm_%7B11%7D%2C%5C%3Bm_%7B22%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?u">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bx%7D%2C%5C%3Bq_%7By%7D%2C%5C%3Bq_%7Bz%7D%2C">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C4q_%7Bx%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%20%5C%5C4q_%7By%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%20%5C%5C4q_%7Bz%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.51%29%20%5C%5C4q_%7Bw%7D%5E%7B2%7D%3Dtr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bx%7D%2C%5C%3Bq_%7By%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%5Ctimes%20%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D%28%5Ctextbf%7Bs%7D%2C%5Ctextbf%7Bt%7D%29%3D%5Cbegin%7Bpmatrix%7D%20e&amp;plus;hv_%7Bx%7D%5E%7B2%7D%20%26%20hv_%7Bx%7Dv_%7By%7D-v_%7Bz%7D%20%26%20hv_%7Bx%7Dv_%7Bz%7D&amp;plus;v_%7By%7D%20%26%200%20%5C%5C%20hv_%7Bx%7Dv_%7By%7D&amp;plus;v_%7Bz%7D%20%26%20e&amp;plus;hv_%7By%7D%5E%7B2%7D%20%26%20hv_%7By%7Dv_%7Bz%7D-v_%7Bx%7D%20%26%200%20%5C%5C%20hv_%7Bx%7Dv_%7Bz%7D-v_%7By%7D%20%26%20hv_%7By%7Dv_%7Bz%7D&amp;plus;v_%7Bx%7D%20%26%20e&amp;plus;hv_%7Bz%7D%5E%7B2%7D%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.57%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20%5Ctextbf%7Bv%7D%3D%5Ctextbf%7Bs%7D%5Ctimes%5Ctextbf%7Bt%7D%2C%20%5C%5C%20e%3D%5Ctextrm%7Bcos%7D%282%5Cphi%29%3D%5Ctextbf%7Bs%7D%5Ccdot%5Ctextbf%7Bt%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.58%29%20%5C%5C%20h%3D%5Cfrac%7B1-%5Ctextrm%7Bcos%7D%282%5Cphi%29%7D%7B%5Ctextrm%7Bsin%7D%5E%7B2%7D%282%5Cphi%29%7D%3D%5Cfrac%7B1-e%7D%7B%5Ctextbf%7Bv%7D%5Ccdot%5Ctextbf%7Bv%7D%7D%3D%5Cfrac%7B1%7D%7B1&amp;plus;e%7D.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%5C%7C%20%5Ctextbf%7Bs%7D%20%5Ctimes%20%5Ctextbf%7Bt%7D%20%5Cright%20%5C%7C%5Capprox%200">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi%5Capprox%200">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?2%5Cphi%20%5Capprox%20%5Cpi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cpi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200426153704121.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%28t%29%3D%5Csum%5E%7Bn-1%7D_%7Bi%3D0%7Dw_%7Bi%7D%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D%5Ctextbf%7Bp%7D%2C%5C%3B%5C%3B%5Ctextrm%7Bwhere%7D%5C%3B%5C%3B%5Csum%20%5E%7Bn-1%7D_%7Bi%3D0%7Dw_%7Bi%7D%3D1%2C%5C%3B%5C%3Bw_%7Bi%7D%5Cgeq%200.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.59%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?i%3D0%5C%3B...%5C%3Bn-1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5B0%2C1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7Bi%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427112929931.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B1%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427114301861.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t%5C%3B%5Cepsilon%5C%3B%20%5Bt0%2C%5C%3Bt1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?s%3D%28t-t0%29/%28t_%7B1%7D-t_%7B0%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bm%7D%3D%281-s%29%5Ctextbf%7Bp%7D_%7B0%7D&amp;plus;s%5Ctextbf%7Bp%7D_%7B1%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.60%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D_%7B0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D_%7B1%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B0%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t_%7B1%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427115842438.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?N">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?k%5Cgeqslant%201">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?P_%7Bi%7D%2C%5C%3Bi%5C%3B%5Cepsilon%5C%3B%20%5B1%2C%5C%3B...%5C%3B%2C%5C%3Bk%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?D_%7Bi%7D%3DP_%7Bi%7D-N">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?N">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?D_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?M%3DN&amp;plus;%5Csum%20%5E%7Bk%7D_%7Bi%3D1%7Dw_%7Bi%7DD_%7Bi%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.61%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7B1%7D%3D1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w_%7B1%7D%3D0.5">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427142245311.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n-1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n&amp;plus;1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?4%5Ctimes%204">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%280%5C%3B0%5C%3B0%5C%3B1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://img-blog.csdnimg.cn/2020042716413861.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?y">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?y">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.62%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cleft%20%7C%20%5Ctextbf%7BP%7D_%7Bo%7D%20%5Cright%20%7C%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?y">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28l%2Cr%2Cb%2Ct%2Cn%2Cf%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28l%2Cb%2Cn%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28r%2Ct%2Cf%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n%3Ef">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C-1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%281%2C1%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C0%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%281%2C1%2C1%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427172341528.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5C%5C%20%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B2%7D%7Bf-n%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20-%5Cfrac%7Bl&amp;plus;r%7D%7B2%7D%5C%5C%200%20%26%201%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7B2%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-%5Cfrac%7Bf&amp;plus;n%7D%7B2%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.63%29%20%5C%5C%20%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B2%7D%7Bf-n%7D%20%26%20-%5Cfrac%7Bf&amp;plus;n%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%3D%282/%28r-l%29%2C2/%28t-b%29%2C2/%28f-n%29%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D%3D%28-%28r&amp;plus;l%29/2%2C-%28t&amp;plus;b%29/2%2C-%28f&amp;plus;n%29/2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%5E%7B-1%7D%3D%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bt%7D%29%5Ctextbf%7BS%7D%28%28r-l%29/2%2C%28t-b%29/2%2C%28f-n%29/2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?y">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28l%2C%5C%3Bb%2C%5C%3Bn%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28r%2C%5C%3Bt%2C%5C%3Bf%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%281%2C%5C%3B1%2C%5C%3B-1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20-1%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.64%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5B0%2C1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5B-1%2C1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bs%20t%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200.5%20%26%200.5%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.65%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%5B0%2C1%5D%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B1%7D%7Bf-n%7D%20%26%20-%5Cfrac%7Bn%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.66%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n%20%5Cneq%20f%2C%5C%3Bl%20%5Cneq%20r">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t%20%5Cneq%20b">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427181810472.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q%3D%28q_%7Bx%7D%2Cq_%7By%7D%2C-d%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?x">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cfrac%7Bq_%7Bx%7D%7D%7Bp_%7Bx%7D%7D%3D%5Cfrac%7B-d%7D%7Bp_%7Bz%7D%7D%5C%3B%5C%3B%5CLeftrightarrow%20%5C%3B%5C%3Bq_%7Bx%7D%3D-d%5Cfrac%7Bp_%7Bx%7D%7D%7Bp_%7Bz%7D%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.67%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7By%7D%3D-dp_%7By%7D/p_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bz%7D%3D-d">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%20-1/d%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.68%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D%3D%5Ctextbf%7BP%7D_%7Bp%7D%5Ctextbf%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%20-1/d%20%26%200%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%20p_%7Bx%7D%5C%5C%20p_%7By%7D%5C%5C%20p_%7Bz%7D%5C%5C%201%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%20p_%7Bx%7D%5C%5C%20p_%7By%7D%5C%5C%20p_%7Bz%7D%5C%5C%20-p_%7Bz%7D/d%20%5Cend%7Bpmatrix%7D%20%5CRightarrow%20%5Cbegin%7Bpmatrix%7D%20-dp_%7Bx%7D/p_%7Bz%7D%5C%5C%20-dp_%7By%7D/p_%7Bz%7D%5C%5C%20-d%5C%5C%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.69%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-p_%7Bz%7D/d">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-d">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28p_%7Bx%7D%2C%5C%3Bp_%7By%7D%2C%5C%3Bp_%7Bz%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w%3D1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3Dn">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3Df">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?0%3En%3Ef">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3Dn">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28l%2C%5C%3Bb%2C%5C%3Bn%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28r%2C%5C%3Bt%2C%5C%3Bn%29">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200427183222166.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%28l%2Cr%2Cb%2Ct%2Cn%2Cf%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?l">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?b">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?r%5Cneq%20-l">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?t%5Cneq%20-b">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi%3D2%5Ctextrm%7Barctan%7D%28w/%282d%29%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.70%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?d">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi%3D2%5Ctextrm%7Barctan%7D%2836/%282.50%29%29%3D39.6">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7Bf&amp;plus;n%7D%7Bf-n%7D%20%26%20-%5Cfrac%7B2fn%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.71%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D%3D%28q_%7Bx%7D%2Cq_%7By%7D%2Cq_%7Bz%7D%2Cq_%7Bw%7D%29%5E%7BT%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?q_%7Bw%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D%3D%28q_%7Bx%7D/q_%7Bw%7D%2C%5C%3Bq_%7By%7D/q_%7Bw%7D%2C%5C%3Bq_%7Bz%7D/q_%7Bw%7D%2C1%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.72%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3Df">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?&amp;plus;1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3Dn">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?-1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%20-2n%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.73%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%281%2C1%2C-1%2C1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?0%3Cn%27%3Cf%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7BOpenGL%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%27%7D%7Br-l%7D%20%26%200%20%26%20%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%27%7D%7Bt-b%7D%20%26%20%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20-%5Cfrac%7Bf%27&amp;plus;n%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7B2f%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%20-1%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.74%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Cphi">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?a%3Dw/h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w%5Ctimes%20h">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7BOpenGL%7D%3D%5Cbegin%7Bpmatrix%7D%20c/a%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20c%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20-%5Cfrac%7Bf%27&amp;plus;n%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7B2f%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%20-1%20%26%200%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.75%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?c%3D1.0/%5Ctextrm%7Btan%7D%28%5Cphi/2%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D0">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D-1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z%3D1">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%5B0%2C1%5D%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%27%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%27%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7Bf%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7Bf%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.76%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bp%7D_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bv%7D%3D%5Ctextbf%7BP%7D_%7B%5Ctextbf%7Bp%7D%7D%3D%5Cbegin%7Bpmatrix%7D%20...%5C%5C%20...%5C%5C%20dp_%7Bz%7D&amp;plus;e%5C%5C%20%5Cpm%20p_%7Bz%7D%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.77%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20v_%7Bx%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20v_%7By%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20d">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20f">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?d%3D-%28f%27&amp;plus;n%27%29/%28f%27-n%27%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e%3D-2f%27n%27/%28f%27-n%27%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?v_%7Bx%7D%20%3D%20-p_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D%3D%5Cfrac%7Bdp_%7Bz%7D&amp;plus;e%7D%7B-p_%7Bz%7D%7D%3Dd-%5Cfrac%7Be%7D%7Bp_%7Bz%7D%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.78%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D%5C%3B%5Cepsilon%20%5C%3B%5B-1%2C&amp;plus;1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Clarge%20p_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?n%27%3D10">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f%27%3D110">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?p_%7Bz%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200428180704512.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f%27-n%27">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z_%7BNDC%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%3D%5Ctextbf%7BPM%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D%28%5Ctextbf%7BMp%7D%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTp%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z_%7BNDC%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?1/p_%7Bz%7D">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200428181423825.png">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z_%7BNDC%7D%5C%3B%5Cepsilon%20%5C%3B%5B0%2C&amp;plus;1%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?1-z_%7BNDC%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20z%3Dw%28%5Ctextrm%7Blog%7D_%7B2%7D%28%5Ctextrm%7Bmax%7D%2810%5E%7B-6%7D%2C1&amp;plus;w%29%29f_%7Bc%7D-1%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5B%5Ctextrm%7BOpenGL%7D%5D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.79%29%20%5C%5C%20z%3Dw%5Ctextrm%7Blog%7D_%7B2%7D%28%5Ctextrm%7Bmax%7D%2810%5E%7B-6%7D%2C1&amp;plus;w%29%29f_%7Bc%7D/2%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5B%5Ctextrm%7BDirectX%7D%5D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?z">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f_%7Bc%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f_%7Bc%7D%3D2/%5Ctextrm%7Blog%7D_%7B2%7D%28f&amp;plus;1%29">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?f">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e%3D1&amp;plus;w">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?%5Ctextrm%7Blog%7D%5E%7B2%7D%28e_%7Bi%7D%29f_%7Bc%7D/2">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e_%7Bi%7D">
<meta property="og:image" content="https://private.codecogs.com/gif.latex?e">
<meta property="article:published_time" content="2020-10-20T16:00:00.000Z">
<meta property="article:modified_time" content="2020-12-29T16:00:00.000Z">
<meta property="article:author" content="VisionXie">
<meta property="article:tag" content="渲染">
<meta property="article:tag" content="RealTimeRendering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://private.codecogs.com/gif.latex?%5C%5C%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29&amp;plus;%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7By%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx&amp;plus;y%7D%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%284.1%29%5C%5C%20k%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28k%5Ctextbf%7Bx%7D%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.2%29">

<link rel="canonical" href="http://example.com/2020/10/20/RealTimeRender4/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>RealTimeRendering 4 | XiMo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">XiMo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">醉后不知天在水，满船清梦压星河。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">17</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>All<span class="badge">30</span></a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/10/20/RealTimeRender4/4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="VisionXie">
      <meta itemprop="description" content="生活在树上，始终热爱大地，升入天空。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XiMo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RealTimeRendering 4
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-10-21 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-21T00:00:00+08:00">2020-10-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-30 00:00:00" itemprop="dateModified" datetime="2020-12-30T00:00:00+08:00">2020-12-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/RealTimeRendering/" itemprop="url" rel="index"><span itemprop="name">RealTimeRendering</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/2020/10/20/RealTimeRender4/4/#SOHUCS" itemprop="discussionUrl">
        <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2020/10/20/RealTimeRender4/4/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="第4章-变换-Transforms"><a href="#第4章-变换-Transforms" class="headerlink" title="第4章 变换 Transforms"></a><strong>第4章 变换 Transforms</strong></h1><p>“要是愤怒的航船（vectors）改变了方向<br>围绕着你沉睡的脑袋，和身体。<br>那就永远不必去害怕<br>穷苦世界的抽象风暴之暴行。”<br>        ——罗伯特·佩·华伦<br>（注：此处航船可换为向量，与此章联系起来，一语双关。）</p>
<span id="more"></span>
<p>变换（transform）是一种操作，它接受点（points），向量（vectors）或颜色（colors）之类的实体（entities），并且以某种方式转换它们。对于计算机图形从业者来说，掌握变换是非常重要的。有了它们，你可以定位（position）、重塑（reshape）和移动（animate）物体、灯光和照相机。你还可以确保所有计算都在同一坐标系中进行，并且以不同的方式将对象投影到平面上。这里只是少数可以通过变换执行的操作，但是这已经充分说明了变换（transform）在实时图形或任何类型计算机图形中的重要性。<br>线性变换（linear transform）是保留向量加法和标量乘法的变换。具体来说：</p>
<img alt="\\ \textbf{f}(\textbf{x})+ \textbf{f}(\textbf{y}) = \textbf{f}(\textbf{x+y}),\;\;\;\;(4.1)\\ k\textbf{f}(\textbf{x}) = \textbf{f}(k\textbf{x}).\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.2)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29&amp;plus;%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7By%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx&amp;plus;y%7D%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%284.1%29%5C%5C%20k%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%20%5Ctextbf%7Bf%7D%28k%5Ctextbf%7Bx%7D%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.2%29">

<p>举个例子，<img alt="\textbf{f}(\textbf{x}) = 5\textbf{x}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%205%5Ctextbf%7Bx%7D"> 是一个使向量每个元素乘以 5 的变换。为了证明这是线性的，需要满足两个条件（公式 4.1 与 公式 4.2）。第一个条件成立，因为任何两个向量乘以 5 然后相加就等于将向量相加然后再相乘。第二个标量乘法条件（公式 4.2）已经明显是满足的。此函数我们称为缩放变换（scaling transform），因为它可以更改对象的缩放比例（大小）。旋转变换（rotation transform）是另一个线性变换，它可使向量绕原点旋转。包括缩放和旋转变换，实际上三维向量的所有线性变换，都可以使用 3 × 3 矩阵表示。</p>
<p>然而，矩阵的大小通常不够大。三维向量 <img alt="\textbf{x}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bx%7D"> 的函数，例如  <img alt="\textbf{f}(\textbf{x}) = \textbf{x} + (7,3,2)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%28%5Ctextbf%7Bx%7D%29%20%3D%20%5Ctextbf%7Bx%7D%20&amp;plus;%20%287%2C3%2C2%29">  是非线性的。在两个单独的向量上执行此函数将把 <img alt="（7.3.2）" class="mathcode" src="https://private.codecogs.com/gif.latex?%25uFF087.3.2%25uFF09"><img alt="(7,3,2)" class="mathcode" src="https://private.codecogs.com/gif.latex?%287%2C3%2C2%29"> 的每个值相加两次。这种将定值向量加到另一个向量上的操作称为平移（translation），它会将位置移动相应的值。平移是一种很有用的变换类型，接下来我们将组合各种变换，例如，将对象缩放到一半大小，然后将其移动到其他位置。此时我们会发现，将函数保持在简单形式是很难轻松地进行组合的。</p>
<p>我们可以使用仿射变换（affine transform）将线性变换（linear transforms）和平移（translations）结合起来，仿射变换通常存储为 4 × 4 矩阵。仿射变换是先执行线性变换然后执行平移变换。为了表示四维向量，我们使用齐次表示法（homogeneous notation），以相同的方式表示点和方向（使用粗体小写字母）。方向向量（direction vector）表示为 <img alt="\textbf{v} = (v_{x}\;v_{y}\;v_{z}\;0)^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%20%3D%20%28v_%7Bx%7D%5C%3Bv_%7By%7D%5C%3Bv_%7Bz%7D%5C%3B0%29%5E%7BT%7D">，点（point）表示为 <img alt="\textbf{v} = (v_{x}\;v_{y}\;v_{z}\;1)^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%20%3D%20%28v_%7Bx%7D%5C%3Bv_%7By%7D%5C%3Bv_%7Bz%7D%5C%3B1%29%5E%7BT%7D">。在本章中，我们将广泛使用在 realtimerendering.com 上可下载的线性代数附录中解释的术语和运算。</p>
<p>所有平移（translation），旋转（rotation），缩放（scaling），反射（reflflection）和剪切矩阵（shearing matrices）都是仿射（affine）。仿射矩阵（affine matrix）的主要特征就是它保留了线的平行性，但不一定保留长度和角度。仿射变换（affine transform）也可以是各个仿射变换级联（concatenations）的任何序列。</p>
<p>本章将从最根本的基本仿射变换（basic affine transforms）开始。本部分可以看作是简单变换的“参考手册”。之后，我们会描述一些专用的矩阵，随后对四元数（quaternions）——一种强大的变换工具，进行讨论和描述。然后是顶点融合（blending）和变形（morphing），这是表达网格动画的两种简单但有效的方法。最后，描述了投影矩阵。这些变换中大多数，它们的符号，功能和特性都总结在 表 4.1 中，其中正交矩阵的逆矩阵为其转置矩阵。</p>
<p>变换（Transforms）是用于操纵几何体（geometry）的基本工具。大多数图形应用程序编程接口允许用户设置任意矩阵，有时库（library）可能与实现本章讨论的许多变换的矩阵运算一起使用。但是，仍然有必要了解函数调用背后的实际矩阵及其相互作用。知道调用函数后矩阵做了什么是一个开始，但是了解矩阵本身的属性将使你的理解更进一步。例如，这种理解可以使你辨别何时处理正交矩阵（正交是其转置），从而可以更快地进行矩阵求逆。这样的知识可以让你的代码更加高效。</p>
<h2 id="4-1-基本变换-Basic-Transforms"><a href="#4-1-基本变换-Basic-Transforms" class="headerlink" title="4.1 基本变换 Basic Transforms"></a><strong>4.1 基本变换 Basic Transforms</strong></h2><p>本节介绍最基本的变换，例如平移（translation），旋转（rotation），缩放（scaling），剪切（shearing），变换级联（transform concatenation），刚体变换（rigid-body transform），法线变换（normal transform）（然而并不是很正常 原文：which is not so normal 双关语笑话）和逆计算（computation of inverses）。对于有经验的读者，可以将其用作简单变换的参考手册，对于新手，则可以作为该主题的入门。本材料是本章其余部分和本书其他各章的必要背景。我们从最简单的变换——“平移”开始。</p>
<table>
<thead>
<tr>
<th>符号 Notation</th>
<th>名称 Name</th>
<th>特点 Characteristics</th>
</tr>
</thead>
<tbody><tr>
<td><img alt="\textbf{T}(\textbf{t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29"></td>
<td>平移矩阵           translation matrix</td>
<td>移动一个点。仿射。</td>
</tr>
<tr>
<td><img alt="\textbf{R}_{x}(\rho )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Crho%20%29"></td>
<td>旋转矩阵          rotation matrix</td>
<td>绕 x 轴 旋转 <img alt="\rho" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Crho"> 弧度角。 y 轴 与 z 轴也使用此标记。 正交且仿射。</td>
</tr>
<tr>
<td><img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D"></td>
<td>旋转矩阵              rotation matrix</td>
<td>任意的旋转矩阵。 正交且仿射。</td>
</tr>
<tr>
<td><img alt="\textbf{S}(\textbf{s})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29"></td>
<td>缩放矩阵 scaling matrix</td>
<td>根据 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 值来缩放 x，y，z轴。 仿射。</td>
</tr>
<tr>
<td><img alt="\textbf{H}_{ij}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%28s%29"></td>
<td>剪切矩阵 shear matrix</td>
<td>相对于分量 <img alt="j" class="mathcode" src="https://private.codecogs.com/gif.latex?j"> ，用因子 <img alt="s" class="mathcode" src="https://private.codecogs.com/gif.latex?s"> 剪切分量 <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i"> 。 <img alt="i,j\epsilon (x,y,z)" class="mathcode" src="https://private.codecogs.com/gif.latex?i%2Cj%5Cepsilon%20%28x%2Cy%2Cz%29">。仿射</td>
</tr>
<tr>
<td><img alt="\textbf{P}_{o}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%28s%29"></td>
<td>正交投影              orthographic projection</td>
<td>平行投影到某个平面或某个体积上。 仿射。</td>
</tr>
<tr>
<td><img alt="\textbf{P}_{p}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D%28s%29"></td>
<td>透视投影              perspective projection</td>
<td>以透视图投影到平面或体积上。</td>
</tr>
<tr>
<td><img alt="slerp(\textbf{\^q},\textbf{\^r},t )" class="mathcode" src="https://private.codecogs.com/gif.latex?slerp%28%5Ctextbf%7B%5C%5Eq%7D%2C%5Ctextbf%7B%5C%5Er%7D%2Ct%20%29"></td>
<td>斯勒普变换              slerp transform      （注：全称为球面线性插值变换 Spherical Linear Interpolation Transform）</td>
<td>生成关于四元数 <img alt="\textbf{\^q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%5C%5Eq%7D"> 和 <img alt="\textbf{\^r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%5C%5Er%7D"> 以及参数 <img alt="t" class="mathcode" src="https://private.codecogs.com/gif.latex?t"> 的插值四元数。</td>
</tr>
</tbody></table>
<h3 id="4-1-1-平移-Translation"><a href="#4-1-1-平移-Translation" class="headerlink" title="4.1.1 平移 Translation"></a><strong>4.1.1 平移 Translation</strong></h3><p>从一个位置到另一个位置的变化由平移矩阵 <img alt="\textbf{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D"> 表示。此矩阵通过向量  去平移实体。<img alt="\textbf{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D"> 由下面的 公式 4.3 给出：</p>
<img alt="\textbf{T}(\textbf{t})=\textbf{T}(t_{x},t_{y},t_{z})=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; t_{x}\\ 0 &amp; 1 &amp; 0 &amp; t_{y}\\ 0 &amp; 0 &amp; 1 &amp; t_{z}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}\;\;\;\;(4.3)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%3D%5Ctextbf%7BT%7D%28t_%7Bx%7D%2Ct_%7By%7D%2Ct_%7Bz%7D%29%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20t_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20t_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20t_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%5C%3B%5C%3B%5C%3B%5C%3B%284.3%29">

<p>图 4.1 显示了平移变换效果的示例。容易证明，将点 <img alt="\textbf{p}=(p_{x},p_{y},p_{z},1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D%3D%28p_%7Bx%7D%2Cp_%7By%7D%2Cp_%7Bz%7D%2C1%29"> 与 <img alt="\textbf{T}(\textbf{t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29"> 相乘会产生一个新的点<img alt="{\textbf{p}}'=(p_{x}+t_{x},p_{y}+t_{y},p_{z}+t_{z},1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7Bp%7D%7D%27%3D%28p_%7Bx%7D&amp;plus;t_%7Bx%7D%2Cp_%7By%7D&amp;plus;t_%7By%7D%2Cp_%7Bz%7D&amp;plus;t_%7Bz%7D%2C1%29">， 这显然是一个平移。请注意，向量 <img alt="\textbf{v}=(v_{x},v_{y},v_{z},0)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%2Cv_%7Bz%7D%2C0%29"> 不受 <img alt="\textbf{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D"> 乘法的影响，因为方向向量无法平移。相反，点和向量都受其余仿射变换（affine transforms）的影响。平移矩阵的逆是 <img alt="\textbf{T}^{-1}(\textbf{t})=\textbf{T}(\textbf{-t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%5E%7B-1%7D%28%5Ctextbf%7Bt%7D%29%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7B-t%7D%29">，即向量 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 取反（negated）。</p>
<img alt="" height="255" src="https://img-blog.csdnimg.cn/20200409195533935.png" width="741">

<blockquote>
<p>图 4.1 左边的方形进行了平移变换，平移矩阵为 <img alt="\textbf{T}(5,2,0)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%285%2C2%2C0%29">，方形向右移动了 5 个单位距离，向上移动了 2 个单位距离。</p>
</blockquote>
<p>在这一点上，我们应该提到的是，有时在计算机图形学中看到的另一种有效的符号方案，它使用的矩阵的底标是平移向量。例如DirectX 就是使用这种形式。在该方案中，矩阵的顺序将颠倒，即矩阵应用的顺序将从左至右读取。由于向量是行向量，因此可以将这种表示形式的向量和矩阵称为行优先形式（row-major form）。在本书中，我们将使用列优先形式（column-major form）。无论使用哪种方式，这纯粹是一种符号上的差异。当矩阵存储在内存中时，十六进制的最后四个值为三个平移值加后跟的一个值。</p>
<h3 id="4-1-2-旋转-Rotation"><a href="#4-1-2-旋转-Rotation" class="headerlink" title="4.1.2 旋转 Rotation"></a><strong>4.1.2 旋转 Rotation</strong></h3><p>旋转变换将一个向量（位置或方向）绕经过原点的给定轴旋转指定的角度。像平移矩阵一样，它是一个刚体变换（rigid-body transform），换句话说，它保留了变换后的点之间的距离，并保留了惯用性（handedness）（即从不导致左右两侧互换）。在计算机图形学中，这两种类型的变换对于定位和定向对象显然很有用。方向矩阵（orientation matrix）是与摄像机视图（camera view）或对象相关联的旋转矩阵，它定义了其在空间中的方向，即其向上和向前的方向。</p>
<p>在二维中，旋转矩阵很容易得出。假设我们有一个向量 <img alt="\textbf{v}=(v_{x},v_{y})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%29">，我们将其参数化为 <img alt="\textbf{v}=(v_{x},v_{y})=(r\;cos\theta,r\;sin\theta)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%28v_%7Bx%7D%2Cv_%7By%7D%29%3D%28r%5C%3Bcos%5Ctheta%2Cr%5C%3Bsin%5Ctheta%29">。如果我们将向量旋转 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度（逆时针），则将得到 <img alt="\textbf{u}=(r cos(\theta +\phi ),r sin(\theta +\phi ))" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%28r%20cos%28%5Ctheta%20&amp;plus;%5Cphi%20%29%2Cr%20sin%28%5Ctheta%20&amp;plus;%5Cphi%20%29%29">。这可以重写为</p>
<img alt="\textbf{u}=\begin{pmatrix} r\;cos(\theta +\phi )\\ r\;sin(\theta +\phi ) \end{pmatrix}= \begin{pmatrix} r(cos\theta cos\phi - sin\theta sin\phi)\\ r(sin\theta cos\phi + cos\theta sin\phi) \end{pmatrix}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%5Cbegin%7Bpmatrix%7D%20r%5C%3Bcos%28%5Ctheta%20&amp;plus;%5Cphi%20%29%5C%5C%20r%5C%3Bsin%28%5Ctheta%20&amp;plus;%5Cphi%20%29%20%5Cend%7Bpmatrix%7D%3D%20%5Cbegin%7Bpmatrix%7D%20r%28cos%5Ctheta%20cos%5Cphi%20-%20sin%5Ctheta%20sin%5Cphi%29%5C%5C%20r%28sin%5Ctheta%20cos%5Cphi%20&amp;plus;%20cos%5Ctheta%20sin%5Cphi%29%20%5Cend%7Bpmatrix%7D">

<img alt="=\begin{pmatrix} cos\phi&amp;-sin\phi \\ sin\phi&amp;cos\phi \end{pmatrix} \begin{pmatrix} rcos\theta\\ rsin\theta \end{pmatrix} =\textbf{R}(\phi)\textbf{v}\;\;\;\;\;\;\;\;(4.4)" class="mathcode" src="https://private.codecogs.com/gif.latex?%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%26-sin%5Cphi%20%5C%5C%20sin%5Cphi%26cos%5Cphi%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%20rcos%5Ctheta%5C%5C%20rsin%5Ctheta%20%5Cend%7Bpmatrix%7D%20%3D%5Ctextbf%7BR%7D%28%5Cphi%29%5Ctextbf%7Bv%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.4%29">

<img alt="" height="25" src="https://img-blog.csdnimg.cn/20200410154129758.png" width="230">

<p>在这里我们使用角度和关系来展开 <img alt="cos(\theta +\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?cos%28%5Ctheta%20&amp;plus;%5Cphi%29"> 和  <img alt="sin(\theta+\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?sin%28%5Ctheta&amp;plus;%5Cphi%29">。在三维中，常用的旋转矩阵是<img alt="\textbf{R}_{x}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Cphi%29">，<img alt="\textbf{R}_{y}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7By%7D%28%5Cphi%29"> 和 <img alt="\textbf{R}_{z}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29">，它们分别绕x，y 和 z 轴旋转实体 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度。它们由公式 4.5 – 4.7 给出：</p>
<img alt="\textbf{R}_{x}(\phi)=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; cos\phi &amp; -sin\phi &amp; 0\\ 0 &amp; sin\phi &amp; cos\phi &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}, \;\;\;\;\;\;\;\;(4.5)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20cos%5Cphi%20%26%20-sin%5Cphi%20%26%200%5C%5C%200%20%26%20sin%5Cphi%20%26%20cos%5Cphi%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.5%29">

<img alt="\textbf{R}_{y}(\phi)=\begin{pmatrix} cos\phi &amp; 0 &amp; sin\phi &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ -sin\phi &amp; 0 &amp; cos\phi &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}, \;\;\;\;\;\;\;\;(4.6)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7By%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%20%26%200%20%26%20sin%5Cphi%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%20-sin%5Cphi%20%26%200%20%26%20cos%5Cphi%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.6%29">

<img alt="\textbf{R}_{z}(\phi)=\begin{pmatrix} cos\phi &amp; -sin\phi &amp; 0 &amp; 0\\ sin\phi &amp; cos\phi &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}. \;\;\;\;\;\;\;\;\;(4.7)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29%3D%5Cbegin%7Bpmatrix%7D%20cos%5Cphi%20%26%20-sin%5Cphi%20%26%200%20%26%200%5C%5C%20sin%5Cphi%20%26%20cos%5Cphi%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.7%29">

<p>如果从 4 × 4 矩阵中删除最底行和最右列，则将获得 3 × 3 矩阵。对于每个绕任意轴旋转 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度的 3 × 3 矩阵 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">，它的迹（trace，矩阵中对角元素的总和）与轴无关，是恒定的，计算公式为 **[997]**：</p>
<img alt="tr(\textbf{R})=1+2cos\phi\;\;\;\;\;\;\;\;(4.8)" class="mathcode" src="https://private.codecogs.com/gif.latex?tr%28%5Ctextbf%7BR%7D%29%3D1&amp;plus;2cos%5Cphi%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.8%29">

<p>旋转矩阵的效果可以在第 65 页的 图 4.4 中看到。使旋转矩阵 <img alt="\textbf{R}_{i}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bi%7D%28%5Cphi%29"> 起作用的原因是，它绕着轴 <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i"> 旋转了 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度，但它保留了旋转中的所有点。轴， <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i">，不变。注意，<img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D"> 也将用于表示围绕任何轴的旋转矩阵。上面给出的轴旋转矩阵可以在一系列的三个变换中使用，以执行任意轴旋转。该过程在 第 4.2.1 节 中讨论。第 4.2.4 节 介绍了直接绕任意轴的旋转。</p>
<p>所有旋转矩阵的行列式（determinant）均为 1，并且是正交的（orthogonal）。这对于任意数量的这些变换的级联（concatenations）也成立。还有另一种求逆的方法：<img alt="\textbf{R}_{i}^{-1}(\phi) = \textbf{R}_{i}(-\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bi%7D%5E%7B-1%7D%28%5Cphi%29%20%3D%20%5Ctextbf%7BR%7D_%7Bi%7D%28-%5Cphi%29">，即绕同一轴沿相反方向旋转。</p>
<p><strong>示例：绕点旋转</strong><br>假设我们要围绕 z 轴旋转一个 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度的对象，旋转中心为某个点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">。那么该如何进行变换？ 图4.2中描述了这种情况。由于绕点旋转的特征在于该点本身不受旋转的影响，因此变换首先通过平移对象使 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 与原点重合开始，这是通过 <img alt="\textbf{T}(-\textbf{p})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bp%7D%29"> 完成的。此后跟随实际旋转：<img alt="\textbf{R}_{z}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29">。最后，必须使用 <img alt="\textbf{T}(\textbf{p})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bp%7D%29">  将对象平移回其原始位置。然后，得到的变换 <img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 由下式给出：</p>
<img alt="\textbf{X}=\textbf{T}(\textbf{p})\textbf{R}_{z}(\phi)\textbf{T}(-\textbf{p})\;\;\;\;\;\;\;\;(4.9)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bp%7D%29%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cphi%29%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bp%7D%29%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.9%29">

<p>注意上面矩阵的顺序。</p>
<img alt="" height="200" src="https://img-blog.csdnimg.cn/20200410164143211.png" width="736">

<blockquote>
<p>图4.2 围绕特定点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 旋转的例子。</p>
</blockquote>
<h3 id="4-1-3-缩放-Scaling"><a href="#4-1-3-缩放-Scaling" class="headerlink" title="4.1.3 缩放 Scaling"></a><strong>4.1.3 缩放 Scaling</strong></h3><p>缩放矩阵 <img alt="\textbf{S}(\textbf{s})=\textbf{S}(s_{x},s_{y},s_{z})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%3D%5Ctextbf%7BS%7D%28s_%7Bx%7D%2Cs_%7By%7D%2Cs_%7Bz%7D%29">，分别沿 x，y 和 z 方向按 <img alt="s_{x}" class="mathcode" src="https://private.codecogs.com/gif.latex?s_%7Bx%7D">，<img alt="s_{y}" class="mathcode" src="https://private.codecogs.com/gif.latex?s_%7By%7D"> 和 <img alt="s_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?s_%7Bz%7D"> 的缩放因子去缩放实体。这意味着可以使用缩放矩阵来放大或缩小对象。<img alt="s_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?s_%7Bi%7D">（<img alt="i\epsilon \left \{ x,y,z \right \}" class="mathcode" src="https://private.codecogs.com/gif.latex?i%5Cepsilon%20%5Cleft%20%5C%7B%20x%2Cy%2Cz%20%5Cright%20%5C%7D">）越大，则按比例缩放的实体在该方向上越大。将s的任何分量设置为 1 自然可以避免在该方向上缩放比例发生变化。公式 4.10 展示了 <img alt="\textbf{S}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D">：</p>
<img alt="\textbf{S}(\textbf{s})=\begin{pmatrix} s_{x} &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; s_{y} &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; s_{z} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}. \;\;\;\;\;\;\;\;(4.10)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%3D%5Cbegin%7Bpmatrix%7D%20s_%7Bx%7D%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20s_%7By%7D%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20s_%7Bz%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.10%29">

<p>第 65 页的 图4.4 说明了缩放矩阵的作用。如果 <img alt="s_{x}=s_{y}=s_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?s_%7Bx%7D%3Ds_%7By%7D%3Ds_%7Bz%7D">，则缩放操作称为统一操作（uniform），否则称为非统一操作（nonuniform）。有时，使用等向性（isotropic）和各向异性（anisotropic）缩放来代替统一和非统一性。倒数是</p>
<img alt="\textbf{S}^{-1}(\textbf{s})=\textbf{S}(1/s_{x},1/s_{y},1/s_{z})." class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%5E%7B-1%7D%28%5Ctextbf%7Bs%7D%29%3D%5Ctextbf%7BS%7D%281/s_%7Bx%7D%2C1/s_%7By%7D%2C1/s_%7Bz%7D%29.">

<p>使用齐次坐标，创建统一缩放矩阵的另一种有效方法是通过操作位置（3，3）处的矩阵元素，即右下角的元素。该值会影响齐次坐标的w分量，因此会缩放矩阵变换后的点（而非方向向量）的每个坐标。例如，要均匀地缩放 5 倍，可以将缩放矩阵中（0，0），（1、1）和（2，2）的元素设置为 5，或将（3， 3）可以设置为 1/5。执行此操作的两个不同矩阵如下所示：</p>
<img alt="\textbf{S}=\begin{pmatrix} 5 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 5 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 5 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix} ,\;\;\;\;\;\;\;\; {\textbf{S}}'=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1/5 \end{pmatrix}.\;\;\;\;\;\;\;\; (4.11)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%3D%5Cbegin%7Bpmatrix%7D%205%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%205%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%205%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%7B%5Ctextbf%7BS%7D%7D%27%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201/5%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%20%284.11%29">

<p>与使用 <img alt="\textbf{S}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D"> 进行均匀缩放相反，必须始终在使用 <img alt="{\textbf{S}}'" class="mathcode" src="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7BS%7D%7D%27"> 之后进行齐次化（homogenization）。这可能是低效的，因为它涉及齐次化过程中的除法。如果右下角的元素（位置（3，3））为1，则不需要除法。当然，如果系统总是在不检测是否为 1 的情况下进行除法，则不会产生任何额外消耗。</p>
<p><img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 的一个或三个分量上的负值给出一种反射矩阵（reflection matrix），也称为镜像矩阵（mirror matrix）。如果只有两个比例因子为 -1，那么我们将旋转 <img alt="\pi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi"> 弧度。应当注意的是，与反射矩阵连接的旋转矩阵也是反射矩阵。因此，以下是反射矩阵：</p>
<img alt="\begin{pmatrix} cos(\pi /2) &amp; sin(\pi /2) \\ -sin(\pi /2) &amp; cos(\pi /2) \end{pmatrix} \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{pmatrix} = \begin{pmatrix} 0 &amp; -1 \\ -1 &amp; 0 \end{pmatrix}. \;\;\;\;\;\;\;\;(4.12)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cbegin%7Bpmatrix%7D%20cos%28%5Cpi%20/2%29%20%26%20sin%28%5Cpi%20/2%29%20%5C%5C%20-sin%28%5Cpi%20/2%29%20%26%20cos%28%5Cpi%20/2%29%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%5C%5C%200%20%26%20-1%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%200%20%26%20-1%20%5C%5C%20-1%20%26%200%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.12%29">

<img alt="" height="28" src="https://img-blog.csdnimg.cn/20200413113324751.png" width="285">

<p>当检测到反射矩阵时，通常需要进行特殊处理。例如，当顶点由反射矩阵变换时，其顶点具有逆时针顺序的三角形将获得顺时针顺序。此顺序更改可能导致不正确的照明和背面剔除（backface culling）。要检测给定的矩阵是否以某种方式反射，请计算矩阵左上  3×3 个元素的行列式。如果该值为负，则矩阵是反射的（reflflective）。例如，公式4.12 中矩阵的行列式（determinant）为 <img alt="0\cdot 0-(-1)\cdot (-1)=-1" class="mathcode" src="https://private.codecogs.com/gif.latex?0%5Ccdot%200-%28-1%29%5Ccdot%20%28-1%29%3D-1">。</p>
<p><strong>示例：按特定比例缩放</strong><br>缩放矩阵 <img alt="\textbf{S}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D"> 仅沿 x，y 和 z 轴缩放。如果应在其他方向执行缩放，则需要复合变换。假设缩放应沿着正交轴右向向量 <img alt="\textbf{f}^{\;x}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3Bx%7D">，<img alt="\textbf{f}^{\;y}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3By%7D"> 和  <img alt="\textbf{f}^{\;z}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bf%7D%5E%7B%5C%3Bz%7D"> 的轴进行。那么首先，构造矩阵 <img alt="\textbf{F}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BF%7D">，以更改基底（basis），如下所示：</p>
<img alt="F=\begin{pmatrix} \textbf{f}^{\;x} &amp; \textbf{f}^{\;y} &amp; \textbf{f}^{\;z} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}. \;\;\;\;\;\;\;\;(4.13)" class="mathcode" src="https://private.codecogs.com/gif.latex?F%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Bf%7D%5E%7B%5C%3Bx%7D%20%26%20%5Ctextbf%7Bf%7D%5E%7B%5C%3By%7D%20%26%20%5Ctextbf%7Bf%7D%5E%7B%5C%3Bz%7D%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.13%29">

<p>这个想法是使三个轴给定的坐标系与标准轴（standard axes）重合，然后使用标准缩放矩阵，然后变换回去。其第一步是通过乘以 <img alt="\textbf{F}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BF%7D"> 的转置即它的逆来进行的。然后完成实际的缩放，然后再变换回去。变换如公式 4.14 所示：</p>
<img alt="\textbf{X\;=\;FS}(\textbf{s})\textbf{F}^{T}.\;\;\;\;\;\;\;\;(4.14)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%5C%3B%3D%5C%3BFS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BF%7D%5E%7BT%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.14%29">

<h3 id="4-1-4-剪切-Shearing"><a href="#4-1-4-剪切-Shearing" class="headerlink" title="4.1.4 剪切 Shearing"></a><strong>4.1.4 剪切 Shearing</strong></h3><p>另一类变换是剪切矩阵集。这些矩阵可以，例如，用于扭曲游戏中整个场景，以产生迷幻效果或扭曲模型的外观。有六个基本剪切矩阵，它们分别表示为 <img alt="\textbf{H}_{xy}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxy%7D%28s%29">，<img alt="\textbf{H}_{xz}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29">，<img alt="\textbf{H}_{yx}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Byx%7D%28s%29">，<img alt="\textbf{H}_{yz}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Byz%7D%28s%29">，<img alt="\textbf{H}_{zx}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bzx%7D%28s%29"> 和 <img alt="\textbf{H}_{zy}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bzy%7D%28s%29">。第一个下标用于表示剪切矩阵正在更改哪个坐标，而第二个下标表示进行剪切的坐标。剪切矩阵 <img alt="\textbf{H}_{xz}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29"> 的示例如 公式4.15 所示。注意，下标可用于在下面的矩阵中找到参数 <img alt="s" class="mathcode" src="https://private.codecogs.com/gif.latex?s"> 的位置； <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x">（其数字索引为0）标识第零行，而 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">（其数字索引为 2 ）标识第二列，因此 <img alt="s" class="mathcode" src="https://private.codecogs.com/gif.latex?s"> 位于此处：</p>
<img alt="\textbf{H}_{xz}(s) = \begin{pmatrix} 1 &amp; 0 &amp; s &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}. \;\;\;\;\;\;\;\;(4.15)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29%20%3D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%20s%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.15%29">

<img alt="" height="257" src="https://img-blog.csdnimg.cn/2020041312114961.png" width="742">

<blockquote>
<p>图4.3。用 <img alt="\textbf{H}_{xz}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxz%7D%28s%29"> 剪切单位平方的效果。y值和z值都不受转换的影响，而x值是旧x值和s乘以z值的总和，导致平方倾斜。这种变换是保留区域的，这可以通过虚线区域相同来看出。</p>
</blockquote>
<p>将此矩阵与点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 相乘的结果是一个点： <img alt="(p_{x}+sp_{z} \;\;p_{y}\;\;p_{z})^T" class="mathcode" src="https://private.codecogs.com/gif.latex?%28p_%7Bx%7D&amp;plus;sp_%7Bz%7D%20%5C%3B%5C%3Bp_%7By%7D%5C%3B%5C%3Bp_%7Bz%7D%29%5ET"> 。以图形方式显示，如图4.3所示。<img alt="\textbf{H}_{ij}(s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%28s%29"> 的倒数（相对于第 <img alt="j" class="mathcode" src="https://private.codecogs.com/gif.latex?j"> 个坐标剪切第 <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i"> 个坐标，其中 <img alt="i\neq j" class="mathcode" src="https://private.codecogs.com/gif.latex?i%5Cneq%20j"> ）是通过在相反方向上剪切产生的，即 <img alt="\textbf{H}_{ij}^{-1}(s) = \textbf{H}_{ij}(-s)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%5E%7B-1%7D%28s%29%20%3D%20%5Ctextbf%7BH%7D_%7Bij%7D%28-s%29"> 。</p>
<p>你还可以使用略有不同的剪切矩阵：</p>
<img alt="\textbf{H}_{xy}^{'}(s,t) = \begin{pmatrix} 1 &amp; 0 &amp; s &amp; 0\\ 0 &amp; 1 &amp; t &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}. \;\;\;\;\;\;\;\;(4.16)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bxy%7D%5E%7B%27%7D%28s%2Ct%29%20%3D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%20s%20%26%200%5C%5C%200%20%26%201%20%26%20t%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.16%29">

<p>然而，在此，两个下标都用于表示这些坐标将被第三坐标剪切。这两种不同类型的描述之间的联系是 <img alt="\textbf{H}_{ij}^{-1}(s,t)=\textbf{H}_{ik}(s)\textbf{H}_{jk}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BH%7D_%7Bij%7D%5E%7B-1%7D%28s%2Ct%29%3D%5Ctextbf%7BH%7D_%7Bik%7D%28s%29%5Ctextbf%7BH%7D_%7Bjk%7D%28t%29">，其中 <img alt="k" class="mathcode" src="https://private.codecogs.com/gif.latex?k"> 用作第三坐标的索引。该使用什么矩阵取决于个人偏好。最后，应该注意的是，由于任何剪切矩阵的行列式 <img alt="\begin{vmatrix} H \end{vmatrix}=1" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cbegin%7Bvmatrix%7D%20H%20%5Cend%7Bvmatrix%7D%3D1">，这是一个保留体积的变换，如图 4.3 所示。</p>
<h3 id="4-1-5-变换的级联-Concatenation-of-Transforms"><a href="#4-1-5-变换的级联-Concatenation-of-Transforms" class="headerlink" title="4.1.5 变换的级联 Concatenation of Transforms"></a><strong>4.1.5 变换的级联 Concatenation of Transforms</strong></h3><p>（注：Concatenation 指一系列相关联的事物(或事件); 这边意思是把多个矩阵结合起来。）</p>
<p>由于矩阵上乘法运算的不可交换性，因此矩阵出现的顺序很重要。因此，变换的级联被认为是顺序相关的。</p>
<p>作为顺序依赖的示例，请考虑两个矩阵 <img alt="\textbf{S}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D"> 和 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">。<img alt="\textbf{S}(2,0.5,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%282%2C0.5%2C1%29">  将 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 分量缩放为两倍，将y分量缩放为 0.5。<img alt="\textbf{R}_{z}(\pi /6)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29"> 绕 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴逆时针旋转 <img alt="\pi /6" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi%20/6"> 弧度（在右手坐标系中从本书的页面向外指向）。这些矩阵可以用两种方法进行混合，其结果是完全不同的。这两种情况如图 4.4 所示。</p>
<img alt="" height="411" src="https://img-blog.csdnimg.cn/20200414114005890.png" width="743">

<blockquote>
<p>图4.4。这说明了矩阵相乘时的顺序依赖性。在第一行图片中，应用旋转矩阵  <img alt="\textbf{R}_{z}(\pi /6)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29">，然后缩放  <img alt="\textbf{S}(\textbf{s})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">，其中 <img alt="\textbf{s}=(2,0.5,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%3D%282%2C0.5%2C1%29">。这样，合成后的矩阵为  <img alt="\textbf{S}(\textbf{s})\textbf{R}_{z}(\pi /6)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29"> 。在第二行图片中，以相反的顺序应用矩阵，从而得出  <img alt="\textbf{R}_{z}(\pi /6)\textbf{S}(\textbf{s})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bz%7D%28%5Cpi%20/6%29%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">。结果明显不同。对于任意矩阵  <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D"> 和 <img alt="\textbf{N}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BN%7D">，通常认为  <img alt="\textbf{MN}\neq \textbf{NM}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BMN%7D%5Cneq%20%5Ctextbf%7BNM%7D">。</p>
</blockquote>
<p>将一系列矩阵的连接转换为单个矩阵的明显原因是为了提高效率。例如，假设你的游戏场景具有数百万个顶点，并且场景中的所有对象都必须缩放，旋转并最终平移。现在，不是将所有顶点与这三个矩阵中的每一个相乘，而是将这三个矩阵连接到一个矩阵中。然后将此单个矩阵应用于顶点。该复合矩阵为 <img alt="\textbf{C\;=\;TRS}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BC%5C%3B%3D%5C%3BTRS%7D">。注意这里的顺序。比例矩阵 <img alt="\textbf{S}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D"> 应该首先应用于顶点，因此在合成中显示在右侧。该排序意味着<img alt="\textbf{TRSp}=\textbf{(T(R(Sp)))}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRSp%7D%3D%5Ctextbf%7B%28T%28R%28Sp%29%29%29%7D">，其中 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 是要变换的点。顺便说一句，<img alt="\textbf{TRS}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRS%7D"> 是场景图系统（scene graph systems）常用的顺序。</p>
<p>值得注意的是，尽管矩阵级联是依赖于顺序的，但是矩阵可以根据需要进行分组。例如，假设你要使用 <img alt="\textbf{TRSp}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTRSp%7D"> 计算一次刚体运动变换 <img alt="\textbf{TR}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTR%7D">。将这两个矩阵 <img alt="\textbf{(TR)(Sp)}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%28TR%29%28Sp%29%7D"> 分组在一起并用中间结果替换是有效的。因此，矩阵级联是关联的（associative）。</p>
<h3 id="4-1-6-刚体变换-The-Rigid-Body-Transform"><a href="#4-1-6-刚体变换-The-Rigid-Body-Transform" class="headerlink" title="4.1.6 刚体变换 The Rigid-Body Transform"></a><strong>4.1.6 刚体变换 The Rigid-Body Transform</strong></h3><p>当一个人抓住一个坚固的物体时，例如从桌子上用笔将其移动到另一个位置，也许移动到衬衫的口袋里，只有物体的方向和位置会发生变化，而物体的形状通常不会受到影响。这种仅由平移和旋转的串联组成的变换称为刚体变换。它具有保留长度，角度和惯用性的特性。</p>
<p>可以将任何刚体矩阵 <img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 表示为平移矩阵 <img alt="\textbf{T(t)}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%28t%29%7D"> 和旋转矩阵 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D"> 的串联。因此，<img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 在公式 4.17 中具有矩阵的外观：</p>
<img alt="\textbf{X}=\textbf{T}(t)\textbf{R}=\begin{pmatrix} r_{00} &amp; r_{01} &amp; r_{02} &amp; t_{x} \\ r_{10} &amp; r_{11} &amp; r_{12} &amp; t_{y} \\ r_{20} &amp; r_{21} &amp; r_{22} &amp; t_{z} \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;(4.17)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BT%7D%28t%29%5Ctextbf%7BR%7D%3D%5Cbegin%7Bpmatrix%7D%20r_%7B00%7D%20%26%20r_%7B01%7D%20%26%20r_%7B02%7D%20%26%20t_%7Bx%7D%20%5C%5C%20r_%7B10%7D%20%26%20r_%7B11%7D%20%26%20r_%7B12%7D%20%26%20t_%7By%7D%20%5C%5C%20r_%7B20%7D%20%26%20r_%7B21%7D%20%26%20r_%7B22%7D%20%26%20t_%7Bz%7D%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.17%29">

<p><img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 的倒数计算为 <img alt="\textbf{X}^{-1}=(\textbf{T}(\textbf{t})\textbf{R})^{-1}=\textbf{R}^{-1}\textbf{T}(\textbf{t})^{-1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%5E%7B-1%7D%3D%28%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5Ctextbf%7BR%7D%29%5E%7B-1%7D%3D%5Ctextbf%7BR%7D%5E%7B-1%7D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5E%7B-1%7D">。因此，为了计算逆，对 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D"> 的左上3×3矩阵进行转置，并且 <img alt="\textbf{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D"> 的平移值改变符号。将这两个新矩阵以相反的顺序相乘以获得逆。计算 <img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 的逆的另一种方法是考虑 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D">（使 <img alt="\textbf{R}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D"> 出现为3×3矩阵）和 <img alt="\textbf{X}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D"> 的符号如下（符号在第 6 页的公式 1.2 中描述）：</p>
<img alt="\bar{\textbf{R}}=(\textbf{r}_{,0}\;\;\textbf{r}_{,1}\;\;\textbf{r}_{,2})=\begin{pmatrix} \textbf{r}_{0,}^{T}\\ \textbf{r}_{1,}^{T}\\ \textbf{r}_{2,}^{T} \end{pmatrix},\;\;\;\;\;\;\;\;(4.18)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cbar%7B%5Ctextbf%7BR%7D%7D%3D%28%5Ctextbf%7Br%7D_%7B%2C0%7D%5C%3B%5C%3B%5Ctextbf%7Br%7D_%7B%2C1%7D%5C%3B%5C%3B%5Ctextbf%7Br%7D_%7B%2C2%7D%29%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D_%7B0%2C%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Br%7D_%7B1%2C%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Br%7D_%7B2%2C%7D%5E%7BT%7D%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.18%29">

<img alt="\Rightarrow" class="mathcode" src="https://private.codecogs.com/gif.latex?%5CRightarrow">

<img alt="\textbf{X}=\begin{pmatrix} \bar{\textbf{R}} &amp; \textbf{t}\\ \textbf{0}^{T} &amp; 1 \end{pmatrix}," class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cbar%7B%5Ctextbf%7BR%7D%7D%20%26%20%5Ctextbf%7Bt%7D%5C%5C%20%5Ctextbf%7B0%7D%5E%7BT%7D%20%26%201%20%5Cend%7Bpmatrix%7D%2C">

<p>其中，<img alt="\textbf{r}_{,0}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D_%7B%2C0%7D"> 表示旋转矩阵的第一列（即逗号表示从 0 到 2 的任何值，而第二个下标为 0），而 <img alt="\textbf{r}_{0}^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D_%7B0%7D%5E%7BT%7D"> 是列矩阵的第一行。请注意，<img alt="\textbf{0}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7B0%7D"> 是填充有零的 3×1 列向量。一些计算得出公式 4.19 中所示表达式的反函数：</p>
<img alt="\textbf{X}^{-1}=\begin{pmatrix} \textbf{r}_{0} &amp; \textbf{r}_{1} &amp; \textbf{r}_{2} &amp; -\bar{\textbf{R}}^{T}\textbf{t}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;(4.19)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%5E%7B-1%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D_%7B0%7D%20%26%20%5Ctextbf%7Br%7D_%7B1%7D%20%26%20%5Ctextbf%7Br%7D_%7B2%7D%20%26%20-%5Cbar%7B%5Ctextbf%7BR%7D%7D%5E%7BT%7D%5Ctextbf%7Bt%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.19%29">

<img alt="" height="261" src="https://img-blog.csdnimg.cn/20200414185753974.png" width="743">

<blockquote>
<p>图4.5。计算几何体变换，该变换使相机对准  <img alt="\textbf{c}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bc%7D"> 处，向量为 <img alt="\textbf{u}'" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%27">上看点  <img alt="\textbf{l}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bl%7D">。为此，我们需要计算 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">， <img alt="\textbf{u}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D">和 <img alt="\textbf{v}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D">。**</p>
</blockquote>
<p><strong>示例：调整相机的方向</strong><br>计算机图形中的常见任务是调整相机的方向，使其对准特定位置。在这里，我们将介绍 gluLookAt（）（来自OpenGL Utility Library，简称GLU）的作用。即使现在很少使用此函数调用，该任务仍然很常见。假设照相机位于 <img alt="\textbf{c}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bc%7D"> 处，我们希望照相机看着目标   <img alt="\textbf{l}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bl%7D">，并且照相机的给定方向为 <img alt="{\textbf{u}}'" class="mathcode" src="https://private.codecogs.com/gif.latex?%7B%5Ctextbf%7Bu%7D%7D%27">，如图 4.5 所示。我们要计算一个由三个向量 <img alt="\left \{ \textbf{r,\;u,\;v} \right \}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20%5Ctextbf%7Br%2C%5C%3Bu%2C%5C%3Bv%7D%20%5Cright%20%5C%7D"> 组成的基数。我们从计算视点向量为 <img alt="\textbf{v}=\textbf{(c-1)}/\left \| \textbf{c-1} \right \|" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D%3D%5Ctextbf%7B%28c-1%29%7D/%5Cleft%20%5C%7C%20%5Ctextbf%7Bc-1%7D%20%5Cright%20%5C%7C"> 开始，即从目标到摄像机位置的归一化向量。然后可以将向右看的向量计算为<img alt="\textbf{r} = -(\textbf{v }\times\textbf{u}')/\left \| \textbf{v }\times\textbf{u}' \right \|" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%20%3D%20-%28%5Ctextbf%7Bv%20%7D%5Ctimes%5Ctextbf%7Bu%7D%27%29/%5Cleft%20%5C%7C%20%5Ctextbf%7Bv%20%7D%5Ctimes%5Ctextbf%7Bu%7D%27%20%5Cright%20%5C%7C">。通常不能保证 <img alt="\textbf{u}'" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%27"> 向量指向正上方，因此最终的向上向量是另一个叉积 <img alt="\textbf{u}=\textbf{v}\times \textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%3D%5Ctextbf%7Bv%7D%5Ctimes%20%5Ctextbf%7Br%7D">，由于 <img alt="\textbf{v}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D"> 和 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 都通过构造进行了归一化和垂直处理，因此可以保证对其进行归一化。在我们将构建的相机变换矩阵 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D"> 中，其思想是首先平移所有内容，使相机位置位于原点 <img alt="\left ( 0,0,0 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C0%2C0%20%5Cright%20%29">，然后更改基数，以使 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 与 <img alt="\left ( 1,0,0 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29">，<img alt="\textbf{u}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D"> 与 <img alt="\left ( 0,1,0 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C1%2C0%20%5Cright%20%29"> 以及 <img alt="\textbf{v}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D"> 与 <img alt="\left ( 0,0,1 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%200%2C0%2C1%20%5Cright%20%29"> 。这是通过以下公式实现：</p>
<img alt="\textbf{ M}=\begin{pmatrix} r_{x} &amp; r_{y} &amp; r_{z} &amp; 0\\ u_{x} &amp; u_{y} &amp; u_{z} &amp; 0\\ v_{x} &amp; v_{y} &amp; v_{z} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix} \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; -t_{x}\\ 0 &amp; 1 &amp; 0 &amp; -t_{y}\\ 0 &amp; 0 &amp; 1 &amp; -t_{z}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix} = \begin{pmatrix} r_{x} &amp; r_{y} &amp; r_{z} &amp; -\textbf{t}\cdot -\textbf{r}\\ u_{x} &amp; u_{y} &amp; u_{z} &amp; -\textbf{t}\cdot -\textbf{u}\\ 0 &amp; 0 &amp; 1 &amp; -\textbf{t}\cdot -\textbf{v}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;(4.20)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7B%20M%7D%3D%5Cbegin%7Bpmatrix%7D%20r_%7Bx%7D%20%26%20r_%7By%7D%20%26%20r_%7Bz%7D%20%26%200%5C%5C%20u_%7Bx%7D%20%26%20u_%7By%7D%20%26%20u_%7Bz%7D%20%26%200%5C%5C%20v_%7Bx%7D%20%26%20v_%7By%7D%20%26%20v_%7Bz%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20-t_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20-t_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-t_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%20r_%7Bx%7D%20%26%20r_%7By%7D%20%26%20r_%7Bz%7D%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Br%7D%5C%5C%20u_%7Bx%7D%20%26%20u_%7By%7D%20%26%20u_%7Bz%7D%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Bu%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-%5Ctextbf%7Bt%7D%5Ccdot%20-%5Ctextbf%7Bv%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.20%29">

<p>         <img alt="" height="27" src="https://img-blog.csdnimg.cn/20200415115140755.png" width="288"></p>
<p>注意，当将平移矩阵与基本矩阵的变化连接在一起时，平移 <img alt="-\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?-%5Ctextbf%7Bt%7D"> 在右边，因为它应该首先应用。记住将 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D">，<img alt="\textbf{u}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D"> 和 <img alt="\textbf{v}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D"> 的分量放在何处的一种方法如下。我们希望 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 变成 <img alt="\left ( 1,0,0 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29">，所以当将基础矩阵的变化乘以 <img alt="\left ( 1,0,0 \right )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%28%201%2C0%2C0%20%5Cright%20%29"> 时，我们可以看到矩阵的第一行必须是 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 的元素，因为 <img alt="\textbf{r}\cdot\textbf{r}=1" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%5Ccdot%5Ctextbf%7Br%7D%3D1">。此外，第二行和第三行必须由垂直于 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 的向量组成，即 <img alt="\textbf{r}\cdot \textbf{x}=0" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D%5Ccdot%20%5Ctextbf%7Bx%7D%3D0">。当对 <img alt="\textbf{u}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D"> 和 <img alt="\textbf{v}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D"> 应用相同的思维时，我们得出以上基础矩阵的变化。</p>
<h3 id="4-1-7-法线变换-Normal-Transform"><a href="#4-1-7-法线变换-Normal-Transform" class="headerlink" title="4.1.7 法线变换 Normal Transform"></a><strong>4.1.7 法线变换 Normal Transform</strong></h3><p>单个矩阵可用于一致地变换点，线，三角形和其他几何形状。矩阵还可以沿这些线或在三角形的曲面上变换切向量。但是，矩阵不能始终用于变换一个重要的几何特性，即表面法线（和顶点照明法线）。图 4.6 显示了如果使用相同的矩阵会发生什么。</p>
<img alt="" height="266" src="https://img-blog.csdnimg.cn/20200415141436623.png" width="740">

<blockquote>
<p>图 4.6。左侧是原始几何图形，三角形以及从侧面显示的法线。中间的插图显示了如果模型沿 x 轴缩放 0.5，法线使用相同的矩阵会发生什么。右图显示了法线的正确变换。</p>
</blockquote>
<p>适当的方法不是使用矩阵本身相乘，而是使用矩阵的伴随项的转置相乘 **[227]**。伴随矩阵（adjoint）的计算在我们的在线线性代数附录中进行了描述。伴随矩阵关系始终保证存在，但法线不能保证在变换后仍是单位长度，因此通常需要将其归一化（normalized）。</p>
<p>变换法线的传统解法是计算逆的转置（the transpose of the inverse） **[1794]**。此方法通常有效。但是，完整的逆不是必需的，并且有时无法创建。逆是伴随数除以原始矩阵的行列式。如果该行列式为零，则矩阵是奇异的（singular）并且不存在逆。</p>
<p>即使只计算一个完整的 4×4 矩阵的伴随，也可能很昂贵，并且通常没有必要。由于法线是向量，因此平移不会对其产生影响。此外，大多数模型变换都是仿射的（affine）。它们不会更改传入的齐次坐标的 w 分量，也就是说，它们不会执行投影（projection）。在这些（常见）情况下，正常变换所需的仅是计算左上 3×3 分量的伴随矩阵。</p>
<p>通常甚至不需要这种伴随计算。假设我们知道变换矩阵完全由平移，旋转和统一缩放操作（无拉伸或压扁）的串联组成。可知平移不影响法线。统一的缩放因子仅改变法线的长度。剩下的就是一系列旋转，因此总是产生某种形式的最终的旋转值，仅此而已。逆的转置可用于变换法线。旋转矩阵是通过其转置矩阵为逆来定义的。代替以获得法线变换，两个转置（或两个逆）给出原始旋转矩阵。综上所述，原始变换本身也可以在这些情况下直接用于变换法线。</p>
<p>最后，并不总是需要完全重新归一化（renormalizing）生成的法线。如果仅平移和旋转连接在一起，则法线在通过矩阵进行变换时不会更改长度，因此不需要重新归一化。如果还连接了统一的缩放比例，则总缩放比例因子（如果已知或已提取，请参见第 4.2.3 节）可用于直接归一化所生成的法线。举个例子，如果我们知道应用了一系列缩放，使对象变大了 5.2 倍，则通过将此矩阵直接变换的法线除以 5.2 就会对其进行重新归一化。另外，为了创建一个产生归一化结果的法线变换矩阵，原始矩阵左上角的 3×3 可以除以该比例因子。</p>
<p>请注意，在变换之后，表面法线是从三角形得出的系统中，法线变换不是问题（例如，使用三角形边的叉积）。另外，切向量在本质上与法线不同，并且总是直接由原始矩阵变换而成。</p>
<h3 id="4-1-8-逆的计算-Computation-of-Inverses"><a href="#4-1-8-逆的计算-Computation-of-Inverses" class="headerlink" title="4.1.8 逆的计算 Computation of Inverses"></a><strong>4.1.8 逆的计算 Computation of Inverses</strong></h3><p>在许多情况下都需要逆（inverses）。例如在坐标系之间来回切换时， 根据有关变换的可用信息，我们可以使用以下三种方法之一来计算矩阵的逆：</p>
<ul>
<li>如果矩阵是单个变换或具有给定参数的简单变换序列，则该矩阵可以通过“反转参数”和矩阵顺序轻松地计算。举个例子，如果 <img alt="\textbf{M}=\textbf{T}(\textbf{t})\textbf{R}(\phi)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%3D%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%5Ctextbf%7BR%7D%28%5Cphi%29">，则 <img alt="\textbf{M}^{-1}=\textbf{R}(-\phi)\textbf{T}(-\textbf{t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D%3D%5Ctextbf%7BR%7D%28-%5Cphi%29%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bt%7D%29">。这很简单，并且保留了变换的准确性，这在渲染巨大世界时很重要 <strong>[1381]</strong> 。- 如果已知矩阵是正交的，则  <img alt="\textbf{M}^{-1}=\textbf{M}^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D%3D%5Ctextbf%7BM%7D%5E%7BT%7D">，即转置为逆。旋转的任何序列都是旋转，因此是正交的。-  如果没有任何已知条件，则可以使用伴随方法（the adjoint method），克莱姆法则（Cramer’s rule），LU分解（LU decomposition）或高斯消除法（Gaussian elimination）来计算逆。通常最好使用克莱姆法则和伴随方法，因为它们的分支操作较少； 在现代体系结构上最好避免使用“if”测试。请参阅第 4.1.7 节，了解如何使用伴随来反转变换法线。<br>优化时也可以考虑逆计算的目的。例如，如果将逆函数用于向量变换，则通常只需要对矩阵左上角的 3×3 部分进行反转（请参见上一节）。</li>
</ul>
<h2 id="4-2-特殊矩阵变换与运算-Special-Matrix-Transforms-and-Operations"><a href="#4-2-特殊矩阵变换与运算-Special-Matrix-Transforms-and-Operations" class="headerlink" title="4.2 特殊矩阵变换与运算 Special Matrix Transforms and Operations"></a><strong>4.2 特殊矩阵变换与运算 Special Matrix Transforms and Operations</strong></h2><p>在本节中，将介绍和推导一些对实时图形来说必不可少的几种矩阵变换和运算。首先，我们介绍欧拉变换（the Euler transform）及其参数提取，欧拉变换是描述方向的一种直观的方法。然后，我们会谈到从单个矩阵中提取出一组基本变换。最终，推导出一种绕任意轴旋转实体的方法。</p>
<h3 id="4-2-1-欧拉变换-The-Euler-Transform"><a href="#4-2-1-欧拉变换-The-Euler-Transform" class="headerlink" title="4.2.1 欧拉变换 The Euler Transform"></a><strong>4.2.1 欧拉变换 The Euler Transform</strong></h3><p>这种变换是构造矩阵以将自己（即相机）或任何其他实体定向到某个方向的一种直观方法。它的名字来自伟大的瑞士数学家莱昂哈德·欧拉（Leonhard Euler，1707–1783年）。</p>
<p>首先，必须建立某种默认的视图方向。如图 4.7 所示，它通常沿负 z 轴放置，head 沿 y 轴放置。欧拉变换是三个矩阵的乘积，即图中所示的旋转。更正式地说，表示为E的变换由公式 4.21 给出：</p>
<img alt="\textbf{E}(h,p,r)=\textbf{R}_{z}(r)\textbf{R}_{x}(p)\textbf{R}_{y}(h)\;\;\;\;\;\;\;\;(4.21)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%28h%2Cp%2Cr%29%3D%5Ctextbf%7BR%7D_%7Bz%7D%28r%29%5Ctextbf%7BR%7D_%7Bx%7D%28p%29%5Ctextbf%7BR%7D_%7By%7D%28h%29%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.21%29">

<p>矩阵的顺序可以以 24 种不同的方式选择 **[1636]**；这可以通过选择矩阵的顺序来实现。我们介绍这个是因为它是常用的。由于 <img alt="\textbf{E}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D"> 是旋转的串联，因此它也显然是正交的。因此，它的逆可以表示为  <img alt="\textbf{E}^{-1}=\textbf{E}^{T}=(\textbf{R}_{z}\textbf{R}_{x}\textbf{R}_{y})^{T}=\textbf{R}_{x}^{T}\textbf{R}_{y}^{T}\textbf{R}_{z}^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%5E%7B-1%7D%3D%5Ctextbf%7BE%7D%5E%7BT%7D%3D%28%5Ctextbf%7BR%7D_%7Bz%7D%5Ctextbf%7BR%7D_%7Bx%7D%5Ctextbf%7BR%7D_%7By%7D%29%5E%7BT%7D%3D%5Ctextbf%7BR%7D_%7Bx%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7By%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7Bz%7D%5E%7BT%7D">，当然，直接使用 <img alt="\textbf{E}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D"> 的转置会更容易。</p>
<p>欧拉角 <img alt="h" class="mathcode" src="https://private.codecogs.com/gif.latex?h">，<img alt="p" class="mathcode" src="https://private.codecogs.com/gif.latex?p"> 和 <img alt="r" class="mathcode" src="https://private.codecogs.com/gif.latex?r"> 分别表示 head，pitch 和 roll 应按其顺序旋转以及绕其各自的轴旋转多少。有时，所有角度都称为“rolls”，例如，我们的“head”为“ y-roll”，而我们的“pitch”为“ x-roll”。另外，“head”有时也称为“yaw”，例如在飞行模拟中。</p>
<p>这种变换很直观，因此很容易用外行的语言进行讨论。例如，改变 head 角度会使观看者摇头“no”，改变 pitch 会使他们点头，而 rolling 会使他们的 head 向侧面倾斜。我们不是在谈论围绕 x ， y 和 z 轴 的旋转，而是谈论改变 head，pitch 和 roll。请注意，此变换不仅可以定向相机，还可以定向任何对象或实体。可以使用世界空间的全局轴（the global axes of the world space）或相对于局部参照系执行这些变换。</p>
<p>重要的是要注意，一些欧拉角的表示将 z 轴作为初始向上方向。这种差异纯粹是一种符号上的变化，尽管可能会造成混淆。在计算机图形学中，如何看待世界以及如何形成内容存在分歧：y 向上 或 z 向上。大多数制造工艺（包括3D打印）都认为 z 方向在世界空间中向上。航空和海上交通工具认为 -z 为向上。建筑和 GIS（地理信息系统，Geographic Information System 或 Geo－Information system，缩写为 GIS） 通常使用 z-up，因为建筑平面图或地图是二维的 x 和 y 。与媒体相关的建模系统通常将 y 方向视为世界坐标上的向上方向，以匹配我们始终在计算机图形学中描述相机的屏幕向上方向的方式。这两个世界向量选择之间的差异仅相差 90° 旋转（并且可能是反射），但不知道假定哪个会导致问题。在本卷中，除非另有说明，否则我们使用 y 向上的世界方向。</p>
<img alt="" height="606" src="https://img-blog.csdnimg.cn/20200416105436474.png" width="738">

<blockquote>
<p>图4.7。欧拉变换及其与更改 head，pitch 和 roll 的方式之间的关系。显示默认视图方向，沿负z轴看，向上方向沿y轴看。</p>
</blockquote>
<p>我们还想指出，相机在其视野中的向上方向与世界的向上方向没有特别关系。转动 head，视野就会倾斜，其世界空间向上方向与世界方向不同。再举一个例子，假设世界使用 y-up，而我们的相机则直视下方的地形，鸟瞰。此方向表示相机已向前倾斜 90°，因此其在世界空间中的向上方向为  <img alt="(0,0,-1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%280%2C0%2C-1%29">。在这种方向上，相机没有 y 分量，而是认为 -z 在世界空间中向上，但根据定义，“ y在上方”在视图空间（view space）中仍然适用。</p>
<p>欧拉角虽然适用于较小的角度变化或观看者方向，但还有其他一些严重的限制——很难将两组欧拉角组合使用。例如，在一组和另一组之间进行插值并不是对每个角度进行插值的简单问题。实际上，两组不同的欧拉角可以给出相同的方向，因此任何插值都不应旋转对象。这些是使用本章稍后讨论的替代方向表示形式（例如四元数）值得追求的一些原因。使用欧拉角，你还会遇到被称为万向节锁定（gimbal lock）的问题，这将在第 4.2.2 节中介绍。</p>
<h3 id="4-2-2-从欧拉变换中提取参数-Extracting-Parameters-from-the-Euler-Transform"><a href="#4-2-2-从欧拉变换中提取参数-Extracting-Parameters-from-the-Euler-Transform" class="headerlink" title="4.2.2 从欧拉变换中提取参数 Extracting Parameters from the Euler Transform"></a><strong>4.2.2 从欧拉变换中提取参数 Extracting Parameters from the Euler Transform</strong></h3><p>在某些情况下，使用从正交矩阵中提取欧拉参数 h，p 和 r 的过程很有用。此过程如公式 4.22 所示：</p>
<img alt="\textbf{E}(h,p,r)=\begin{pmatrix} e_{00} &amp; e_{01} &amp; e_{02}\\ e_{10} &amp; e_{11} &amp; e_{12}\\ e_{20} &amp; e_{21} &amp; e_{22} \end{pmatrix}= \textbf{R}_{z}(r)\textbf{R}_{x}(p)\textbf{R}_{y}(h).\;\;\;\;\;\;\;\;(4.22)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%28h%2Cp%2Cr%29%3D%5Cbegin%7Bpmatrix%7D%20e_%7B00%7D%20%26%20e_%7B01%7D%20%26%20e_%7B02%7D%5C%5C%20e_%7B10%7D%20%26%20e_%7B11%7D%20%26%20e_%7B12%7D%5C%5C%20e_%7B20%7D%20%26%20e_%7B21%7D%20%26%20e_%7B22%7D%20%5Cend%7Bpmatrix%7D%3D%20%5Ctextbf%7BR%7D_%7Bz%7D%28r%29%5Ctextbf%7BR%7D_%7Bx%7D%28p%29%5Ctextbf%7BR%7D_%7By%7D%28h%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.22%29">

<p>在这里，我们放弃了 3×3 矩阵的 4×4 矩阵，因为后者提供了旋转矩阵的所有必要信息。也就是说，等效的 4×4 矩阵的其余部分始终在右下位置包含 0 和一个 1。</p>
<p>将公式 4.22 中的三个旋转矩阵串联起来：</p>
<img alt="\textbf{E}=\begin{pmatrix} cos\;r\;cos\;h -sin\;r\;sin\;p\;sin\;h\;&amp; -sin\;r\;cos\;p &amp; cos\;r\;sin\;h -sin\;r\;sin\;p\;cos\;h\; \\ sin\;r\;cos\;h -cos\;r\;sin\;p\;sin\;h\; &amp; cos\;r\;cos\;p &amp; sin\;r\;sin\;h-cos\;r\;sin\;p\;cos\;h\\ -cos\;p\;sin\;h &amp; sin\;p &amp; cos\;p\;cos\;h \end{pmatrix}.\;\;\;\;\;\;\;\;(4.23)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%3D%5Cbegin%7Bpmatrix%7D%20cos%5C%3Br%5C%3Bcos%5C%3Bh%20-sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bsin%5C%3Bh%5C%3B%26%20-sin%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20cos%5C%3Br%5C%3Bsin%5C%3Bh%20-sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bcos%5C%3Bh%5C%3B%20%5C%5C%20sin%5C%3Br%5C%3Bcos%5C%3Bh%20-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bsin%5C%3Bh%5C%3B%20%26%20cos%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20sin%5C%3Br%5C%3Bsin%5C%3Bh-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%3Bcos%5C%3Bh%5C%5C%20-cos%5C%3Bp%5C%3Bsin%5C%3Bh%20%26%20sin%5C%3Bp%20%26%20cos%5C%3Bp%5C%3Bcos%5C%3Bh%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.23%29">

<p>由此可见，pitch 参数由 <img alt="sin\;p=e_{21}" class="mathcode" src="https://private.codecogs.com/gif.latex?sin%5C%3Bp%3De_%7B21%7D"> 给出。同样，将 <img alt="e_{01}" class="mathcode" src="https://private.codecogs.com/gif.latex?e_%7B01%7D"> 除以 <img alt="e_{11}" class="mathcode" src="https://private.codecogs.com/gif.latex?e_%7B11%7D">，并类似地将 <img alt="e_{20}" class="mathcode" src="https://private.codecogs.com/gif.latex?e_%7B20%7D"> 除以 <img alt="e_{22}" class="mathcode" src="https://private.codecogs.com/gif.latex?e_%7B22%7D">，会产生以下用于 head 和 roll 参数的提取公式：</p>
<img alt="\frac{e_{01}}{e_{11}}=\frac{-sin\;r}{cos\;r}=-tan\;r\;\;\;\;and\;\;\;\;\frac{e_{20}}{e_{22}}=\frac{-sin\;h}{cos\;h}=-tan\;h\;\;\;\;\;\;\;\;(4.24)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cfrac%7Be_%7B01%7D%7D%7Be_%7B11%7D%7D%3D%5Cfrac%7B-sin%5C%3Br%7D%7Bcos%5C%3Br%7D%3D-tan%5C%3Br%5C%3B%5C%3B%5C%3B%5C%3Band%5C%3B%5C%3B%5C%3B%5C%3B%5Cfrac%7Be_%7B20%7D%7D%7Be_%7B22%7D%7D%3D%5Cfrac%7B-sin%5C%3Bh%7D%7Bcos%5C%3Bh%7D%3D-tan%5C%3Bh%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.24%29">

<p>因此，如公式 4.25 所示，使用函数 atan2（y，x）（请参阅第1章第8页）从矩阵E提取欧拉参数h（head），p（pitch）和r（roll）：</p>
<img alt="\\h = atan2(-e_{20},e_{22}),\\ p=arcsin(e_{21}),\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.25)\\ r=atan2(-e_{01},e_{11}).\\" class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5Ch%20%3D%20atan2%28-e_%7B20%7D%2Ce_%7B22%7D%29%2C%5C%5C%20p%3Darcsin%28e_%7B21%7D%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.25%29%5C%5C%20r%3Datan2%28-e_%7B01%7D%2Ce_%7B11%7D%29.%5C%5C">

<p>但是，有一种特殊情况需要处理。如果 <img alt="cos p = 0" class="mathcode" src="https://private.codecogs.com/gif.latex?cos%20p%20%3D%200">，则具有万向节锁定（第 4.2.2 节），旋转角度r和h将绕同一轴旋转（尽管可能沿不同的方向旋转，具体取决于 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 旋转角度是 <img alt="-\pi /2" class="mathcode" src="https://private.codecogs.com/gif.latex?-%5Cpi%20/2"> 还是 <img alt="\pi /2" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi%20/2"> ），因此只需导出一个角度。如果我们任意设置 <img alt="h=0" class="mathcode" src="https://private.codecogs.com/gif.latex?h%3D0"> **[1769]**，我们得到</p>
<img alt="\textbf{E}=\begin{pmatrix} cos\;r &amp; sin\;r\;cos\;p &amp; sin\;r\;sin\;p\\ sin\;r &amp; cos\;r\;cos\;p &amp; -cos\;r\;sin\;p\\ 0 &amp; sin\;p &amp; cos\;p \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.26)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D%3D%5Cbegin%7Bpmatrix%7D%20cos%5C%3Br%20%26%20sin%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20sin%5C%3Br%5C%3Bsin%5C%3Bp%5C%5C%20sin%5C%3Br%20%26%20cos%5C%3Br%5C%3Bcos%5C%3Bp%20%26%20-cos%5C%3Br%5C%3Bsin%5C%3Bp%5C%5C%200%20%26%20sin%5C%3Bp%20%26%20cos%5C%3Bp%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.26%29">

<p>由于 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 不影响第一列中的值，因此当 <img alt="cos\;p=0" class="mathcode" src="https://private.codecogs.com/gif.latex?cos%5C%3Bp%3D0"> 时，我们可以使用 <img alt="sin\;r/cos\;r=tan\;r=e_{10}/e_{00}" class="mathcode" src="https://private.codecogs.com/gif.latex?sin%5C%3Br/cos%5C%3Br%3Dtan%5C%3Br%3De_%7B10%7D/e_%7B00%7D">，得出  <img alt="r=atan2(e_{10},e_{00})" class="mathcode" src="https://private.codecogs.com/gif.latex?r%3Datan2%28e_%7B10%7D%2Ce_%7B00%7D%29">。</p>
<p>请注意，根据反正弦的定义，<img alt="-\pi/2\leqslant p\leqslant \pi/2" class="mathcode" src="https://private.codecogs.com/gif.latex?-%5Cpi/2%5Cleqslant%20p%5Cleqslant%20%5Cpi/2">，这意味着如果使用该间隔之外的 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 值创建 <img alt="\textbf{E}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BE%7D">，则无法提取原始参数。<img alt="h" class="mathcode" src="https://private.codecogs.com/gif.latex?h">，<img alt="p" class="mathcode" src="https://private.codecogs.com/gif.latex?p"> 和 <img alt="r" class="mathcode" src="https://private.codecogs.com/gif.latex?r"> 不是唯一的，意味着可以使用一组以上的欧拉参数来产生相同的变换。有关欧拉角转换的更多信息，请参见 Shoemake 的 1994 年文章 **[1636]**。上面概述的简单方法可能会导致数值不稳定的问题，这在速度方面会付出一定的代价来避免 **[1362]**。</p>
<p>当您使用欧拉变换时，可能会发生万向节锁定（gimbal lock）**[499，1633]**。这发生在旋转时，会因此失去一个自由度。举个例子，变换的顺序是 <img alt="x/y/z" class="mathcode" src="https://private.codecogs.com/gif.latex?x/y/z">。假设第二次旋转我们绕 y 轴旋转 <img alt="\pi/2" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi/2">。这样做会旋转局部 z 轴以使其与原始 x 轴对齐，因此围绕 z 的最终旋转是不正确的。</p>
<p>在数学上，我们已经在公式 4.26 中看到了万向节锁定，其中假设 <img alt="cos\;p = 0" class="mathcode" src="https://private.codecogs.com/gif.latex?cos%5C%3Bp%20%3D%200">，即 <img alt="p=\pm \pi /2+2\pi k" class="mathcode" src="https://private.codecogs.com/gif.latex?p%3D%5Cpm%20%5Cpi%20/2&amp;plus;2%5Cpi%20k">，其中 <img alt="k" class="mathcode" src="https://private.codecogs.com/gif.latex?k"> 是整数。有了这样的 <img alt="p" class="mathcode" src="https://private.codecogs.com/gif.latex?p"> 值，我们失去了一个自由度，因为矩阵仅取决于一个角度 <img alt="r+h" class="mathcode" src="https://private.codecogs.com/gif.latex?r&amp;plus;h"> 或 <img alt="r-h" class="mathcode" src="https://private.codecogs.com/gif.latex?r-h">（但不是同时取决于两个角度）。</p>
<p>尽管在模型系统中通常以 <img alt="x/y/z" class="mathcode" src="https://private.codecogs.com/gif.latex?x/y/z"> 顺序表示欧拉角，但绕每个局部轴旋转时，其他顺序也是可行的。例如，动画中使用 <img alt="z/x/y" class="mathcode" src="https://private.codecogs.com/gif.latex?z/x/y">，动画和物理学中都使用 <img alt="z/x/z" class="mathcode" src="https://private.codecogs.com/gif.latex?z/x/z">。所有都是指定三个单独旋转的有效方法。最后的 <img alt="z/x/z" class="mathcode" src="https://private.codecogs.com/gif.latex?z/x/z"> 顺序在某些应用中可能会更好，因为只有当绕 x 旋转 <img alt="\pi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi"> 弧度（半旋转）时，才会发生万向节锁定。没有完美的序列可以避免万向节锁定。尽管如此，欧拉角还是很常用的，因为动画师更喜欢曲线编辑器来指定角度如何随时间变化 **[499]**。</p>
<p><strong>示例：约束变换</strong><br>想象您拿着一把（虚拟的）扳手紧紧地抓住螺栓。为了将螺栓固定到位，您必须围绕 x 轴旋转扳手。现在假设您的输入设备（鼠标，VR手套，太空球等）为扳手的运动提供了一个旋转矩阵，即一个旋转矩阵。问题在于，将这种变换应用于扳手，扳手应该只绕x轴旋转，这可能是错误的。要将输入变换（称为 <img alt="\textbf{P}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D">）限制为绕 x 轴旋转，只需使用本节中介绍的方法提取欧拉角 <img alt="h" class="mathcode" src="https://private.codecogs.com/gif.latex?h">，<img alt="p" class="mathcode" src="https://private.codecogs.com/gif.latex?p"> 和 <img alt="r" class="mathcode" src="https://private.codecogs.com/gif.latex?r">，然后创建一个新矩阵 <img alt="\textbf{R}_{x}(p)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28p%29"> 。然后，这是一种受欢迎的变换，它将使扳手绕 x 轴旋转（如果 <img alt="\textbf{P}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D"> 现在包含这样的运动）。</p>
<h3 id="4-2-3-矩阵分解-Matrix-Decomposition"><a href="#4-2-3-矩阵分解-Matrix-Decomposition" class="headerlink" title="4.2.3 矩阵分解 Matrix Decomposition"></a><strong>4.2.3 矩阵分解 Matrix Decomposition</strong></h3><p>到目前为止，我们一直在假设我们知道所使用的变换矩阵的初始状态和历史记录的情况下进行工作。通常情况下并非如此。例如，仅连接的矩阵可以与某个变换后的对象相关联。从级联矩阵中提取各种变换的任务称为矩阵分解（matrix decomposition）。</p>
<p>提取变换的原因有很多。用途包括：</p>
<ul>
<li>为对象提取比例因子。</li>
<li>查找特定系统所需的变换。（例如，某些系统可能不允许使用任意 4×4 矩阵。）</li>
<li>确定模型是否仅经历了刚体变换。</li>
<li>在动画中的关键帧之间进行插值，其中仅对象的矩阵可用。</li>
<li>从旋转矩阵中删除剪切。<br>我们已经提出了两种分解方法，分别是为刚体变换导出平移和旋转矩阵（第4.1.6节）以及从正交矩阵导出欧拉角（第4.2.2节）。</li>
</ul>
<p>正如我们所看到的，提取变换矩阵很简单，因为我们只需要 4×4 矩阵的最后一列中的元素。我们还可以通过检查矩阵的行列式是否为负来确定是否发生了反射。要分离出旋转，缩放和剪切，需要花费更多的精力。</p>
<p>幸运的是，有几篇关于该主题的文章以及在线提供的代码。Thomas <strong>[1769]</strong> 和Goldman <strong>[552，553]</strong> 各自针对各种类型的变换提出了一些不同的方法。Shoemake <strong>[1635]</strong> 改进了他们的仿射矩阵技术，因为他的算法与参考系无关，并尝试分解矩阵以获得刚体变换。</p>
<h3 id="4-2-4-绕任意轴旋转-Rotation-about-an-Arbitrary-Axis"><a href="#4-2-4-绕任意轴旋转-Rotation-about-an-Arbitrary-Axis" class="headerlink" title="4.2.4 绕任意轴旋转 Rotation about an Arbitrary Axis"></a>4.2.4 绕任意轴旋转 Rotation about an Arbitrary Axis</h3><p>有时使用使实体绕任意轴旋转某个角度的过程会很方便。假设旋转轴 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 已归一化，并且应该创建一个围绕 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 旋转 <img alt="\alpha" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Calpha"> 弧度的变换。</p>
<p>为此，我们首先变换到一个空间，这个空间里我们要围绕其旋转的轴是 x 轴。这是通过一个称为 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D"> 的旋转矩阵完成的。然后执行实际的旋转，之后使用 <img alt="\textbf{M}^{-1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7B-1%7D"> 进行变换 **[314]**。此过程如图 4.8 所示。<br><img alt="" class="has" height="180" src="https://img-blog.csdnimg.cn/20210113142811713.png" width="619"></p>
<blockquote>
<p>图4.8 绕任意轴r旋转是通过找到由r，s和t形成的正交法线来实现的。 然后，我们将此基准与标准基准对齐，以使r与x轴对齐。在那里绕着x轴旋转，最后我们转换回原样。</p>
</blockquote>
<p>为了计算 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">，我们需要找到两个对 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 来说正交的轴。我们专注于找到第二根轴s，知道第三根轴t将是第一根轴和第二根轴的叉积，<img alt="\textbf{t}=\textbf{r}\times \textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D%3D%5Ctextbf%7Br%7D%5Ctimes%20%5Ctextbf%7Bs%7D"> 。一种数字稳定的方法是找到 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 的最小成分（绝对值），并将其设置为 0。交换剩余的两个成分，然后对它们中的第一个取反（实际上，可以否定非零分量中的任何一个）。在数学上，这表示为 **[784]**：</p>
<img alt="\\ \bar{\textbf{s}}=\left\{\begin{matrix} (0,-r_{z},r_{y}),\;\;\textbf{if}\;\;\left | r_{x} \right |\leqslant \left | r_{y} \right |\;and\;\left | r_{x} \right |\leqslant \left | r_{z} \right |,\\ (-r_{z},0,r_{x}),\;\;\textbf{if}\;\;\left | r_{y} \right |\leqslant \left | r_{x} \right |\;and\;\left | r_{y} \right |\leqslant \left | r_{z} \right |,\\ (-r_{y},r_{x},0),\;\;\textbf{if}\;\;\left | r_{z} \right |\leqslant \left | r_{x} \right |\;and\;\left | r_{z} \right |\leqslant \left | r_{y} \right |, \end{matrix}\right.\;\;\;\;\;\;\;\;\;\;(4.27) \\ \textbf{s}=\bar{\textbf{s}}/\left \| \bar{\textbf{s}} \right \|, \\ \textbf{t}=\textbf{r}\times \textbf{s}." class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20%5Cbar%7B%5Ctextbf%7Bs%7D%7D%3D%5Cleft%5C%7B%5Cbegin%7Bmatrix%7D%20%280%2C-r_%7Bz%7D%2Cr_%7By%7D%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%2C%5C%5C%20%28-r_%7Bz%7D%2C0%2Cr_%7Bx%7D%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%2C%5C%5C%20%28-r_%7By%7D%2Cr_%7Bx%7D%2C0%29%2C%5C%3B%5C%3B%5Ctextbf%7Bif%7D%5C%3B%5C%3B%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7Bx%7D%20%5Cright%20%7C%5C%3Band%5C%3B%5Cleft%20%7C%20r_%7Bz%7D%20%5Cright%20%7C%5Cleqslant%20%5Cleft%20%7C%20r_%7By%7D%20%5Cright%20%7C%2C%20%5Cend%7Bmatrix%7D%5Cright.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.27%29%20%5C%5C%20%5Ctextbf%7Bs%7D%3D%5Cbar%7B%5Ctextbf%7Bs%7D%7D/%5Cleft%20%5C%7C%20%5Cbar%7B%5Ctextbf%7Bs%7D%7D%20%5Cright%20%5C%7C%2C%20%5C%5C%20%5Ctextbf%7Bt%7D%3D%5Ctextbf%7Br%7D%5Ctimes%20%5Ctextbf%7Bs%7D.">

<p>这保证了 <img alt="\bar{\textbf{s}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cbar%7B%5Ctextbf%7Bs%7D%7D"> 与 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 正交（垂直），并且 <img alt="(\textbf{r},\textbf{s},\textbf{t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%28%5Ctextbf%7Br%7D%2C%5Ctextbf%7Bs%7D%2C%5Ctextbf%7Bt%7D%29"> 是正交的基础。Frisvad <strong>[496]</strong> 提出了一种在代码中没有任何分支的方法，该方法速度更快，但准确性较低。Max <strong>[1147]</strong> 和 Duff 等。**[388]** 提高了 Frisvad 方法的准确性。无论采用哪种技术，都会使用这三个向量来创建旋转矩阵：</p>
<img alt="\textbf{M}=\begin{pmatrix} \textbf{r}^{T}\\ \textbf{s}^{T}\\ \textbf{t}^{T} \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.28)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Ctextbf%7Br%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Bs%7D%5E%7BT%7D%5C%5C%20%5Ctextbf%7Bt%7D%5E%7BT%7D%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.28%29">

<p>该矩阵将向量 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 变换为 x 轴，将 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 变换为 y 轴，将 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 变换为 z 轴。因此，然后使围绕标准化向量 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 旋转 <img alt="\alpha" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Calpha"> 弧度的最终变换为：</p>
<img alt="\textbf{X}=\textbf{M}^{T}\textbf{R}_{x}(\alpha )\textbf{M}.\;\;\;\;\;\;\;\;\;\;(4.29)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BX%7D%3D%5Ctextbf%7BM%7D%5E%7BT%7D%5Ctextbf%7BR%7D_%7Bx%7D%28%5Calpha%20%29%5Ctextbf%7BM%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.29%29">

<p>换句话说，这意味着首先我们进行变换，使 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 为 x 轴（使用 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D">），然后围绕该 x 轴旋转 <img alt="\alpha" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Calpha"> 弧度（使用 <img alt="\textbf{R}_{x}(\alpha )" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D_%7Bx%7D%28%5Calpha%20%29">），然后使用 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D"> 的逆函数进行变换 ，在这种情况下为 <img alt="\textbf{M}^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7BT%7D">，因为 <img alt="\textbf{M}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D"> 是正交的。</p>
<p>Goldman **[550]**提出了另一种通过 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 弧度绕任意归一化轴 <img alt="\textbf{r}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Br%7D"> 旋转的方法。在这里，我们只介绍他的变换：</p>
<p><img alt="\\\textbf{R}= \begin{pmatrix} cos\;\phi+(1-cos\;\phi)r_{x}^{2} &amp; (1-cos\;\phi)r_{x}r_{y}-r_{z}sin\;\phi &amp; (1-cos\;\phi)r_{x}r_{z}+r_{y}sin\;\phi\\ (1-cos\;\phi)r_{x}r_{y} +r_{z}sin\;\phi &amp; cos\;\phi+(1-cos\;\phi)r_{y}^{2} &amp; (1-cos\;\phi)r_{y}r_{z}-r_{x}sin\;\phi\\ (1-cos\;\phi)r_{x}r_{z}-r_{y}sin\;\phi &amp; (1-cos\;\phi)r_{y}r_{z}+r_{x}sin\;\phi &amp; cos\;\phi+(1-cos\;\phi)r_{z}^{2} \end{pmatrix}\\" class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%5Ctextbf%7BR%7D%3D%20%5Cbegin%7Bpmatrix%7D%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7Bx%7D%5E%7B2%7D%20%26%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7By%7D-r_%7Bz%7Dsin%5C%3B%5Cphi%20%26%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7Bz%7D&amp;plus;r_%7By%7Dsin%5C%3B%5Cphi%5C%5C%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7By%7D%20&amp;plus;r_%7Bz%7Dsin%5C%3B%5Cphi%20%26%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7By%7D%5E%7B2%7D%20%26%20%281-cos%5C%3B%5Cphi%29r_%7By%7Dr_%7Bz%7D-r_%7Bx%7Dsin%5C%3B%5Cphi%5C%5C%20%281-cos%5C%3B%5Cphi%29r_%7Bx%7Dr_%7Bz%7D-r_%7By%7Dsin%5C%3B%5Cphi%20%26%20%281-cos%5C%3B%5Cphi%29r_%7By%7Dr_%7Bz%7D&amp;plus;r_%7Bx%7Dsin%5C%3B%5Cphi%20%26%20cos%5C%3B%5Cphi&amp;plus;%281-cos%5C%3B%5Cphi%29r_%7Bz%7D%5E%7B2%7D%20%5Cend%7Bpmatrix%7D%5C%5C"><img alt=".\;\;\;\;\;\;\;\;\;\;(4.30)" class="mathcode" src="https://private.codecogs.com/gif.latex?.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.30%29"></p>
<p>在第 4.3.2 节中，我们提出了解决此问题的另一种方法，使用四元数（Quaternions）。在那个部分中，还有针对相关问题（例如从一个向量到另一个向量的旋转）的更高效的算法。</p>
<h2 id="4-3-四元数-Quaternions"><a href="#4-3-四元数-Quaternions" class="headerlink" title="4.3 四元数 Quaternions"></a><strong>4.3 四元数 Quaternions</strong></h2><p>四元数是复数的扩展，尽管它是威廉·罗恩·汉密尔顿爵士（Sir William Rowan Hamilton）于1843年发明的，但直到1985年，Shoemake <strong>[1633]</strong> 才将它们引入计算机图形学领域。**(1)** 四元数用于表示旋转和方向。它们在几种方面都优于欧拉角和矩阵。任何三维定向都可以表示为围绕特定轴的单个旋转。当给出了该轴和角度表示后，四元数的平移很简单，而在任一方向上的欧拉角转换都十分有挑战性。四元数可用于稳定方向和恒定插值，而欧拉角无法很好地完成这些操作。</p>
<p>复数（complex number）具有实部和虚部。每个复数都由两个实数表示，其中第二个实数乘以 <img alt="\sqrt{1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Csqrt%7B1%7D">。同样，四元数有四个部分。前三个值与旋转轴密切相关，旋转角影响所有四个部分（有关更多信息，请参见第 4.3.2 节）。每个四元数由四个实数表示，每个实数与一个不同的部分相关联。由于四元数具有四个分量，因此我们选择将它们表示为向量，但是为了区分它们，我们在它们上加了一个帽子：<img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">。我们从四元数的一些数学背景开始，然后将其用于构建各种有用的变换。</p>
<p><strong>作者注：</strong></p>
<p><strong>(1)</strong> 公正地说，Robinson **[1502]**在 1958 年就将四元数用于刚体模拟。</p>
<h3 id="4-3-1-数学背景-Mathematical-Background"><a href="#4-3-1-数学背景-Mathematical-Background" class="headerlink" title="4.3.1 数学背景 Mathematical Background"></a>4.3.1 数学背景 Mathematical Background</h3><p>我们从四元数的定义开始。</p>
<h3 id="4-3-2-四元数变换-Quaternion-Transforms"><a href="#4-3-2-四元数变换-Quaternion-Transforms" class="headerlink" title="4.3.2 四元数变换 Quaternion Transforms"></a>4.3.2 四元数变换 Quaternion Transforms</h3><img alt="" height="264" src="https://img-blog.csdnimg.cn/20200421163352291.png" width="738">

<blockquote>
<p>图 4.9。由单位四元数  <img alt="\hat{\textbf{q}}=(sin\;\phi\textbf{u}_{q},cos\;\phi)." class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D%3D%28sin%5C%3B%5Cphi%5Ctextbf%7Bu%7D_%7Bq%7D%2Ccos%5C%3B%5Cphi%29.">  表示的旋转变换的图示。变换围绕轴 <img alt="\textbf{u}_{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D_%7Bq%7D"> 旋转 <img alt="2\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?2%5Cphi"> 弧度。</p>
</blockquote>
<p> <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 的任何非零实数倍也表示相同的变换，这意味着 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 和 <img alt="-\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?-%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 表示相同的旋转。也就是说，取反轴 <img alt="\textbf{u}_{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D_%7Bq%7D"> 和实部 <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D">，将生成一个四元数，该四元数的旋转与原始四元数的旋转完全相同。这也意味着从矩阵中提取四元数可以返回 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 或 <img alt="-\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?-%5Chat%7B%5Ctextbf%7Bq%7D%7D">。</p>
<p>给定两个单位四元数 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 和 <img alt="\hat{\textbf{r}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D">，首先将 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 然后应用于四元数 <img alt="\hat{\textbf{p}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bp%7D%7D">（可以解释为点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">）的连接由式 4.44 给出：</p>
<img alt="\hat{\textbf{r}}(\hat{\textbf{q}}\hat{\textbf{p}}\hat{\textbf{q}}^{*})\hat{\textbf{r}}^{*}=(\hat{\textbf{r}}\hat{\textbf{q}})\hat{\textbf{q}}(\hat{\textbf{r}}\hat{\textbf{q}})^{*}=\hat{\textbf{c}}\hat{\textbf{p}}\hat{\textbf{c}}^{*}.\;\;\;\;\;\;\;\;\;\;(4.44)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%5Chat%7B%5Ctextbf%7Bp%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%5E%7B*%7D%29%5Chat%7B%5Ctextbf%7Br%7D%7D%5E%7B*%7D%3D%28%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5Chat%7B%5Ctextbf%7Bq%7D%7D%28%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5E%7B*%7D%3D%5Chat%7B%5Ctextbf%7Bc%7D%7D%5Chat%7B%5Ctextbf%7Bp%7D%7D%5Chat%7B%5Ctextbf%7Bc%7D%7D%5E%7B*%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.44%29">

<p>在此，<img alt="\hat{\textbf{c}}=\hat{\textbf{r}}\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bc%7D%7D%3D%5Chat%7B%5Ctextbf%7Br%7D%7D%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 是表示单元四元数 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 和 <img alt="\hat{\textbf{r}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D"> 的级联的单元四元数。</p>
<p><strong>矩阵转换（Matrix Conversion）</strong><br>由于通常需要组合几个不同的变换，并且大多数变换都是矩阵形式，因此需要一种将公式4.43转换为矩阵的方法。四元数 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 可以转换成矩阵 <img alt="\textbf{M}^{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D">，如公式 4.45 **[1633，1634]**所示：</p>
<img alt="\textbf{M}^{q}=\begin{pmatrix} 1-s(q_{y}^{2}+q_{z}^{2}) &amp; s(q_{x}q_{y}-q_{w}q_{z}) &amp; s(q_{x}q_{z}+q_{w}q_{y}) &amp; 0 \\ s(q_{x}q_{y}+q_{w}q_{z}) &amp; 1-s(q_{x}^{2}+q_{z}^{2}) &amp; s(q_{y}q_{z}-q_{w}q_{x}) &amp; 0 \\ s(q_{x}q_{z}-q_{w}q_{y}) &amp; s(q_{y}q_{z}+q_{w}q_{x}) &amp; 1-s(q_{x}^{2}+q_{y}^{2}) &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;(4.45)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D%3D%5Cbegin%7Bpmatrix%7D%201-s%28q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%20s%28q_%7Bx%7Dq_%7By%7D-q_%7Bw%7Dq_%7Bz%7D%29%20%26%20s%28q_%7Bx%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7By%7D%29%20%26%200%20%5C%5C%20s%28q_%7Bx%7Dq_%7By%7D&amp;plus;q_%7Bw%7Dq_%7Bz%7D%29%20%26%201-s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%20s%28q_%7By%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7Bx%7D%29%20%26%200%20%5C%5C%20s%28q_%7Bx%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7By%7D%29%20%26%20s%28q_%7By%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7Bx%7D%29%20%26%201-s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D%29%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.45%29">

<p>在此，标量为 <img alt="s=2/(n(\hat{\textbf{q}}))" class="mathcode" src="https://private.codecogs.com/gif.latex?s%3D2/%28n%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%29">。对于单元四元数，这简化为</p>
<img alt="\textbf{M}^{q}=\begin{pmatrix} 1-2(q_{y}^{2}+q_{z}^{2}) &amp; 2(q_{x}q_{y}-q_{w}q_{z}) &amp; 2(q_{x}q_{z}+q_{w}q_{y}) &amp; 0 \\ 2(q_{x}q_{y}+q_{w}q_{z}) &amp; 1-2(q_{x}^{2}+q_{z}^{2}) &amp; 2(q_{y}q_{z}-q_{w}q_{x}) &amp; 0 \\ 2(q_{x}q_{z}-q_{w}q_{y}) &amp; 2(q_{y}q_{z}+q_{w}q_{x}) &amp; 1-2(q_{x}^{2}+q_{y}^{2}) &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;(4.46)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D%3D%5Cbegin%7Bpmatrix%7D%201-2%28q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%202%28q_%7Bx%7Dq_%7By%7D-q_%7Bw%7Dq_%7Bz%7D%29%20%26%202%28q_%7Bx%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7By%7D%29%20%26%200%20%5C%5C%202%28q_%7Bx%7Dq_%7By%7D&amp;plus;q_%7Bw%7Dq_%7Bz%7D%29%20%26%201-2%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%20%26%202%28q_%7By%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7Bx%7D%29%20%26%200%20%5C%5C%202%28q_%7Bx%7Dq_%7Bz%7D-q_%7Bw%7Dq_%7By%7D%29%20%26%202%28q_%7By%7Dq_%7Bz%7D&amp;plus;q_%7Bw%7Dq_%7Bx%7D%29%20%26%201-2%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D%29%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.46%29">

<p>一旦构建了四元数，就无需计算三角函数（trigonometric functions），因此转换过程实际上是有效的。</p>
<p>从正交矩阵 <img alt="\textbf{M}^{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D%5E%7Bq%7D"> 到单位四元数 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 的反向转换要复杂得多。此过程的关键是公式 4.46 中的矩阵具有以下差异：</p>
<img alt="\\ \\m_{21}^{q}-m_{12}^{q}=4q_{w}q_{x}, \\m_{02}^{q}-m_{20}^{q}=4q_{w}q_{y},\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.47) \\m_{10}^{q}-m_{01}^{q}=4q_{w}q_{z}." class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20%5C%5Cm_%7B21%7D%5E%7Bq%7D-m_%7B12%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7Bx%7D%2C%20%5C%5Cm_%7B02%7D%5E%7Bq%7D-m_%7B20%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7By%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.47%29%20%5C%5Cm_%7B10%7D%5E%7Bq%7D-m_%7B01%7D%5E%7Bq%7D%3D4q_%7Bw%7Dq_%7Bz%7D.">

<p>这些等式的含义是，如果 <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D"> 是已知的，则可以计算向量 <img alt="\textbf{v}_{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bv%7D_%7Bq%7D"> 的值，从而得出 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D">。的踪迹由下式计算</p>
<img alt="\\ tr(\textbf{M}^{q})=4-2s(q_{x}^{2}+q_{y}^{2}+q_{z}^{2})=4\left ( 1-\frac{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}}{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}+q_{w}^{2}} \right ) \;\;\;\;\;\;\;\;\;\;(4.48) \\ =\frac{4q_{w}^{2}}{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}+q_{w}^{2}}=\frac{4q_{w}^{2}}{n(\hat{\textbf{q}})^{2}}. \\" class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20tr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29%3D4-2s%28q_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%29%3D4%5Cleft%20%28%201-%5Cfrac%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D%7D%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D&amp;plus;q_%7Bw%7D%5E%7B2%7D%7D%20%5Cright%20%29%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.48%29%20%5C%5C%20%3D%5Cfrac%7B4q_%7Bw%7D%5E%7B2%7D%7D%7Bq_%7Bx%7D%5E%7B2%7D&amp;plus;q_%7By%7D%5E%7B2%7D&amp;plus;q_%7Bz%7D%5E%7B2%7D&amp;plus;q_%7Bw%7D%5E%7B2%7D%7D%3D%5Cfrac%7B4q_%7Bw%7D%5E%7B2%7D%7D%7Bn%28%5Chat%7B%5Ctextbf%7Bq%7D%7D%29%5E%7B2%7D%7D.%20%5C%5C">

<p>此结果将对单位四元数产生以下转换：</p>
<p><img alt="q_{w}=\frac{1}{2}\sqrt{tr(\textbf{M}^{q})}," class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D%3D%5Cfrac%7B1%7D%7B2%7D%5Csqrt%7Btr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29%7D%2C">      <img alt="q_{x}=\frac{m_{21}^{q}-m_{12}^{q}}{4q_{w}}," class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bx%7D%3D%5Cfrac%7Bm_%7B21%7D%5E%7Bq%7D-m_%7B12%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D%2C"></p>
<p><img alt="q_{y}=\frac{m_{02}^{q}-m_{20}^{q}}{4q_{w}}," class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7By%7D%3D%5Cfrac%7Bm_%7B02%7D%5E%7Bq%7D-m_%7B20%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D%2C">      <img alt="q_{z}=\frac{m_{10}^{q}-m_{01}^{q}}{4q_{w}}.\;\;\;\;\;\;\;\;\;\;(4.49)" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bz%7D%3D%5Cfrac%7Bm_%7B10%7D%5E%7Bq%7D-m_%7B01%7D%5E%7Bq%7D%7D%7B4q_%7Bw%7D%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.49%29"></p>
<p>为了具有数值稳定的例程 **[1634]**，应该避免小数除法。因此，首先设置  <img alt="t=q_{w}^{2}-q_{x}^{2}-q_{y}^{2}-q_{z}^{2}" class="mathcode" src="https://private.codecogs.com/gif.latex?t%3Dq_%7Bw%7D%5E%7B2%7D-q_%7Bx%7D%5E%7B2%7D-q_%7By%7D%5E%7B2%7D-q_%7Bz%7D%5E%7B2%7D">，由此得出</p>
<img alt="\\m_{00}=t+2q_{x}^{2}, \\m_{11}=t+2q_{y}^{2}, \\m_{22}=t+2q_{z}^{2},\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.50) \\u=m_{00}+m_{11}+m_{22}=t+2q_{w}^{2}," class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5Cm_%7B00%7D%3Dt&amp;plus;2q_%7Bx%7D%5E%7B2%7D%2C%20%5C%5Cm_%7B11%7D%3Dt&amp;plus;2q_%7By%7D%5E%7B2%7D%2C%20%5C%5Cm_%7B22%7D%3Dt&amp;plus;2q_%7Bz%7D%5E%7B2%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.50%29%20%5C%5Cu%3Dm_%7B00%7D&amp;plus;m_%7B11%7D&amp;plus;m_%7B22%7D%3Dt&amp;plus;2q_%7Bw%7D%5E%7B2%7D%2C">

<p>这又意味着 <img alt="m_{00},\;m_{11},\;m_{22}" class="mathcode" src="https://private.codecogs.com/gif.latex?m_%7B00%7D%2C%5C%3Bm_%7B11%7D%2C%5C%3Bm_%7B22%7D"> 和 <img alt="u" class="mathcode" src="https://private.codecogs.com/gif.latex?u"> 中的最大值确定 <img alt="q_{x},\;q_{y},\;q_{z}," class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bx%7D%2C%5C%3Bq_%7By%7D%2C%5C%3Bq_%7Bz%7D%2C"> 和  <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D"> 中的哪个最大。如果 <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D"> 最大，则使用公式 4.49 得出四元数。否则，我们注意到以下情况成立：</p>
<img alt="\\4q_{x}^{2}=+m_{00}-m_{11}-m_{22}+m_{33}, \\4q_{y}^{2}=+m_{00}-m_{11}-m_{22}+m_{33}, \\4q_{z}^{2}=+m_{00}-m_{11}-m_{22}+m_{33},\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.51) \\4q_{w}^{2}=tr(\textbf{M}^{q})." class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C4q_%7Bx%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%20%5C%5C4q_%7By%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%20%5C%5C4q_%7Bz%7D%5E%7B2%7D%3D&amp;plus;m_%7B00%7D-m_%7B11%7D-m_%7B22%7D&amp;plus;m_%7B33%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.51%29%20%5C%5C4q_%7Bw%7D%5E%7B2%7D%3Dtr%28%5Ctextbf%7BM%7D%5E%7Bq%7D%29.">

<p>然后，使用上述方程式的适当公式来计算 <img alt="q_{x},\;q_{y}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bx%7D%2C%5C%3Bq_%7By%7D"> 和 <img alt="q_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bz%7D"> 的最大值，然后使用公式 4.47 计算 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 剩下的部分。Sch¨uler**[1588]**提出了一种无分支但使用四个平方根的变体。</p>
<p><strong>作者注：</strong></p>
<p><strong>(2)</strong> 当且仅当 <img alt="\hat{\textbf{q}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Bq%7D%7D"> 和 <img alt="\hat{\textbf{r}}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Chat%7B%5Ctextbf%7Br%7D%7D"> 不相反时。</p>
<p><strong>(3)</strong> Shoemake <strong>[1633]</strong> 给出了另一个推导。<br>当 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 和 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 指向几乎相同的方向时，以这种方式直接生成四元数（相对于叉积 <img alt="\textbf{s}\times \textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%5Ctimes%20%5Ctextbf%7Bt%7D"> 的归一化）避免了数值不稳定 **[1197]**。当 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 和 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 指向相反的方向时，这两种方法都会出现稳定性问题，因为它们会被零除。当检测到这种特殊情况时，可以使用任何垂直于 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 的旋转轴旋转到 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">。</p>
<p>有时我们需要从 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 到 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 旋转的矩阵表示。在对公式 4.46 进行一些代数和三角简化之后，旋转矩阵变为 <strong>[1233]</strong></p>
<p><strong><img alt="\textbf{R}(\textbf{s},\textbf{t})=\begin{pmatrix} e+hv_{x}^{2} &amp; hv_{x}v_{y}-v_{z} &amp; hv_{x}v_{z}+v_{y} &amp; 0 \\ hv_{x}v_{y}+v_{z} &amp; e+hv_{y}^{2} &amp; hv_{y}v_{z}-v_{x} &amp; 0 \\ hv_{x}v_{z}-v_{y} &amp; hv_{y}v_{z}+v_{x} &amp; e+hv_{z}^{2} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.57)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BR%7D%28%5Ctextbf%7Bs%7D%2C%5Ctextbf%7Bt%7D%29%3D%5Cbegin%7Bpmatrix%7D%20e&amp;plus;hv_%7Bx%7D%5E%7B2%7D%20%26%20hv_%7Bx%7Dv_%7By%7D-v_%7Bz%7D%20%26%20hv_%7Bx%7Dv_%7Bz%7D&amp;plus;v_%7By%7D%20%26%200%20%5C%5C%20hv_%7Bx%7Dv_%7By%7D&amp;plus;v_%7Bz%7D%20%26%20e&amp;plus;hv_%7By%7D%5E%7B2%7D%20%26%20hv_%7By%7Dv_%7Bz%7D-v_%7Bx%7D%20%26%200%20%5C%5C%20hv_%7Bx%7Dv_%7Bz%7D-v_%7By%7D%20%26%20hv_%7By%7Dv_%7Bz%7D&amp;plus;v_%7Bx%7D%20%26%20e&amp;plus;hv_%7Bz%7D%5E%7B2%7D%20%26%200%20%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.57%29"></strong></p>
<p>在此等式中，我们使用了以下中间计算（intermediate calculations）：</p>
<img alt="\\ \textbf{v}=\textbf{s}\times\textbf{t}, \\ e=\textrm{cos}(2\phi)=\textbf{s}\cdot\textbf{t},\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.58) \\ h=\frac{1-\textrm{cos}(2\phi)}{\textrm{sin}^{2}(2\phi)}=\frac{1-e}{\textbf{v}\cdot\textbf{v}}=\frac{1}{1+e}." class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20%5Ctextbf%7Bv%7D%3D%5Ctextbf%7Bs%7D%5Ctimes%5Ctextbf%7Bt%7D%2C%20%5C%5C%20e%3D%5Ctextrm%7Bcos%7D%282%5Cphi%29%3D%5Ctextbf%7Bs%7D%5Ccdot%5Ctextbf%7Bt%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.58%29%20%5C%5C%20h%3D%5Cfrac%7B1-%5Ctextrm%7Bcos%7D%282%5Cphi%29%7D%7B%5Ctextrm%7Bsin%7D%5E%7B2%7D%282%5Cphi%29%7D%3D%5Cfrac%7B1-e%7D%7B%5Ctextbf%7Bv%7D%5Ccdot%5Ctextbf%7Bv%7D%7D%3D%5Cfrac%7B1%7D%7B1&amp;plus;e%7D.">

<p>可以看出，由于简化，所有平方根和三角函数都消失了，因此这是创建矩阵的有效方法。请注意，公式 4.57 的结构类似于公式 4.30 的结构，并请注意，后一种形式是怎样做到不需要三角函数。</p>
<p>请注意，当 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 和 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D"> 平行或接近平行时必须小心，因为 <img alt="\left \| \textbf{s} \times \textbf{t} \right \|\approx 0" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%5C%7C%20%5Ctextbf%7Bs%7D%20%5Ctimes%20%5Ctextbf%7Bt%7D%20%5Cright%20%5C%7C%5Capprox%200">。如果 <img alt="\phi\approx 0" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi%5Capprox%200">，那么我们可以返回单位矩阵。但是，如果<img alt="2\phi \approx \pi" class="mathcode" src="https://private.codecogs.com/gif.latex?2%5Cphi%20%5Capprox%20%5Cpi">，那么我们可以绕任何轴旋转 <img alt="\pi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cpi"> 弧度。该轴可以作为 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 与不平行于 <img alt="\textbf{s}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D"> 的任何其他向量之间的叉积找到（第4.2.4节）。莫勒和休斯使用 Householder 矩阵以不同的方式处理这种特殊情况 **[1233]**。</p>
<h2 id="4-4-顶点混合-Vertex-Blending"><a href="#4-4-顶点混合-Vertex-Blending" class="headerlink" title="4.4 顶点混合 Vertex Blending"></a><strong>4.4 顶点混合 Vertex Blending</strong></h2><p>想象一下，数字角色的手臂使用前臂和上臂两部分进行动画处理，如图 4.11 左侧所示。该模型可以使用刚体变换进行动画处理（第 4.1.6 节）。但是，这两个部分之间的关节将不会像真正的肘部。这是因为使用了两个单独的对象，因此，关节由来自这两个单独的对象的重叠部分组成。显然，最好只使用一个对象。但是，静态模型零件无法解决使接头具有柔性的问题。</p>
<p>顶点混合（Vertex blending）是解决此问题的一种流行解决方案 **[1037，1903]**。该技术还有其他几个名称，例如线性混合蒙皮（linear-blend skinning），包络（enveloping）或骨架子空间变形（skeleton-subspace deformation）。虽然此处介绍的算法的确切来源尚不清楚，但定义骨骼并使蒙皮对变化做出反应是计算机动画中的一个古老概念 **[1100]**。在最简单的形式中，前臂和上臂像以前一样分别进行动画处理，但是在关节处，两个部分通过有弹性的“蒙皮”相连。因此，该弹性部件将具有一组由前臂矩阵转换的顶点和另一组由上臂矩阵转换的顶点。与每个三角形使用单个矩阵相反，这导致三角形的顶点可以通过不同的矩阵进行变换。见图 4.11。</p>
<img alt="" height="301" src="https://img-blog.csdnimg.cn/20200426153704121.png" width="740">

<p><strong>图4.11。手臂由前臂和上臂组成，使用左侧的两个独立对象的刚体变换进行动画处理。肘部看起来不现实。在右侧，对一个对象使用顶点混合。最右边的手臂说明了当简单的蒙皮****将两个部分直接覆盖以覆盖肘部时发生的情况。最右边的手臂说明了使用顶点混合时发生的情况，并且某些顶点以不同的权重进行了混合：（2/3，1/3）表示顶点对上臂的变换的权重为2/3，对前臂的变换的权重为。1/3。该图在最右边的插图中还显示了顶点混合的缺点。在这里，可以看到肘部内部的折叠。使用更多的骨骼和更精心选择的权重可以达到更好的效果。</strong></p>
<p>通过进一步执行这一步骤，可以使单个顶点可以通过几种不同的矩阵进行变换，并将得到的位置加权并混合到一起。这是通过为动画对象设置骨骼来完成的，其中每个骨骼的变换可能会通过用户定义的权重影响每个顶点。由于整个手臂可能是“弹性的”，即所有顶点可能受到多个矩阵的影响，因此整个网格（mesh）通常称为（骨骼上的）蒙皮（skin）。见图 4.12。许多商业建模系统都具有相同的骨架骨骼建模功能。尽管名称如此，骨骼并不一定必须是刚性的。例如，Mohr 和 Gleicher **[1230]**提出了添加附加关节以实现诸如肌肉隆起等效果的想法。James 和 Twigg **[813]**讨论了使用可以挤压和拉伸的骨骼的动画蒙皮。</p>
<p>在数学上，这用公式 4.59 表示，其中 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 是原始顶点，而 <img alt="\textbf{u}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%28t%29"> 是变换后的顶点，其位置取决于时间 <img alt="\textbf{t}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D">：</p>
<img alt="\textbf{u}(t)=\sum^{n-1}_{i=0}w_{i}\textbf{B}_{i}(t)\textbf{M}_{i}^{-1}\textbf{p},\;\;\textrm{where}\;\;\sum ^{n-1}_{i=0}w_{i}=1,\;\;w_{i}\geq 0.\;\;\;\;\;\;\;\;(4.59)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D%28t%29%3D%5Csum%5E%7Bn-1%7D_%7Bi%3D0%7Dw_%7Bi%7D%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D%5Ctextbf%7Bp%7D%2C%5C%3B%5C%3B%5Ctextrm%7Bwhere%7D%5C%3B%5C%3B%5Csum%20%5E%7Bn-1%7D_%7Bi%3D0%7Dw_%7Bi%7D%3D1%2C%5C%3B%5C%3Bw_%7Bi%7D%5Cgeq%200.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.59%29">

<p>有 <img alt="n" class="mathcode" src="https://private.codecogs.com/gif.latex?n"> 个骨骼影响 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 的位置，这在世界坐标中表示出来。值 <img alt="w_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7Bi%7D"> 是顶点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 的骨骼 <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i"> 的权重。<img alt="\textbf{M}_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D"> 矩阵从初始骨骼的坐标系转换为世界坐标。通常，骨骼的控制关节位于其坐标系的原点。例如，前臂骨骼将其肘关节移动到原点，而动画旋转矩阵将手臂的这一部分绕关节移动。<img alt="\textbf{B}_{i}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29"> 矩阵是第 <img alt="i" class="mathcode" src="https://private.codecogs.com/gif.latex?i"> 个骨骼的世界变换，会随着时间变化以对对象进行动画处理，并且通常是多个矩阵的串联，例如以前的骨骼变换的层次结构和局部动画矩阵。</p>
<p>Woodland **[1903]**深入讨论了一种维护和更新 <img alt="\textbf{B}_{i}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29"> 矩阵动画函数的方法。每个骨骼都将一个顶点转换到相对于其自己的参照系的位置，并从一组计算点中插值最终位置。在一些蒙皮讨论中未明确显示矩阵 <img alt="\textbf{M}_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D">，而是将其视为 <img alt="\textbf{B}_{i}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29"> 的一部分。我们在这里介绍它是因为它是有用的矩阵，并且几乎总是矩阵级联过程的一部分。</p>
<p>在实践中，对于动画的每一帧，为每个骨骼连接矩阵 <img alt="\textbf{B}_{i}(t)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29"> 和 <img alt="\textbf{M}_{i}^{-1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D">，并且每个结果矩阵都用于变换顶点。顶点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 由不同骨骼的级联矩阵转换，然后使用权重 <img alt="w_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7Bi%7D"> 进行混合，因此称为顶点混合（vertex blending）。权重是非负的，并且总和为1，因此发生的事情是将顶点转换到几个位置，然后在其中进行插值。这样，对于所有的 <img alt="i=0\;...\;n-1" class="mathcode" src="https://private.codecogs.com/gif.latex?i%3D0%5C%3B...%5C%3Bn-1">，变换后的点 <img alt="\textbf{u}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bu%7D"> 将位于点集 <img alt="\textbf{B}_{i}(t)\textbf{M}_{i}^{-1}\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D%5Ctextbf%7Bp%7D"> （固定的 <img alt="t" class="mathcode" src="https://private.codecogs.com/gif.latex?t"> ）的凸包中。通常也可以使用公式 4.59 转换法线。根据所使用的变换（例如，如果骨骼被拉伸或压扁了很多），可能需要对<img alt="\textbf{B}_{i}(t)\textbf{M}_{i}^{-1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BB%7D_%7Bi%7D%28t%29%5Ctextbf%7BM%7D_%7Bi%7D%5E%7B-1%7D"> 的逆进行转置，如第 4.1.7 节中所述。</p>
<p>顶点混合非常适合在 GPU 上使用。网格中的顶点集可以放置在静态缓冲区中，该缓冲区会一次发送到 GPU 并重新使用。在每个框架中，只有骨骼矩阵会发生变化，而顶点着色器会计算它们对存储的网格的影响。这样，可以最大程度地减少在 CPU 上处理和从 CPU 传输的数据量，从而使 GPU 可以有效地渲染网格。如果可以将模型的整个骨矩阵一起使用，则是最简单的。否则，必须拆分模型并复制一些骨骼。或者，可以将骨骼变换存储在顶点访问的纹理中，从而避免达到寄存器存储限制。通过使用四元数表示旋转，每个变换可以仅存储在两个纹理中 **[1639]**。如果可用，无序访问视图存储将允许重新使用蒙皮结果 **[146]**。</p>
<p>我们可以指定超出 <img alt="[0,1]" class="mathcode" src="https://private.codecogs.com/gif.latex?%5B0%2C1%5D"> 范围或不等于 1 的权重集。但是，这仅在使用某些其他混合算法（例如变形目标，morph targets）（第4.5节）时才有意义。</p>
<p>基本顶点融合的一个缺点是可能发生不必要的折叠，扭曲和自相交 **[1037]**。见图 4.13。更好的解决方案是使用双季铵盐 **[872，873]**。这种执行蒙皮的技术有助于保持原始变换的刚度，因此避免了四肢的“糖果包裹”扭曲。计算量不到线性蒙皮混合的成本的 1.5 倍，并且效果很好，这导致该技术的快速采用。然而，双四元数蒙皮会导致鼓起效果，Le 和 Hodgins **[1001]**提出了旋转中心蒙皮作为更好的选择。他们基于这样的假设：局部变换应该是刚体，并且具有相似权重 <img alt="w_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7Bi%7D"> 的顶点应该具有相似的变换形式。预先为每个顶点计算旋转中心，同时施加正交（刚体）约束以防止肘关节塌陷和糖果包装纸扭曲伪像（candy wrapper twist artifacts）。在运行时，该算法类似于线性混合蒙皮，因为 GPU 在旋转中心执行线性混合蒙皮，随后执行四元数混合步骤。</p>
<img alt="" height="736" src="https://img-blog.csdnimg.cn/20200427112929931.png" width="745">

<blockquote>
<p>图4.13。左侧显示了使用线性混合蒙皮时关节处的问题。在右侧，使用双四元数混合可以改善外观。（图片由Ladislav Kavan等人提供，Paul Steed <strong>[1693]</strong> 提供模型。）</p>
</blockquote>
<h2 id="4-5-变形-Morphing"><a href="#4-5-变形-Morphing" class="headerlink" title="4.5 变形 Morphing"></a><strong>4.5 变形 Morphing</strong></h2><p>在执行动画时，从一个三维模型变形到另一个三维模型可能会很有用 **[28、883、1000、1005]**。想象一下，一个模型在时间 <img alt="t_{0}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B0%7D"> 显示，我们希望它在时间 <img alt="t_{1}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B1%7D"> 变成另一个模型。对于介于 <img alt="t_{0}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B0%7D"> 和 <img alt="t_{1}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B1%7D"> 之间的所有时间，都使用某种插值获得了连续的“混合”模型。变形的一个例子如图 4.14 所示。</p>
<p>变形（Morphing）涉及解决两个主要问题，即顶点对应问题（the vertex correspondence problem）和插值问题（the interpolation problem）。给定两个任意模型，这些模型可能具有不同的拓扑（topologies），不同的顶点数量和不同的网格连接性，通常必须从建立这些顶点对应关系开始。这是一个困难的问题，并且在该领域已经进行了很多研究。我们推荐感兴趣的读者阅读 Alexa 的调查 **[28]**。</p>
<p>但是，如果两个模型之间已经存在一对一的顶点对应关系，则可以在每个顶点的基础上进行插值。也就是说，对于第一个模型中的每个顶点，在第二个模型中必须仅存在一个顶点，反之亦然。这使插值变得容易。例如，线性插值可以直接在顶点上使用（其他进行插值的方法请参见第 17.1 节）。</p>
<img alt="" height="652" src="https://img-blog.csdnimg.cn/20200427114301861.png" width="734">

<blockquote>
<p>图4.14。顶点变形。为每个顶点定义了两个位置和法线。在每个帧中，中间位置和法线由顶点着色器线性插值。（图片由NVIDIA Corporation提供。）</p>
</blockquote>
<p>为了计算时间 <img alt="t\;\epsilon\; [t0,\;t1]" class="mathcode" src="https://private.codecogs.com/gif.latex?t%5C%3B%5Cepsilon%5C%3B%20%5Bt0%2C%5C%3Bt1%5D"> 的变形顶点，我们首先计算 <img alt="s=(t-t0)/(t_{1}-t_{0})" class="mathcode" src="https://private.codecogs.com/gif.latex?s%3D%28t-t0%29/%28t_%7B1%7D-t_%7B0%7D%29"> ，然后进行线性顶点混合，</p>
<img alt="\textbf{m}=(1-s)\textbf{p}_{0}+s\textbf{p}_{1},\;\;\;\;\;\;\;\;\;\;(4.60)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bm%7D%3D%281-s%29%5Ctextbf%7Bp%7D_%7B0%7D&amp;plus;s%5Ctextbf%7Bp%7D_%7B1%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.60%29">

<p>其中 <img alt="\textbf{p}_{0}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D_%7B0%7D"> 和 <img alt="\textbf{p}_{1}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D_%7B1%7D"> 对应于同一顶点，但是在不同的时间，<img alt="t_{0}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B0%7D">  和 <img alt="t_{1}" class="mathcode" src="https://private.codecogs.com/gif.latex?t_%7B1%7D">。</p>
<p>用户具有更直观控制的变形变体称为变形目标（morph targets）或混合形状（blend shapes） **[907]**。基本思想可以使用图 4.15 进行解释。</p>
<img alt="" height="316" src="https://img-blog.csdnimg.cn/20200427115842438.png" width="745">

<p><strong>图4.15。在给定两个嘴部姿势的情况下，将计算一组差异向量以控制插值甚至外推。在变形目标中，差异向量用于将运动“添加”到中性面上。对于差异向量使用正权重，会露出笑容，而负权重会产生相反的效果。</strong></p>
<p>我们从一个中性模型开始，在这种情况下，它是一张脸。让我们用 <img alt="N" class="mathcode" src="https://private.codecogs.com/gif.latex?N"> 表示该模型。此外，我们还有一组不同的脸部姿势。在示例中只有一个姿势，即一张笑脸。通常我们可以允许 <img alt="k\geqslant 1" class="mathcode" src="https://private.codecogs.com/gif.latex?k%5Cgeqslant%201"> 个不同的姿势，表示为 <img alt="P_{i},\;i\;\epsilon\; [1,\;...\;,\;k]" class="mathcode" src="https://private.codecogs.com/gif.latex?P_%7Bi%7D%2C%5C%3Bi%5C%3B%5Cepsilon%5C%3B%20%5B1%2C%5C%3B...%5C%3B%2C%5C%3Bk%5D">。作为预处理，“差异面”的计算公式为：<img alt="D_{i}=P_{i}-N" class="mathcode" src="https://private.codecogs.com/gif.latex?D_%7Bi%7D%3DP_%7Bi%7D-N">，即，从每个姿势中减去中性模型。</p>
<p>在这一点上，我们有一个中性模型 <img alt="N" src="https://private.codecogs.com/gif.latex?N"> 和一组差异姿势 <img alt="D_{i}" src="https://private.codecogs.com/gif.latex?D_%7Bi%7D">。然后可以使用以下公式获得变形模型 M：<img alt="M=N+\sum ^{k}_{i=1}w_{i}D_{i}.\;\;\;\;\;\;\;\;\;\;(4.61)" class="mathcode" src="https://private.codecogs.com/gif.latex?M%3DN&amp;plus;%5Csum%20%5E%7Bk%7D_%7Bi%3D1%7Dw_%7Bi%7DD_%7Bi%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.61%29"></p>
<p>这是中性模型，最重要的是，我们使用权重 <img alt="w_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7Bi%7D"> 添加所需的不同姿势的特征。对于图 4.15，设置 <img alt="w_{1}=1" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7B1%7D%3D1"> 可使我们恰好位于插图中间。使用 <img alt="w_{1}=0.5" class="mathcode" src="https://private.codecogs.com/gif.latex?w_%7B1%7D%3D0.5"> 给我们一个半张微笑的脸，依此类推。你可以使用负权重，也可以使用大于 1 的权重。</p>
<p>对于这个简单的脸部模型，我们可以添加另一只眉毛“悲伤”的脸。负重的眉毛会产生“快乐”的眉毛。由于位移是累加的，因此该眉毛姿势可与笑脸姿势一起使用。</p>
<p>变形目标（Morph targets）是一种强大的技术，可为动画师提供很多控制，因为模型的不同特征可以独立于其他特征进行操纵。Lewis 等。**[1037]** 引入了姿势空间变形，它结合了顶点融合和顶点变形目标。Senior <strong>[1608]</strong> 使用预先计算的顶点纹理来存储和检索目标姿势之间的位移。支持流输出的硬件和每个顶点的 ID 允许在单个模型中使用更多目标，并且可以在GPU上专门计算效果 <strong>[841，1074]</strong> 。使用低分辨率网格，然后通过细分阶段和位移映射生成高分辨率网格，可以避免在高度详细的模型中为每个顶点蒙皮的成本 **[1971]**。</p>
<img alt="" height="827" src="https://img-blog.csdnimg.cn/20200427142245311.png" width="737">

<p><strong>图 4.16。角色 Delsin 在《声名狼藉:私生子(inFAMOUS:Second Son)》****中的脸部使用混合形状进行了动画处理。所有这些拍摄都使用相同的静止姿势面孔，然后修改不同的权重以使面孔看起来有所不同。（图像由 Naughty Dog LLC 提供。inFAMOUS Second son c 2014 Sony Interactive EntertainmentLLC。inFAMOUS Second Son 是 Sony Interactive Entertainment LLC 的商标。由 Sucker Punch Productions LLC开发。）</strong></p>
<p>图 4.16 显示了同时使用蒙皮和变形的真实示例。Weronko 和 Andreason **[1872]**在《 教团 : 1886 (The Order : 1886)》中使用了蒙皮和变形。</p>
<h2 id="4-6-几何缓存回放-Geometry-Cache-Playback"><a href="#4-6-几何缓存回放-Geometry-Cache-Playback" class="headerlink" title="4.6 几何缓存回放 Geometry Cache Playback"></a><strong>4.6 几何缓存回放 Geometry Cache Playback</strong></h2><p>在剪辑场景（cut scenes）中，可能希望使用极高质量的动画，例如，对于无法使用上述任何方法表示的运动。天真的方法是存储所有帧的所有顶点，从磁盘读取它们并更新网格。但是，对于短动画中使用的 30,000 个顶点的简单模型，这可能达到50 MB / s。Gneiting  <strong>[545]</strong> 提出了几种将内存成本降低到大约10％的方法。</p>
<p>首先，使用量化（quantization）。例如，位置和纹理坐标使用每个坐标的 16 位整数存储。在执行压缩后无法恢复原始数据的意义上，这一步骤是有损的。为了进一步减少数据，进行了空间和时间预测，并对差异进行了编码。对于空间压缩，可以使用平行四边形预测 **[800]**。对于三角形带（triangle strip），下一个顶点的预测位置就是当前三角形在边缘周围的三角形平面中反射的三角形，从而形成平行四边形（parallelogram）。与新位置的差异接下来会被编码（encoded）。有了良好的预测，大多数值将接近零，这对于许多常用的压缩方案是十分理想的。与 MPEG 压缩类似，在时间维度上也会进行预测。也就是说，每 <img alt="n" class="mathcode" src="https://private.codecogs.com/gif.latex?n"> 帧执行一次空间压缩。在这两者之间，将在时间维度上进行预测，例如，如果某个特定顶点通过增量向量从帧 <img alt="n-1" class="mathcode" src="https://private.codecogs.com/gif.latex?n-1"> 移动到帧 <img alt="n" class="mathcode" src="https://private.codecogs.com/gif.latex?n">，则很可能以与帧 <img alt="n+1" class="mathcode" src="https://private.codecogs.com/gif.latex?n&amp;plus;1"> 相似的量移动。这些技术减少了存储量，从而足以使该系统用于实时流数据。</p>
<h2 id="4-7-投影-Projections"><a href="#4-7-投影-Projections" class="headerlink" title="4.7 投影 Projections"></a><strong>4.7 投影 Projections</strong></h2><p>在实际渲染场景之前，必须将场景中的所有相关对象投影到某种平面或某种简单体积上。此后，执行裁剪和渲染（第 2.3 节）。</p>
<p>到目前为止，在本章中看到的变换不影响第四个坐标 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 分量。也就是说，点和向量在转换后保留了其类型。另外，在 <img alt="4\times 4" class="mathcode" src="https://private.codecogs.com/gif.latex?4%5Ctimes%204"> 矩阵中，最底行始终为 <img alt="(0\;0\;0\;1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%280%5C%3B0%5C%3B0%5C%3B1%29">。透视投影矩阵（Perspective projection matrices）是这两个属性的例外：下一行包含矢量和点操作数，并且经常需要齐次化（homogenization）过程。也就是说，<img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 通常不为 1，因此需要除以 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 才能获得非齐次点。在本节中首先讨论的正交投影（Orthographic projection）是一种更简单的投影类型，也很常用。它不会影响 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 分量。</p>
<p>在本部分中，我们假设观看者沿着相机的负 z 轴看，y 轴指向上方，x 轴指向右侧。换言之，这是一个右手坐标系。在某些文章和软件里（例如 DirectX）使用的是左手坐标系，在这些系统中，观看者沿着相机的正 z 轴看。这两种系统都是同等有效的，最后达到的效果是相同的。</p>
<img alt="" height="370" src="https://img-blog.csdnimg.cn/2020042716413861.png" width="736">

<p><strong>图4.17。由公式 4.62 生成的简单正投影的三种不同视图。当观看者沿着负 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴看时，可以看到此投影，这意味着该投影仅跳过（或设置为零）<img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 坐标，同时保持 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 和 <img alt="y" class="mathcode" src="https://private.codecogs.com/gif.latex?y"> 坐标。请注意，<img alt="z=0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D0"> 两侧的对象都投影到投影平面上。</strong></p>
<h3 id="4-7-1-正交投影-Orthographic-Projection"><a href="#4-7-1-正交投影-Orthographic-Projection" class="headerlink" title="4.7.1 正交投影 Orthographic Projection"></a>4.7.1 正交投影 Orthographic Projection</h3><p>正交投影的特征是平行线在投影之后保持平行。当使用正交投影观看场景时，无论与相机的距离如何，对象都保持相同的大小。矩阵 <img alt="\textbf{P}_{o}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D">，如下所示，是一个简单的正投影投影矩阵，它使一个点的 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 和 <img alt="y" class="mathcode" src="https://private.codecogs.com/gif.latex?y"> 分量保持不变，而将 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 分量设置为零，即正投影在平面 <img alt="z=0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D0">上：</p>
<img alt="\textbf{P}_{o}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.62)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.62%29">

<p>这种投影的效果如图 4.17 所示。显然，<img alt="\textbf{P}_{o}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D"> 是不可逆的，因为它的行列式 <img alt="\left | \textbf{P}_{o} \right |=0" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cleft%20%7C%20%5Ctextbf%7BP%7D_%7Bo%7D%20%5Cright%20%7C%3D0">。换句话说，变换从三维下降到二维，并且无法检索下降的维数。使用这种正交投影进行查看时存在的问题是，它将正 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 点和负 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 值的点都投影到投影平面上。通常将 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 值（以及 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 和 <img alt="y" class="mathcode" src="https://private.codecogs.com/gif.latex?y"> 值）限制为一定的间隔是很有用的，例如从 <img alt="n" class="mathcode" src="https://private.codecogs.com/gif.latex?n">（近平面）到 <img alt="f" class="mathcode" src="https://private.codecogs.com/gif.latex?f">（远平面）。**(4)** 这是下一个变换的目的。</p>
<p>用于执行正交投影的更常见矩阵由六元组 <img alt="(l,r,b,t,n,f)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28l%2Cr%2Cb%2Ct%2Cn%2Cf%29"> 表示，分别表示左侧（left），右侧（right），底部（bottom），顶部（top），近侧（near）和远侧（far）平面。该矩阵缩放并将由这些平面形成的与轴对齐的边界框（axis-aligned bounding box）（缩写为 AABB；请参见第22.2节中的定义）转换为以原点为中心的与轴对齐的立方体。AABB 的最小角为 <img alt="(l,b,n)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28l%2Cb%2Cn%29">，最大角为 是 <img alt="(r,t,f)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28r%2Ct%2Cf%29">。重要的是要意识到 <img alt="n&gt;f" class="mathcode" src="https://private.codecogs.com/gif.latex?n%3Ef">，因为我们正在向下看 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴的负空间。我们的常识是，接近值应该比远端值低，因此，可以让用户按原样提供它们，然后在内部对它们取反（negate）。</p>
<p>在 OpenGL 中，与轴对齐的立方体的最小角为 <img alt="(-1,-1,-1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C-1%29">，最大角为 <img alt="(1,1,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%281%2C1%2C1%29">。在 DirectX 中，范围是 <img alt="(-1,-1,0)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C0%29"> 到 <img alt="(1,1,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%281%2C1%2C1%29">。此立方体称为规范视图体（canonical view volume），而该体积中的坐标称为规范化设备坐标（normalized device coordinates）。变换过程如图 4.18 所示。变换为标准视图体积的原因是在此处能够更有效地执行裁剪（clipping）。</p>
<img alt="" height="285" src="https://img-blog.csdnimg.cn/20200427172341528.png" width="741">

<p><strong>图4.18。变换规范视图体（canonical view volume）上的轴对齐框（axis-aligned box）。首先平移左侧的框，使其中心与原点重合。然后将其缩放以获取规范视图体的大小，如右侧所示。</strong></p>
<p>变换为标准视图体（canonical view volume）后，将要渲染的几何图形的顶点裁剪（clipped）到该立方体上。最后，通过将剩余的单位正方形映射到屏幕来渲染不在立方体之外的几何图形。此正交变换如下所示：</p>
<img alt="\large \\ \textbf{P}_{o}=\textbf{S}(\textbf{s})\textbf{T}(\textbf{t})=\begin{pmatrix} \frac{2}{r-l} &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; \frac{2}{t-b} &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; \frac{2}{f-n} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix} \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; -\frac{l+r}{2}\\ 0 &amp; 1 &amp; 0 &amp; -\frac{t+b}{2}\\ 0 &amp; 0 &amp; 1 &amp; -\frac{f+n}{2}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}\;\;\;\;\;\;\;\;\;\;(4.63) \\ =\begin{pmatrix} \frac{2}{r-l} &amp; 0 &amp; 0 &amp; -\frac{r+l}{r-l}\\ 0 &amp; \frac{2}{t-b} &amp; 0 &amp; -\frac{t+b}{t-b}\\ 0 &amp; 0 &amp; \frac{2}{f-n} &amp; -\frac{f+n}{f-n}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}." class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5C%5C%20%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B2%7D%7Bf-n%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%20-%5Cfrac%7Bl&amp;plus;r%7D%7B2%7D%5C%5C%200%20%26%201%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7B2%7D%5C%5C%200%20%26%200%20%26%201%20%26%20-%5Cfrac%7Bf&amp;plus;n%7D%7B2%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.63%29%20%5C%5C%20%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B2%7D%7Bf-n%7D%20%26%20-%5Cfrac%7Bf&amp;plus;n%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.">

<p>如该公式所示，<img alt="\textbf{P}_{o}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D"> 可以写为平移的串联 <img alt="\textbf{T}(\textbf{t})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%28%5Ctextbf%7Bt%7D%29">，后面是缩放矩阵 <img alt="\textbf{S}(\textbf{s})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%28%5Ctextbf%7Bs%7D%29">，其中 <img alt="\textbf{s}=(2/(r-l),2/(t-b),2/(f-n))" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bs%7D%3D%282/%28r-l%29%2C2/%28t-b%29%2C2/%28f-n%29%29"> 和 <img alt="\textbf{t}=(-(r+l)/2,-(t+b)/2,-(f+n)/2)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bt%7D%3D%28-%28r&amp;plus;l%29/2%2C-%28t&amp;plus;b%29/2%2C-%28f&amp;plus;n%29/2%29"> 。该矩阵是可逆的，**(5)**，即 <img alt="\textbf{P}_{o}^{-1}=\textbf{T}(-\textbf{t})\textbf{S}((r-l)/2,(t-b)/2,(f-n)/2)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%5E%7B-1%7D%3D%5Ctextbf%7BT%7D%28-%5Ctextbf%7Bt%7D%29%5Ctextbf%7BS%7D%28%28r-l%29/2%2C%28t-b%29/2%2C%28f-n%29/2%29">。</p>
<p>在计算机图形学中，投影后最常使用左手坐标系（left-hand coordinate system），即对于视口，<img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 轴向右，<img alt="y" class="mathcode" src="https://private.codecogs.com/gif.latex?y"> 轴向上，而 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴进入视口。因为按照我们定义 AABB 的方式，远值（far）小于近值（near），所以正交变换（orthographic transform）将始终包含镜像变换（mirroring transform）。要看到这一点，可以说原始的AABB尺寸与目标尺寸相同，即规范的视图体积。然后，AABB 的坐标是 <img alt="(l,\;b,\;n)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28l%2C%5C%3Bb%2C%5C%3Bn%29"> 的  <img alt="(-1,-1,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28-1%2C-1%2C1%29"> 和  <img alt="(r,\;t,\;f)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28r%2C%5C%3Bt%2C%5C%3Bf%29"> 的  <img alt="(1,\;1,\;-1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%281%2C%5C%3B1%2C%5C%3B-1%29">。将其应用于公式 4.63 可得出</p>
<img alt="\textbf{P}_{o}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; -1 &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}, \;\;\;\;\;\;\;\;\;\;(4.64)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20-1%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D%2C%20%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.64%29">

<p>这是一个镜像矩阵（mirroring matrix）。正是这种镜像将右手观察坐标系（从负 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴向下看）转换为左手标准化设备坐标。</p>
<p>DirectX 将 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 深度（<img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">-depth）映射到 <img alt="[0,1]" class="mathcode" src="https://private.codecogs.com/gif.latex?%5B0%2C1%5D"> 范围，而不是OpenGL的 <img alt="[-1,1]" class="mathcode" src="https://private.codecogs.com/gif.latex?%5B-1%2C1%5D">。这可以通过在正交矩阵之后应用简单的缩放和平移矩阵来实现，即</p>
<img alt="\textbf{M}_{s t}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 0.5 &amp; 0.5\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.65)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BM%7D_%7Bs%20t%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%200.5%20%26%200.5%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.65%29">

<p>因此，DirectX中使用的正交矩阵为</p>
<img alt="\textbf{P}_{o[0,1]}=\begin{pmatrix} \frac{2}{r-l} &amp; 0 &amp; 0 &amp; -\frac{r+l}{r-l}\\ 0 &amp; \frac{2}{t-b} &amp; 0 &amp; -\frac{t+b}{t-b}\\ 0 &amp; 0 &amp; \frac{1}{f-n} &amp; -\frac{n}{f-n}\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(4.66)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bo%5B0%2C1%5D%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2%7D%7Br-l%7D%20%26%200%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%5C%5C%200%20%26%20%5Cfrac%7B2%7D%7Bt-b%7D%20%26%200%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%5C%5C%200%20%26%200%20%26%20%5Cfrac%7B1%7D%7Bf-n%7D%20%26%20-%5Cfrac%7Bn%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.66%29">

<p>由于 DirectX 使用行优先格式编写矩阵，因此通常以转置形式呈现。</p>
<p><strong>作者注：</strong></p>
<p><strong>(4)</strong> 近平面也称为正平面（front plane）或 hither。远平面也称为背平面（back plane）或 yon。</p>
<p><strong>(5)</strong> 当且仅当 <img alt="n \neq f,\;l \neq r" class="mathcode" src="https://private.codecogs.com/gif.latex?n%20%5Cneq%20f%2C%5C%3Bl%20%5Cneq%20r"> 和 <img alt="t \neq b" class="mathcode" src="https://private.codecogs.com/gif.latex?t%20%5Cneq%20b"> 时； 否则，不存在逆（inverse）。</p>
<h3 id="4-7-2-透视投影-Perspective-Projection"><a href="#4-7-2-透视投影-Perspective-Projection" class="headerlink" title="4.7.2 透视投影 Perspective Projection"></a>4.7.2 透视投影 Perspective Projection</h3><p>透视投影比正交投影更复杂的变换是透视投影，它通常在大多数计算机图形应用程序中使用。在这里，平行线在投影后通常不平行； 相反，它们可能会在极端情况下收敛到单个点。透视更紧密地匹配我们如何感知世界，即，更远的物体更小。</p>
<p>首先，我们将对投影到平面 <img alt="z=-d,\;d&gt;0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">上的透视投影矩阵进行推导。我们从世界空间中推导，以简化对世界视图转换的理解。此推导之后是例如 OpenGL <strong>[885]</strong> 中使用的更常规的矩阵。</p>
<img alt="" height="326" src="https://img-blog.csdnimg.cn/20200427181810472.png" width="739">

<p><strong>图4.19。用于导出透视投影矩阵（perspective projection matrix）的符号。将点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">投影到平面 <img alt="z=-d,\;d&gt;0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">上，得出投影点 <img alt="\textbf{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D">。投影是从摄影机位置的角度进行的，在本例中为原点。右侧的 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 分量显示了推导中使用的相似三角形。</strong></p>
<p>假设摄像机（视点）位于原点，并且我们要将一个点 <img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D"> 投影到平面 <img alt="z=-d,\;d&gt;0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D-d%2C%5C%3Bd%3E0">，从而产生一个新点 <img alt="q=(q_{x},q_{y},-d)" class="mathcode" src="https://private.codecogs.com/gif.latex?q%3D%28q_%7Bx%7D%2Cq_%7By%7D%2C-d%29"> 。图4.19 描绘了这种情况。从该图所示的相似三角形中，得出 <img alt="\textbf{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D"> 的 <img alt="x" class="mathcode" src="https://private.codecogs.com/gif.latex?x"> 分量的以下推导：</p>
<img alt="\frac{q_{x}}{p_{x}}=\frac{-d}{p_{z}}\;\;\Leftrightarrow \;\;q_{x}=-d\frac{p_{x}}{p_{z}}.\;\;\;\;\;\;\;\;\;\;(4.67)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cfrac%7Bq_%7Bx%7D%7D%7Bp_%7Bx%7D%7D%3D%5Cfrac%7B-d%7D%7Bp_%7Bz%7D%7D%5C%3B%5C%3B%5CLeftrightarrow%20%5C%3B%5C%3Bq_%7Bx%7D%3D-d%5Cfrac%7Bp_%7Bx%7D%7D%7Bp_%7Bz%7D%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.67%29">

<p><img alt="\textbf{q}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D"> 的其他分量的表达式为 <img alt="q_{y}=-dp_{y}/p_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7By%7D%3D-dp_%7By%7D/p_%7Bz%7D">（类似于 <img alt="q_{x}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bx%7D"> 获得），<img alt="q_{z}=-d" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bz%7D%3D-d">。与上面的公式一起，它们给出了透视投影矩阵 <img alt="\textbf{P}_{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">，如下所示：</p>
<img alt="\textbf{P}_{p}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; -1/d &amp; 0 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.68)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%20-1/d%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.68%29">

<p>该矩阵可产生正确的透视投影，可通过以下方式确认</p>
<img alt="\textbf{q}=\textbf{P}_{p}\textbf{p}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; -1/d &amp; 0 \end{pmatrix} \begin{pmatrix} p_{x}\\ p_{y}\\ p_{z}\\ 1 \end{pmatrix} = \begin{pmatrix} p_{x}\\ p_{y}\\ p_{z}\\ -p_{z}/d \end{pmatrix} \Rightarrow \begin{pmatrix} -dp_{x}/p_{z}\\ -dp_{y}/p_{z}\\ -d\\ 1 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.69)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D%3D%5Ctextbf%7BP%7D_%7Bp%7D%5Ctextbf%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%201%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%20-1/d%20%26%200%20%5Cend%7Bpmatrix%7D%20%5Cbegin%7Bpmatrix%7D%20p_%7Bx%7D%5C%5C%20p_%7By%7D%5C%5C%20p_%7Bz%7D%5C%5C%201%20%5Cend%7Bpmatrix%7D%20%3D%20%5Cbegin%7Bpmatrix%7D%20p_%7Bx%7D%5C%5C%20p_%7By%7D%5C%5C%20p_%7Bz%7D%5C%5C%20-p_%7Bz%7D/d%20%5Cend%7Bpmatrix%7D%20%5CRightarrow%20%5Cbegin%7Bpmatrix%7D%20-dp_%7Bx%7D/p_%7Bz%7D%5C%5C%20-dp_%7By%7D/p_%7Bz%7D%5C%5C%20-d%5C%5C%201%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.69%29">

<p>最后一步来自以下事实：整个矢量除以 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 分量（在这种情况下为 <img alt="-p_{z}/d" class="mathcode" src="https://private.codecogs.com/gif.latex?-p_%7Bz%7D/d">），最后得到 1。由于我们要投影到该平面上，因此所得的  <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 值始终为 <img alt="-d" class="mathcode" src="https://private.codecogs.com/gif.latex?-d">。</p>
<p>从直觉上讲，很容易理解为什么齐次坐标允许投影。齐次化过程的一种几何解释是将点 <img alt="(p_{x},\;p_{y},\;p_{z})" class="mathcode" src="https://private.codecogs.com/gif.latex?%28p_%7Bx%7D%2C%5C%3Bp_%7By%7D%2C%5C%3Bp_%7Bz%7D%29"> 投影到平面 <img alt="w=1" class="mathcode" src="https://private.codecogs.com/gif.latex?w%3D1"> 上。</p>
<p>与正交变换（orthographic transformation）一样，还有一个透视变换（perspective transform），而不是实际投影到平面（不可逆）上，而是将视锥从视锥变换为前述的规范视像体。在这里，视锥视点假定从 <img alt="z=n" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3Dn"> 开始并在 <img alt="z=f" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3Df"> 结束，且 <img alt="0&gt;n&gt;f" class="mathcode" src="https://private.codecogs.com/gif.latex?0%3En%3Ef"> 。<img alt="z=n" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3Dn"> 处的矩形的最小角为 <img alt="(l,\;b,\;n)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28l%2C%5C%3Bb%2C%5C%3Bn%29">，最大角为 <img alt="(r,\;t,\;n)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28r%2C%5C%3Bt%2C%5C%3Bn%29">。如图 4.20 所示。</p>
<img alt="" height="273" src="https://img-blog.csdnimg.cn/20200427183222166.png" width="735">

<p><strong>图4.20。矩阵 <img alt="\textbf{P}_{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D"> 将视锥体（view frustum）转换为单位立方体，称为标准视域（canonical view volume）。</strong></p>
<p>参数 <img alt="(l,r,b,t,n,f)" class="mathcode" src="https://private.codecogs.com/gif.latex?%28l%2Cr%2Cb%2Ct%2Cn%2Cf%29"> 确定摄像机的视锥（view frustum）。水平视野由视锥的左右平面（由 <img alt="l" class="mathcode" src="https://private.codecogs.com/gif.latex?l"> 和 <img alt="r" class="mathcode" src="https://private.codecogs.com/gif.latex?r"> 决定）之间的角度确定。以相同的方式，垂直视野由顶平面和底平面之间的角度（由 <img alt="t" class="mathcode" src="https://private.codecogs.com/gif.latex?t"> 和 <img alt="b" class="mathcode" src="https://private.codecogs.com/gif.latex?b"> 确定）确定。视野越大，相机“看得越多”。可以通过 <img alt="r\neq -l" class="mathcode" src="https://private.codecogs.com/gif.latex?r%5Cneq%20-l"> 或 <img alt="t\neq -b" class="mathcode" src="https://private.codecogs.com/gif.latex?t%5Cneq%20-b"> 来创建不对称视锥（Asymmetric frusta）。不对称视锥可用于立体观看（stereo viewing）和虚拟现实（virtual reality）（第 21.2.3 节）。</p>
<p>视野（the field of view）是提供场景感的重要因素。与计算机屏幕相比，眼睛本身具有物理视野。这种关系是</p>
<img alt="\phi=2\textrm{arctan}(w/(2d)),\;\;\;\;\;\;\;\;\;\;(4.70)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi%3D2%5Ctextrm%7Barctan%7D%28w/%282d%29%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.70%29">

<p>其中 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi"> 是视野，<img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 是垂直于视线的物体的宽度，<img alt="d" class="mathcode" src="https://private.codecogs.com/gif.latex?d"> 是到物体的距离。例如，一个 25 英寸的显示器大约为 22 英寸宽。在 12 英寸远处，水平视野为 85 度； 在 20 英寸处为 58 度； 在 30 英寸，40 度 可以使用相同的公式将摄像机镜头的尺寸转换为视野，例如，对于 35mm 摄像机的标准 50mm 镜头（镜框尺寸为 36mm），<img alt="\phi=2\textrm{arctan}(36/(2.50))=39.6" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi%3D2%5Ctextrm%7Barctan%7D%2836/%282.50%29%29%3D39.6"> 度。</p>
<p>与物理设置相比，使用更窄的视野将减少透视效果，因为观看者将放大场景。设置较宽的视野将使对象看起来失真（例如使用广角相机镜头），尤其是在屏幕边缘附近，并且会放大附近对象的比例。然而，较宽的视野使观看者感觉到物体更大并且更令人印象深刻，并且具有向用户提供有关周围环境的更多信息的优点。</p>
<p>公式 4.71 给出了将视锥转化为单位立方体的透视变换矩阵：</p>
<img alt="\large \textbf{P}_{p}=\begin{pmatrix} \frac{2n}{r-l} &amp; 0 &amp; -\frac{r+l}{r-l} &amp; 0\\ 0 &amp; \frac{2n}{t-b} &amp; -\frac{t+b}{t-b} &amp; 0\\ 0 &amp; 0 &amp; \frac{f+n}{f-n} &amp; -\frac{2fn}{f-n}\\ 0 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.71)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7Bf&amp;plus;n%7D%7Bf-n%7D%20%26%20-%5Cfrac%7B2fn%7D%7Bf-n%7D%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.71%29">

<p>将转换应用到一个点后，我们将得到另一个点 <img alt="\textbf{q}=(q_{x},q_{y},q_{z},q_{w})^{T}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bq%7D%3D%28q_%7Bx%7D%2Cq_%7By%7D%2Cq_%7Bz%7D%2Cq_%7Bw%7D%29%5E%7BT%7D">。此时的 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 分量 <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D">（通常）将为非零且不等于1。要获得投影点<img alt="\textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D">，我们需要除以 <img alt="q_{w}" class="mathcode" src="https://private.codecogs.com/gif.latex?q_%7Bw%7D">，即</p>
<img alt="\textbf{p}=(q_{x}/q_{w},\;q_{y}/q_{w},\;q_{z}/q_{w},1).\;\;\;\;\;\;\;\;\;\;(4.72)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7Bp%7D%3D%28q_%7Bx%7D/q_%7Bw%7D%2C%5C%3Bq_%7By%7D/q_%7Bw%7D%2C%5C%3Bq_%7Bz%7D/q_%7Bw%7D%2C1%29.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.72%29">

<p>矩阵 <img alt="\textbf{P}_{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D"> 总是看到 <img alt="z=f" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3Df"> 映射为 <img alt="+1" class="mathcode" src="https://private.codecogs.com/gif.latex?&amp;plus;1">，<img alt="z=n" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3Dn"> 映射为 <img alt="-1" class="mathcode" src="https://private.codecogs.com/gif.latex?-1">。</p>
<p>远平面以外的对象将被裁切，因此不会出现在场景中。另外，透视投影可以令远平面取到无穷远，这使公式 4.71 变为</p>
<img alt="\large \textbf{P}_{p}=\begin{pmatrix} \frac{2n}{r-l} &amp; 0 &amp; -\frac{r+l}{r-l} &amp; 0\\ 0 &amp; \frac{2n}{t-b} &amp; -\frac{t+b}{t-b} &amp; 0\\ 0 &amp; 0 &amp; 1 &amp; -2n\\ 0 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.73)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%20-2n%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.73%29">

<p>综上所述，应用透视变换（以任何形式）<img alt="\textbf{P}_{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D_%7Bp%7D">，然后进行裁剪和齐次化（除以 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w">），从而得到标准化的设备坐标。</p>
<p>为了获得在 OpenGL 中使用的透视变换，出于与正交变换相同的原因，首先将其与 <img alt="\textbf{S}(1,1,-1,1)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BS%7D%281%2C1%2C-1%2C1%29"> 相乘。这仅会使公式 4.71 第三栏中的值取反。在应用此镜像变换之后，将近距和远距值输入为正值，且 <img alt="0&lt;n'&lt;f'" class="mathcode" src="https://private.codecogs.com/gif.latex?0%3Cn%27%3Cf%27">，如传统上将其呈现给用户一样。但是，它们仍然代表沿世界负 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴（即视线方向）的距离。出于参考目的，以下是 OpenGL 中的公式：</p>
<img alt="\large \textbf{P}_{OpenGL}=\begin{pmatrix} \frac{2n'}{r-l} &amp; 0 &amp; \frac{r+l}{r-l} &amp; 0\\ 0 &amp; \frac{2n'}{t-b} &amp; \frac{t+b}{t-b} &amp; 0\\ 0 &amp; 0 &amp; -\frac{f'+n'}{f'-n'} &amp; -\frac{2f'n'}{f'-n'}\\ 0 &amp; 0 &amp; -1 &amp; 0 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.74)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7BOpenGL%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%27%7D%7Br-l%7D%20%26%200%20%26%20%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%27%7D%7Bt-b%7D%20%26%20%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20-%5Cfrac%7Bf%27&amp;plus;n%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7B2f%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%20-1%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.74%29">

<p>一个更简单的设置是仅提供垂直视场 <img alt="\phi" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Cphi">，宽高比 <img alt="a=w/h" class="mathcode" src="https://private.codecogs.com/gif.latex?a%3Dw/h">（其中 <img alt="w\times h" class="mathcode" src="https://private.codecogs.com/gif.latex?w%5Ctimes%20h"> 是屏幕分辨率），<img alt="n'" class="mathcode" src="https://private.codecogs.com/gif.latex?n%27"> 和 <img alt="f'" class="mathcode" src="https://private.codecogs.com/gif.latex?f%27">。这导致了</p>
<img alt="\large \textbf{P}_{OpenGL}=\begin{pmatrix} c/a &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; c &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; -\frac{f'+n'}{f'-n'} &amp; -\frac{2f'n'}{f'-n'}\\ 0 &amp; 0 &amp; -1 &amp; 0 \end{pmatrix},\;\;\;\;\;\;\;\;\;\;(4.75)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7BOpenGL%7D%3D%5Cbegin%7Bpmatrix%7D%20c/a%20%26%200%20%26%200%20%26%200%5C%5C%200%20%26%20c%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%20-%5Cfrac%7Bf%27&amp;plus;n%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7B2f%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%20-1%20%26%200%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.75%29">

<p><img alt="" class="mathcode" src="https://private.codecogs.com/gif.latex?">其中 <img alt="c=1.0/\textrm{tan}(\phi/2)" class="mathcode" src="https://private.codecogs.com/gif.latex?c%3D1.0/%5Ctextrm%7Btan%7D%28%5Cphi/2%29"> 。该矩阵的作用与旧的 gluPerspective() 完全一样，后者是OpenGL Utility Library（GLU）的一部分。</p>
<p>某些API（例如 DirectX）将近平面映射到 <img alt="z=0" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D0">（而不是 <img alt="z=-1" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D-1">），而将远平面映射到 <img alt="z=1" class="mathcode" src="https://private.codecogs.com/gif.latex?z%3D1">。此外，DirectX 使用左手坐标系来定义其投影矩阵。这意味着 DirectX 沿 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴正方向看，并以正数表示近和远值。这是 DirectX 公式：</p>
<img alt="\large \textbf{P}_{p[0,1]}=\begin{pmatrix} \frac{2n'}{r-l} &amp; 0 &amp; -\frac{r+l}{r-l} &amp; 0\\ 0 &amp; \frac{2n'}{t-b} &amp; -\frac{t+b}{t-b} &amp; 0\\ 0 &amp; 0 &amp; \frac{f'}{f'-n'} &amp; -\frac{f'n'}{f'-n'}\\ 0 &amp; 0 &amp; 1 &amp; 0 \end{pmatrix}.\;\;\;\;\;\;\;\;\;\;(4.76)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7BP%7D_%7Bp%5B0%2C1%5D%7D%3D%5Cbegin%7Bpmatrix%7D%20%5Cfrac%7B2n%27%7D%7Br-l%7D%20%26%200%20%26%20-%5Cfrac%7Br&amp;plus;l%7D%7Br-l%7D%20%26%200%5C%5C%200%20%26%20%5Cfrac%7B2n%27%7D%7Bt-b%7D%20%26%20-%5Cfrac%7Bt&amp;plus;b%7D%7Bt-b%7D%20%26%200%5C%5C%200%20%26%200%20%26%20%5Cfrac%7Bf%27%7D%7Bf%27-n%27%7D%20%26%20-%5Cfrac%7Bf%27n%27%7D%7Bf%27-n%27%7D%5C%5C%200%20%26%200%20%26%201%20%26%200%20%5Cend%7Bpmatrix%7D.%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.76%29">

<p>DirectX 在其文档中使用行优先形式，因此此矩阵通常以转置形式发送。</p>
<p>使用透视变换的一种效果是，计算出的深度值不会随输入 <img alt="\large \textbf{p}_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bp%7D_%7Bz%7D"> 值线性变化。使用公式 4.74 – 4.76 中的任何一个乘以点 <img alt="\large \textbf{p}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bp%7D"> 我们可以看到</p>
<img alt="\large \textbf{v}=\textbf{P}_{\textbf{p}}=\begin{pmatrix} ...\\ ...\\ dp_{z}+e\\ \pm p_{z} \end{pmatrix},\;\;\;\;\;\;\;\;\;\;(4.77)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20%5Ctextbf%7Bv%7D%3D%5Ctextbf%7BP%7D_%7B%5Ctextbf%7Bp%7D%7D%3D%5Cbegin%7Bpmatrix%7D%20...%5C%5C%20...%5C%5C%20dp_%7Bz%7D&amp;plus;e%5C%5C%20%5Cpm%20p_%7Bz%7D%20%5Cend%7Bpmatrix%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.77%29">

<p>其中省略了 <img alt="\large v_{x}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20v_%7Bx%7D"> 和 <img alt="\large v_{y}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20v_%7By%7D"> 的详细信息，并且常数 <img alt="\large d" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20d"> 和 <img alt="\large f" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20f"> 取决于所选矩阵。例如，如果我们使用公式 4.74，则 <img alt="d=-(f'+n')/(f'-n')" class="mathcode" src="https://private.codecogs.com/gif.latex?d%3D-%28f%27&amp;plus;n%27%29/%28f%27-n%27%29">，<img alt="e=-2f'n'/(f'-n')" class="mathcode" src="https://private.codecogs.com/gif.latex?e%3D-2f%27n%27/%28f%27-n%27%29"> 和 <img alt="v_{x} = -p_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?v_%7Bx%7D%20%3D%20-p_%7Bz%7D"> 。为了获得归一化设备坐标（NDC）中的深度，我们需要除以 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 分量，结果是</p>
<img alt="\large z_{NDC}=\frac{dp_{z}+e}{-p_{z}}=d-\frac{e}{p_{z}},\;\;\;\;\;\;\;\;\;\;(4.78)" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D%3D%5Cfrac%7Bdp_%7Bz%7D&amp;plus;e%7D%7B-p_%7Bz%7D%7D%3Dd-%5Cfrac%7Be%7D%7Bp_%7Bz%7D%7D%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.78%29">

<p>其中 <img alt="\large z_{NDC}\;\epsilon \;[-1,+1]" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D%5C%3B%5Cepsilon%20%5C%3B%5B-1%2C&amp;plus;1%5D"> 用于 OpenGL 投影。可以看出，输出深度 <img alt="\large z_{NDC}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20z_%7BNDC%7D"> 与输入深度 <img alt="\large p_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Clarge%20p_%7Bz%7D"> 成反比。</p>
<p>例如，如果 <img alt="n'=10" class="mathcode" src="https://private.codecogs.com/gif.latex?n%27%3D10"> 且 <img alt="f'=110" class="mathcode" src="https://private.codecogs.com/gif.latex?f%27%3D110">（使用 OpenGL 术语），则当 <img alt="p_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?p_%7Bz%7D"> 在负 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 轴（即中点）下沿 60 个单位时，归一化设备坐标深度值为0.833，而不是 0。图 4.21 显示了改变近平面到原点的距离的影响。近平面和远平面的放置会影响 z 缓冲区的精度。第 23.7 节将进一步讨论这种效果。</p>
<img alt="" height="343" src="https://img-blog.csdnimg.cn/20200428180704512.png" width="739">

<p><strong>图4.21。改变近平面到原点的距离的影响。距离 <img alt="f'-n'" class="mathcode" src="https://private.codecogs.com/gif.latex?f%27-n%27">保持恒定为 100。随着近平面变得更靠近原点，更接近远平面的点将使用较小范围的归一化设备坐标（NDC）深度空间。这具有使 z 缓冲区在较大距离处的准确性降低的效果。</strong></p>
<p>有几种增加深度精度的方法。一种常见的方法（我们称为反向 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">， reversed <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">）是使用浮点深度或整数存储 1.0-<img alt="z_{NDC}" class="mathcode" src="https://private.codecogs.com/gif.latex?z_%7BNDC%7D"> **[978]**。比较如图 4.22 所示。Reed **[1472]**通过仿真显示，使用具有反向 z 的浮点缓冲区可提供最佳精度，这也是整数深度缓冲区（每个深度通常具有24位）的首选方法。对于标准映射（即非反向 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">），如 Upchurch 和 Des brun **[1803]**所建议的，在变换中分离投影矩阵可降低错误率。例如，在 <img alt="\textbf{T}=\textbf{PM}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BT%7D%3D%5Ctextbf%7BPM%7D"> 的情况下，使用 <img alt="\textbf{P}(\textbf{Mp})" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BP%7D%28%5Ctextbf%7BMp%7D%29"> 比使用 <img alt="\textbf{Tp}" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextbf%7BTp%7D">  更好。同样，在 [0.5，1.0] 范围内，fp32 和 int24 的精度非常相似，因为 fp32 具有 23 位的尾数。使 <img alt="z_{NDC}" class="mathcode" src="https://private.codecogs.com/gif.latex?z_%7BNDC%7D"> 与 <img alt="1/p_{z}" class="mathcode" src="https://private.codecogs.com/gif.latex?1/p_%7Bz%7D"> 成比例的原因是，它使硬件更简单，并且深度压缩更成功，这将在 23.7 节中详细讨论。</p>
<img alt="" height="346" src="https://img-blog.csdnimg.cn/20200428181423825.png" width="763">

<p><strong>图4.22。使用 DirectX 变换设置深度缓冲区的不同方法，即 <img alt="z_{NDC}\;\epsilon \;[0,+1]" class="mathcode" src="https://private.codecogs.com/gif.latex?z_%7BNDC%7D%5C%3B%5Cepsilon%20%5C%3B%5B0%2C&amp;plus;1%5D">。左上方：标准整数深度缓冲区，此处显示为4位精度（因此 y 轴上有 16 个标记）。右上角：远平面设置为 ∞，两个轴上的微小偏移表明这样做不会损失太多精度。左下：具有3个指数位和 3 个尾数位用于浮点深度。注意，分布在y轴上是非线性的，这使得在x轴上的分布更糟。右下角：反转的浮点深度，即 <img alt="1-z_{NDC}" class="mathcode" src="https://private.codecogs.com/gif.latex?1-z_%7BNDC%7D">，结果分布更好。（插图由内森·里德（Nathan Reed）提供。）</strong></p>
<p>Lloyd **[1063]<strong>提出使用深度值的对数来提高阴影贴图的精度。Lauritzen 等。</strong>[991]**使用前一帧的 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 缓冲区（<img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">-buffer）来确定最大近平面和最小远平面。对于屏幕空间深度，Kemen **[881]**建议对每个顶点使用以下重新映射：</p>
<img alt="\\ z=w(\textrm{log}_{2}(\textrm{max}(10^{-6},1+w))f_{c}-1),\;\;\;\;\;[\textrm{OpenGL}]\;\;\;\;\;\;\;\;\;\;(4.79) \\ z=w\textrm{log}_{2}(\textrm{max}(10^{-6},1+w))f_{c}/2,\;\;\;\;\;[\textrm{DirectX}]" class="mathcode" src="https://private.codecogs.com/gif.latex?%5C%5C%20z%3Dw%28%5Ctextrm%7Blog%7D_%7B2%7D%28%5Ctextrm%7Bmax%7D%2810%5E%7B-6%7D%2C1&amp;plus;w%29%29f_%7Bc%7D-1%29%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5B%5Ctextrm%7BOpenGL%7D%5D%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%284.79%29%20%5C%5C%20z%3Dw%5Ctextrm%7Blog%7D_%7B2%7D%28%5Ctextrm%7Bmax%7D%2810%5E%7B-6%7D%2C1&amp;plus;w%29%29f_%7Bc%7D/2%2C%5C%3B%5C%3B%5C%3B%5C%3B%5C%3B%5B%5Ctextrm%7BDirectX%7D%5D">

<p>其中w是投影矩阵之后的顶点的 <img alt="w" class="mathcode" src="https://private.codecogs.com/gif.latex?w"> 值，而 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z"> 是顶点着色器的输出 <img alt="z" class="mathcode" src="https://private.codecogs.com/gif.latex?z">。常数 <img alt="f_{c}" class="mathcode" src="https://private.codecogs.com/gif.latex?f_%7Bc%7D"> 为 <img alt="f_{c}=2/\textrm{log}_{2}(f+1)" class="mathcode" src="https://private.codecogs.com/gif.latex?f_%7Bc%7D%3D2/%5Ctextrm%7Blog%7D_%7B2%7D%28f&amp;plus;1%29">，其中 <img alt="f" class="mathcode" src="https://private.codecogs.com/gif.latex?f"> 为远平面。当仅在顶点着色器中应用此变换时，深度仍将由 GPU 在顶点的非线性变换深度之间在三角形上线性插值（公式 4.79）。由于对数是单调函数，因此只要分段线性插值与精确的非线性变换深度值之间的差异较小，遮挡剔除硬件和深度压缩技术仍将起作用。在大多数情况下，具有足够的几何细分的情况是正确的。但是，也可以对每个片段应用转换。这是通过输出每个顶点的值 <img alt="e=1+w" class="mathcode" src="https://private.codecogs.com/gif.latex?e%3D1&amp;plus;w"> 来完成的，然后由 GPU 在三角形上进行插值。然后，像素着色器将片段深度修改为 <img alt="\textrm{log}^{2}(e_{i})f_{c}/2" class="mathcode" src="https://private.codecogs.com/gif.latex?%5Ctextrm%7Blog%7D%5E%7B2%7D%28e_%7Bi%7D%29f_%7Bc%7D/2"> ，其中 <img alt="e_{i}" class="mathcode" src="https://private.codecogs.com/gif.latex?e_%7Bi%7D"> 是 <img alt="e" class="mathcode" src="https://private.codecogs.com/gif.latex?e"> 的内插值。当 GPU 中没有浮点深度并且使用深度较大的距离进行渲染时，此方法是不错的选择。</p>
<p>Cozzi **[1605]**建议使用多视锥（multiple frusta），这可以提高准确度以有效地达到任何期望的比率。视锥在深度方向上分为几个不重叠的较小的子视锥，它们的联合恰好是视锥。子视锥表以从后到前的顺序渲染。首先，清除颜色和深度缓冲区，并将所有要渲染的对象分类到它们重叠的每个子视锥中。对于每个子视锥，设置其投影矩阵，清除深度缓冲区，然后渲染与子视锥重叠的对象。</p>
<h2 id="进一步阅读和资源"><a href="#进一步阅读和资源" class="headerlink" title="进一步阅读和资源"></a><strong>进一步阅读和资源</strong></h2><p>沉浸式的线性代数网站 <strong>[1718]</strong> 提供了一本有关该主题基础知识的互动书籍，通过鼓励您操纵这些数字来帮助建立直觉。来自 realtimerendering.com 的其他交互式学习工具和变换代码库也已链接至此。</p>
<p>Farin和Hansford的《The Geometry Toolbox》 <strong>[461]</strong> 是一本可以毫不费力地增强人们对矩阵直觉的书籍。另一本有用的著作是Lengyel 的 《Mathematics for 3D Game Programming and Computer Graphics》 **[1025]**。若想从不同的角度来看，那么也有许多计算机图形学的著作，例如 Hearn 和 Baker **[689]**，Marschner 和 Shirley <strong>[1129]</strong> 和 Hughes 等人的著作 <strong>[785]</strong> 介绍了矩阵基础知识。Ochiai 等人的课程 <strong>[1310]</strong> 介绍了矩阵基础以及矩阵的指数和对数，以及用于计算机图形学的知识。Graphics Gems 系列 <strong>[72，540，695，902，1344]</strong> 提出了各种与变换相关的算法，并且在线提供了许多此类算法的代码。Golub 和 Van Loan 的 Matrix Computations <strong>[556]</strong> 通常是认真研究矩阵技术的起点。可以在 Lewis 等人的 SIGGRAPH 论文 <strong>[1037]</strong> 中阅读有关骨骼子空间（skeleton-subspace）变形/顶点混合（deformation/vertex blending） 和形状插值（shape interpolation）的更多信息。</p>
<p>哈特等。**[674]** 和汉森 <strong>[663]</strong> 提供了四元数的可视化。Plet inckx <strong>[1421]</strong> 和 Schlag <strong>[1566]</strong> 提出了在一组四元数之间平滑内插的不同方法。Vlachos 和 Isidoro <strong>[1820]</strong> 推导了四元数的C2插值公式。另外，与四元数插值有关的是沿曲线计算一致坐标系的问题， 是由Dougan <strong>[374]</strong> 处理的。</p>
<p>Alexa <strong>[28]</strong> 和 Lazarus and Verroust **[1000]**对许多不同的变形技术进行了调查。Parent’s book <strong>[1354]</strong> 是有关计算机动画技术的绝佳来源。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B8%B2%E6%9F%93/" rel="tag"># 渲染</a>
              <a href="/tags/RealTimeRendering/" rel="tag"># RealTimeRendering</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/07/09/RealTimeRender4/3/" rel="prev" title="RealTimeRendering 3">
      <i class="fa fa-chevron-left"></i> RealTimeRendering 3
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/28/RealTimeRender4/5/" rel="next" title="RealTimeRendering 5">
      RealTimeRendering 5 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="SOHUCS"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0-%E5%8F%98%E6%8D%A2-Transforms"><span class="nav-number">1.</span> <span class="nav-text">第4章 变换 Transforms</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E5%9F%BA%E6%9C%AC%E5%8F%98%E6%8D%A2-Basic-Transforms"><span class="nav-number">1.1.</span> <span class="nav-text">4.1 基本变换 Basic Transforms</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-1-%E5%B9%B3%E7%A7%BB-Translation"><span class="nav-number">1.1.1.</span> <span class="nav-text">4.1.1 平移 Translation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-2-%E6%97%8B%E8%BD%AC-Rotation"><span class="nav-number">1.1.2.</span> <span class="nav-text">4.1.2 旋转 Rotation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-3-%E7%BC%A9%E6%94%BE-Scaling"><span class="nav-number">1.1.3.</span> <span class="nav-text">4.1.3 缩放 Scaling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-4-%E5%89%AA%E5%88%87-Shearing"><span class="nav-number">1.1.4.</span> <span class="nav-text">4.1.4 剪切 Shearing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-5-%E5%8F%98%E6%8D%A2%E7%9A%84%E7%BA%A7%E8%81%94-Concatenation-of-Transforms"><span class="nav-number">1.1.5.</span> <span class="nav-text">4.1.5 变换的级联 Concatenation of Transforms</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-6-%E5%88%9A%E4%BD%93%E5%8F%98%E6%8D%A2-The-Rigid-Body-Transform"><span class="nav-number">1.1.6.</span> <span class="nav-text">4.1.6 刚体变换 The Rigid-Body Transform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-7-%E6%B3%95%E7%BA%BF%E5%8F%98%E6%8D%A2-Normal-Transform"><span class="nav-number">1.1.7.</span> <span class="nav-text">4.1.7 法线变换 Normal Transform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-8-%E9%80%86%E7%9A%84%E8%AE%A1%E7%AE%97-Computation-of-Inverses"><span class="nav-number">1.1.8.</span> <span class="nav-text">4.1.8 逆的计算 Computation of Inverses</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E7%89%B9%E6%AE%8A%E7%9F%A9%E9%98%B5%E5%8F%98%E6%8D%A2%E4%B8%8E%E8%BF%90%E7%AE%97-Special-Matrix-Transforms-and-Operations"><span class="nav-number">1.2.</span> <span class="nav-text">4.2 特殊矩阵变换与运算 Special Matrix Transforms and Operations</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-1-%E6%AC%A7%E6%8B%89%E5%8F%98%E6%8D%A2-The-Euler-Transform"><span class="nav-number">1.2.1.</span> <span class="nav-text">4.2.1 欧拉变换 The Euler Transform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-2-%E4%BB%8E%E6%AC%A7%E6%8B%89%E5%8F%98%E6%8D%A2%E4%B8%AD%E6%8F%90%E5%8F%96%E5%8F%82%E6%95%B0-Extracting-Parameters-from-the-Euler-Transform"><span class="nav-number">1.2.2.</span> <span class="nav-text">4.2.2 从欧拉变换中提取参数 Extracting Parameters from the Euler Transform</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-3-%E7%9F%A9%E9%98%B5%E5%88%86%E8%A7%A3-Matrix-Decomposition"><span class="nav-number">1.2.3.</span> <span class="nav-text">4.2.3 矩阵分解 Matrix Decomposition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-4-%E7%BB%95%E4%BB%BB%E6%84%8F%E8%BD%B4%E6%97%8B%E8%BD%AC-Rotation-about-an-Arbitrary-Axis"><span class="nav-number">1.2.4.</span> <span class="nav-text">4.2.4 绕任意轴旋转 Rotation about an Arbitrary Axis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E5%9B%9B%E5%85%83%E6%95%B0-Quaternions"><span class="nav-number">1.3.</span> <span class="nav-text">4.3 四元数 Quaternions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-1-%E6%95%B0%E5%AD%A6%E8%83%8C%E6%99%AF-Mathematical-Background"><span class="nav-number">1.3.1.</span> <span class="nav-text">4.3.1 数学背景 Mathematical Background</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-2-%E5%9B%9B%E5%85%83%E6%95%B0%E5%8F%98%E6%8D%A2-Quaternion-Transforms"><span class="nav-number">1.3.2.</span> <span class="nav-text">4.3.2 四元数变换 Quaternion Transforms</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4-%E9%A1%B6%E7%82%B9%E6%B7%B7%E5%90%88-Vertex-Blending"><span class="nav-number">1.4.</span> <span class="nav-text">4.4 顶点混合 Vertex Blending</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5-%E5%8F%98%E5%BD%A2-Morphing"><span class="nav-number">1.5.</span> <span class="nav-text">4.5 变形 Morphing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6-%E5%87%A0%E4%BD%95%E7%BC%93%E5%AD%98%E5%9B%9E%E6%94%BE-Geometry-Cache-Playback"><span class="nav-number">1.6.</span> <span class="nav-text">4.6 几何缓存回放 Geometry Cache Playback</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7-%E6%8A%95%E5%BD%B1-Projections"><span class="nav-number">1.7.</span> <span class="nav-text">4.7 投影 Projections</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-1-%E6%AD%A3%E4%BA%A4%E6%8A%95%E5%BD%B1-Orthographic-Projection"><span class="nav-number">1.7.1.</span> <span class="nav-text">4.7.1 正交投影 Orthographic Projection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-7-2-%E9%80%8F%E8%A7%86%E6%8A%95%E5%BD%B1-Perspective-Projection"><span class="nav-number">1.7.2.</span> <span class="nav-text">4.7.2 透视投影 Perspective Projection</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E4%B8%80%E6%AD%A5%E9%98%85%E8%AF%BB%E5%92%8C%E8%B5%84%E6%BA%90"><span class="nav-number">1.8.</span> <span class="nav-text">进一步阅读和资源</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">VisionXie</p>
  <div class="site-description" itemprop="description">生活在树上，始终热爱大地，升入天空。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">VisionXie</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  <script>
  NexT.utils.loadComments(document.querySelector('#SOHUCS'), () => {
    var appid = 'cyvS0HjaG';
    var conf = '26c6eae6e21dfb5a6535a5e53425e9ec';
    var width = window.innerWidth || document.documentElement.clientWidth;
    if (width < 960) {
      window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>');
    } else {
      var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){window.changyan.api.config({appid:appid,conf:conf})});
    }
  });
  </script>
  <script src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>

</body>
</html>
